code_name,code_text,,,,,,,,,blac0350,,,,,,,,,,muno0370,,,,,,,,,,dove0550,,,,,,,,,,olss0551,c  =====================================================================,,,,,,,,,jame0551,,,,,,,,,,oska0551,c  Adventure!,,,,,,,,,supn0350,,,,,,,,,,wood043b,c  =====================================================================,,,,,,,,,long0500,,,,,,,,,,vane0560,,,,,,,,,,wood0350,,,,,,,,,,arna0440,c ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»,,,,,,,,,,,,,,,,,,,,c º     Adventure - The Original Colossal Cave.  Source Code.               º,,,,,,,,,,,,,,,,,,,,c ÌÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹,,,,,,,,,,,,,,,,,,,,c º                Written 1990-1996 by Paul Mu¤oz-Colman.                  º,,,,,,,,,,,,,,,,,,,,"c º  Member, Association of Shareware Professionals (ASP).  Free product.   º",,,,,,,,,,,øÿÿ¦Šßžšß–‘ßžß’ž…šß™ß‹ˆ–Œ‹†ß“–‹‹“šßžŒŒž˜šŒÓßž““ßž“–”šÑÿ,øþÿ¦Šßžšß–‘ßžß’ž…šß™ß‹ˆ–Œ‹†ß“–‹‹“šßžŒŒž˜šŒÓßž““ßž“–”šÑÿøÿÿ»šž›ßš‘›Ñÿøþÿ»šž›ßš‘›Ñÿ,,,,,,,,c ÇÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¶,,,,,,,,,,,,,,,,,,,,c ºPaul Mu¤oz-Colman           ³  TECHNICAL SUPPORT:   ³                    º,,"CLAM, CLOCK1, CLOCK2, CLOSED, CLOSNG, CLSHNT, CLSMAX = 12, CLSSES,",,,,,,,,,,"COINS, COND[186], CONDS, CTEXT[13], CVAL[13], DALTLC, DETAIL,",,,,,,,,c ºFunStuff Software           ³  Voice 703-435-1110   ³      Try our       º,," DKILL, DOOR, DPRSSN, DRAGON, DSEEN[7], DTOTAL, DWARF, EGGS,",,,,,,,,,,"EMRALD, ENTER, ENTRNC, FIND, FISSUR, FIXD[101], FOOBAR, FOOD,",,,,,,,,c ºSuite 201                   ³   FAX  703-435-3130   ³  Personal Calendar º,,"GRATE, HINT, HINTED[21], HINTLC[21], HINTS[21][5], HNTMAX,",,,,,,,,,,"HNTSIZ = 20, I, INVENT, IGO, IWEST, J, JADE, K, K2, KEY[186], KEYS, KK,",,,,,,,,c º11645 Charter Oak Court     ³  EMail 71141.1224@    ³      product!!     º,,"KNFLOC, KNIFE, KQ, L, LAMP, LIMIT, LINSIZ = 12500, LINUSE, LL,",,,,,,,,,,"LMWARN, LOC, LOCK, LOCSIZ = 185, LOCSND[186], LOOK, LTEXT[186],",,,,,,,,"c ºReston, VA  20190-4526  USA ³      CompuServe.Com   ³                    º",,"MAGZIN, MAXDIE, MAXTRS, MESH = 123456789,",,,,,,,,,,"MESSAG, MIRROR, MXSCOR,",,,,,,,,c ÌÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÏÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¹,,"NEWLOC, NOVICE, NUGGET, NUL, NUMDIE, OBJ, OBJSND[101],",,,,,,,,,,"OBJTXT[101], ODLOC[7], OGRE, OIL, OLDLC2, OLDLOC, OLDOBJ, OYSTER,",,,,,,,,c º Our web site: http://ourworld.compuserve.com/homepages/funstuff_softwareº,,"PANIC, PEARL, PILLOW, PLAC[101], PLANT, PLANT2, PROP[101], PYRAM,",,,,,,,,,,"RESER, ROD, ROD2, RTXSIZ = 277, RUBY, RUG, SAPPH, SAVED, SAY,",,,,,,,,c ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼,,"SCORE, SECT, SIGN, SNAKE, SPK, STEPS, STEXT[186], STICK,",,,,,,,,,,"STREAM, TABNDX, TALLY, THRESH, THROW, TK[21], TRAVEL[886], TRIDNT,",,,,,,,,,,"TRNDEX, TRNLUZ, TRNSIZ = 5, TRNVAL[6], TRNVLS, TROLL, TROLL2, TRVS,",,,,,,,,,," TRVSIZ = 885, TTEXT[6], TURNS, URN, V1, V2, VASE, VEND, VERB,",,,,,,,,c   Modified for MS DOS PDS FORTRAN v5.10 ,,"VOLCAN, VRBSIZ = 35, VRSION = 25, WATER, WD1, WD1X, WD2, WD2X,",,,,,,,,,,"WZDARK = FALSE, ZZWORD;",,,,,,,,"c    by Paul Mu¤oz-Colman, FunStuff Software",,,,,,,,,,,,,,,,,,,,c   15 Sep 1996  286 CPU option,,,,,,,,,,,,,,,,,,,,c   27 Mar 1993  change date & time to getdat & gettim,,,,,,,,,,,,,,,,,,,,c                delete DO66 and DEBUG metacommands,,,,,,,,,,,,,,,,,,,,c                change pause prompt,,,,,,,,,,,,,,,,,,,,c                change OPEN STATUS to UNKNOWN on overwrites,,,,,,,,,,,,,,,,,,,,"c   15 Oct 1990  fix abort in line 653 from using the ""say"" verb",,,,,,,,,,,,,,,,,,,,c   13 Oct 1987  with suspend and resume feature--2-byte storage,,,,,,,,,,,,,,,,,,,,c  =====================================================================,,ERRATA FIXED: 78/12/25 */,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  Differences from Honeywell version to live with MS FORTRAN 77:,,,,,,,,,,,,,,,,,,,,c    1.  Can't EQUIVALENCE anything in COMMON or storage is bad.,,,,,,,,,,,,,,,,,,,,c    2.  LOGICAL functions can't have integer arguments--doesn't work.,,,,,,,,,,,,,,,,,,,,"c        All were rewritten to be INTEGER functions (1=true,0=false)",,,,,,,,,,,,,,,,,,,,c    3.  Data Base is binary file written by separate program to,,,,,,,,,,,,,,,,,,,,c        save space and time.  Limited to 64K.  I/O is slowww...,,,,,,,,,,,,,,,,,,,,c    4.  SAVE feature saves data arrays instead of whole program.,,,,,,,,,,,"LINES = (long *)calloc(LINSIZ+1,sizeof(long));",,,,,,,,,"c        RESUME must be given first turn, which reads file.",if(!LINES){,,,,,,,,,,,"printf(""Not enough memory!\n"");",,,,,,,,c    5.  Demonstration game and wizard stuff is gone...stupid anyway..,,exit(FALSE);,,,,,,,,,},,,,,,,,,c,,,,,,,,,,,MAP2[1] = 0;,,,,,,,,,c  Current limits:,if(!SETUP)initialise();,,,,,,,,,,if(SETUP > 0) goto L1;,,,,,,,,,"c   21150 words of message text (lines, linsiz)",,,,,,,,,,,,,,,,,,,,"c     745 travel options (travel, trvsiz).",,,,,,,,,,,,,,,,,,,,"c     295 vocabulary words (ktab, atab, tabsiz).",,,,,,,,,,,,,,,,,,,,"c     150 locations (ltext, stext, key, cond, abb, atloc, locsiz).",RSPEAK(201);,,,,,,,,,,exit(FALSE);,,,,,,,,,"c     100 objects (plac, place, fixd, fixed, link (twice), ptext, prop)",,,,,,,,,,,,,,,,,,,,"c      35 ""action"" verbs (actspk, vrbsiz).",,,,,,,,,,,,,,,,,,,,"c     205 random messages (rtext, rtxsiz).",,,,,,,,,,,SETUP= -1;,,,,,,,,,"c      12 different player classifications (ctext, cval, clsmax).",I=RAN(-1);,,,,,,,,,,"ZZWORD=RNDVOC(3,0)+MESH*2;",,,,,,,,,"c      20 hints, less 3 (hintlc, hinted, hints, hntsiz).","NOVICE=YES(65,1,0);",,,,,,,,,,NEWLOC=1;,,,,,,,,,c,LOC=1;,,,,,,,,,,LIMIT=330;,,,,,,,,,c  there are also limits which cannot be exceeded due to the structure of,if(NOVICE)LIMIT=1000;,,,,,,,,,,,,,,,,,,,"c  the database.  (e.g., the vocabulary uses n/1000 to determine word type,",,,,,,,,,,,,,,,,,,,,c  so there can't be more than 1000 words.)  these upper limits are:,if(!OUTSID(NEWLOC) || NEWLOC == 0 || !CLOSNG) goto L71;,,,,,,,,,,RSPEAK(130);,,,,,,,,,c  1000 non-synonymous vocabulary words,NEWLOC=LOC;,,,,,,,,,,if(!PANIC)CLOCK2=15;,,,,,,,,,c  300 locations,PANIC=TRUE;,,,,,,,,,,,,,,,,,,,c  100 objects,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  set metacommands for ms fortran,"if(NEWLOC == LOC || FORCED(LOC) || CNDBIT(LOC,3)) goto L74;",,,,,,,,,,/* 73 */ for (I=1; I<=5; I++) {,,,,,,,,,$nodebug,if(ODLOC[I] != NEWLOC || !DSEEN[I]) goto L73;,,IT IS THE LOCATION TO GO TO.,,,,,,,,NEWLOC=LOC;,,N-300 IS USED IN A COMPUTED GOTO TO,,,,,,,$notstrict,RSPEAK(2);,,,,A SECTION OF SPECIAL CODE.,,,,,, goto L74;,,"MESSAGE N-500 FROM SECTION 6 IS PRINTED,",,,,,,,$storage: 2,/*etc*/ ;,,,,AND HE STAYS WHEREVER HE IS.,,,,,,} /* end loop */,,,,,,,,,c,LOC=NEWLOC;,,,IT'S UNCONDITIONAL.,,,,,,,,,IT IS DONE WITH M% PROBABILITY.,,,,,,,      implicit integer*2 (a-z),,,"UNCONDITIONAL, BUT FORBIDDEN TO DWARVES.",,,,,,,,,,HE MUST BE CARRYING OBJECT M-100.,,,,,,,c,,,MUST BE CARRYING OR IN SAME ROOM AS M-200.,,,,,,,,,,PROP(M MOD 100) MUST *NOT* BE 0.,,,,,,,      common /txtcom/ rtext,,,PROP(M MOD 100) MUST *NOT* BE 1.,,,,,,,,,,"PROP(M MOD 100) MUST *NOT* BE 2, ETC.",,,,,,,      common /blkcom/ blklin,,,,,,,,,,,,,,,,,,,,"      common /voccom/ ktab,atab,tabsiz",,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng","if(LOC == 0 || FORCED(LOC) || CNDBIT(NEWLOC,3)) goto L2000;",,,,,,,,,,if(DFLAG != 0) goto L6000;,,110022,29,31,34,35,23,43,      common /ptxcom/ ptext,if(INDEEP(LOC))DFLAG=1;,,14,29,,,,,,, goto L2000;,,,,,,,,,      common /abbcom/ abb,,,,,,,,,,,,,303008,49,,,,,,      common /concom/ cond,,,9,50,,,,,,,,,,,,,,,,      common /loccom/ loc,if(DFLAG != 1) goto L6010;,,,,,,,,,,"if(!INDEEP(LOC) || (PCT(95) && (!CNDBIT(LOC,4) || PCT(85)))) goto L2000;",,,,,,,,,"      common /procom/ prop, lamp",DFLAG=2;,,,,,,,,,,/* 6001 */ for (I=1; I<=2; I++) {,,,,,,,,,      common /lincom/ lines,J=1+RAN(5);,,,,,,,,,,if(PCT(50))DLOC[J]=0;,,,,,,,,,      character*2 lines (21150),} /* end loop */,,,,,,,,,,/* 6002 */ for (I=1; I<=5; I++) {,,,,,,,,,"      character*4 wd1,wd2,iz,bl,atab(295),wd1x,wd2x",if(DLOC[I] == LOC)DLOC[I]=DALTLC;,,,,,,,,,,ODLOC[I]=DLOC[I];,,,,,,,,,      character*1 tk(20),} /* end loop */,,,,,,,,,,RSPEAK(3);,,,,,,,,,      character*58 htloc,"DROP(AXE,LOC);",,,,,,,,,, goto L2000;,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      integer*2 ktab(295),rtext(205),atloc(150)",,,,,,,,,,,,,,,,,,,,"      integer*2 ltext(150),stext(150),key(150),cond(150),abb(150)",,,,,,,,,,,,,,,,,,,,"      integer*2 plac(100),place(100),fixd(100),fixed(100),link(200)",DTOTAL=0;,,,,,,,,,,ATTACK=0;,,,,,,,,,"      integer*2 actspk(35),ptext(100),prop(100),ctext(12),cval(12)",STICK=0;,,,,,,,,,,/* 6030 */ for (I=1; I<=6; I++) {,,,,,,,,,"      integer*2 hintlc(20),hinted(20),hints(20,4),dseen(6),dloc(6)",if(DLOC[I] == 0) goto L6030;,,,,,,,,,,,,,,,,,,,"      integer*2 idondx,odloc(6)",J=1;,,,,,,,,,,KK=DLOC[I];,,,,,,,,,"      integer*4 travel(745),itk(20),newloc,linuse,kk,linsiz",KK=KEY[KK];,,,,,,,,,,if(KK == 0) goto L6016;,,LIGHT,,,,,,,"      integer*4 ll,izz","NEWLOC=MOD(IABS(TRAVEL[KK])/1000,1000);",,"IF BIT 2 IS ON: ON FOR OIL, OFF FOR WATER",,,,,,,,{long x = J-1;,,"LIQUID ASSET, SEE BIT 1",,,,,,,c,if(NEWLOC > 300 || !INDEEP(NEWLOC) || NEWLOC == ODLOC[I] || (J > 1 &&,,PIRATE DOESN'T GO HERE UNLESS FOLLOWING PLAYER,,,,,,,,,NEWLOC == TK[x]) || J >= 20 || NEWLOC == DLOC[I] ||,,,,,,,,"      equivalence(izz,iz)",,"FORCED(NEWLOC) || (I == 6 && CNDBIT(NEWLOC,3)) ||",TRYING TO GET INTO CAVE,,,,,,,,,IABS(TRAVEL[KK])/1000000 == 100) goto L6014;},TRYING TO CATCH BIRD,,,,,,,c,TK[J]=NEWLOC;,,TRYING TO DEAL WITH SNAKE,,,,,,,,J=J+1;,,LOST IN MAZE,,,,,,,      external ran,KK=KK+1;,,PONDERING DARK ROOM,,,,,,,,{long x = KK-1; if(TRAVEL[x] >= 0) goto L6012;},,AT WITT'S END,,,,,,,c,TK[J]=ODLOC[I];,,,,,,,,,,if(J >= 2)J=J-1;,,,,,,,,,"      data linsiz/21150/,trvsiz/745/,locsiz/150/,izz/0/,",J=1+RAN(J);,,,,,,,,,,ODLOC[I]=DLOC[I];,,,,,,,,,"     .        vrbsiz/35/,rtxsiz/205/,clsmax/12/,hntsiz/20/",DLOC[I]=TK[J];,,,,,,,,,,DSEEN[I]=(DSEEN[I] && INDEEP(LOC)) || (DLOC[I] == LOC || ODLOC[I] == LOC);,,,,,,,,,      data bl/'    '/,if(!DSEEN[I]) goto L6030;,,,,,,,,,,DLOC[I]=LOC;,,,,,,,,,c,if(I != 6) goto L6027;,,,,,,,,,,,,,,,,,,,c  various functions--all integer in ms fortran--1 true  0 false,,,,,,,,,,,,,,,,,,,,c  some are statement functions--others independently compiled,,,,,,,,,,,,,,,,,,,,"      bitset(l,n)=mod(shift(cond(l),-n),2)",,,,,,,,,,,if(LOC == CHLOC || PROP[CHEST] >= 0) goto L6030;,,,,,,,,,      liq2(pbotl)=(1-pbotl)*water+(pbotl/2)*(water+oil),K=0;,,,,,,,,,,/* 6020 */ for (J=50; J<=MAXTRS; J++) {,,,,,,,,,"      liqloc(loc)=liq2((mod(cond(loc)/2*2,8)-5)*mod(cond(loc)/4,2)+1)",,,,,,,,,,,if(J == PYRAM && (LOC == PLAC[PYRAM] || LOC == PLAC[EMRALD])) goto L6020;,,,,,,,,,"      liq(dummy)=liq2(max0(prop(bottle),-1-prop(bottle)))",if(TOTING(J)) goto L6021;,,,,,,,,,,if(HERE(J))K=1;,,,,,,,,,c,} /* end loop */,,,,,,,,,,if(TALLY == 1 && K == 0 && PLACE[CHEST] == 0 && HERE(LAMP) && PROP[LAMP],,,,,,,,,c  toting(obj) = true if the obj is being carried,,== 1) goto L6025;,,,,,,,,,if(ODLOC[6] != DLOC[6] && PCT(20))RSPEAK(127);,,,,,,,,,"c  here(obj)   = true if the obj is at ""loc"" (or is being carried)", goto L6030;,,,,,,,,,,,,,,,,,,,c  at(obj)     = true if on either side of two-placed object,if(PLACE[CHEST] != 0) goto L6022;,,,,,,,,,,,,,,,,,,,c  liq(dummy)  = object number of liquid in bottle,"MOVE(CHEST,CHLOC);",,,,,,,,,,"MOVE(MESSAG,CHLOC2);",,,,,,,,,c  liqloc(loc) = object number of liquid (if any) at loc,RSPEAK(128);,,,,,,,,,,/* 6023 */ for (J=50; J<=MAXTRS; J++) {,,,,,,,,,"c  bitset(l,n) = true if cond(l) has bit n set (bit 0 is units bit)",if(J == PYRAM && (LOC == PLAC[PYRAM] || LOC == PLAC[EMRALD])) goto L6023;,,,,,,,,,,"if(AT(J) && FIXED[J] == 0)CARRY(J,LOC);",,,,,,,,,c  forced(loc) = true if loc moves without asking for input (cond=2),"if(TOTING(J))DROP(J,CHLOC);",,,,,,,,,,/*etc*/ ;,,,,,,,,,"c  dark(dummy) = true if location ""loc"" is dark",} /* end loop */,,,,,,,,,,DLOC[6]=CHLOC;,,,,,,,,,c  pct(n)      = true n% of the time (n integer*2 from 0 to 100),ODLOC[6]=CHLOC;,,,,,,,,,,DSEEN[6]=FALSE;,,,,,,,,,c  wzdark says whether the loc he's leaving was dark, goto L6030;,,,,,,,,,,,,,,,,,,,c  lmwarn says whether he's been warned about lamp going dim,RSPEAK(186);,,,,,,,,,,"MOVE(CHEST,CHLOC);",,,,,,,,,c  closng says whether its closing time yet,"MOVE(MESSAG,CHLOC2);",,,,,,,,,, goto L6024;,,,,,,,,,c  panic says whether he's found out he's trapped in the cave,,,,,,,,,,,,,,,,,,,,c  closed says whether we're all the way closed,,,,,,,,,,,DTOTAL=DTOTAL+1;,,,,,,,,,"c  gaveup says whether he exited via ""quit""",if(ODLOC[I] != DLOC[I]) goto L6030;,,,,,,,,,,ATTACK=ATTACK+1;,,,,,,,,,"c  scorng indicates to the score routine whether we're doing a ""score"" command",if(KNFLOC >= 0)KNFLOC=LOC;,,,,,,,,,,if(RAN(1000) < 95*(DFLAG-2))STICK=STICK+1;,,,,,,,,,c  yea is random yes/no reply,/*etc*/ ;,,,,,,,,,,} /* end loop */,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  description of the database format,,,,,,,,,,,,,,,,,,,,c  the data file contains several sections.  each begins with a line containing,,,,,,,,,,,if(DTOTAL == 0) goto L2000;,,,,,,,,,"c  a number identifying the section, and ends with a line containing ""-1"".","SETPRM(1,DTOTAL,0);",,,,,,,,,,RSPEAK(4+1/DTOTAL);,,,,,,,,,c,if(ATTACK == 0) goto L2000;,,,,,,,,,,if(DFLAG == 2)DFLAG=3;,,,,,,,,,"c  section 1: long form descriptions.  each line contains a location number,","SETPRM(1,ATTACK,0);",,,,,,,,,,K=6;,,,,,,,,,c  and a line of text.  the set of (necessarily adjacent) lines,if(ATTACK > 1)K=250;,,,,,,,,,,RSPEAK(K);,,,,,,,,,c  whose numbers are x form the long description of location x.,"SETPRM(1,STICK,0);",,,,,,,,,,RSPEAK(K+1+2/(1+STICK));,,,,,,,,,c,if(STICK == 0) goto L2000;,,,,,,,,,,OLDLC2=LOC;,,,,,,,,,c  section 2: short form descriptions.  same format as long form.  not all, goto L99;,,,,,,,,,,,,,,,,,,,c  places have short descriptions.,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"c  section 3: travel table.  each line contains a location number (x), a second",,,,,,,,,,,,,,,,,,,,"c  location number (y), and a list of motion numbers (see section 4).",,,,,,,,,,,,,,,,,,,,c  each motion represents a verb which will go to y if currently at x.,,,,,,,,,,,if(LOC == 0) goto L99;,,,,,,,,,"c  y, in turn, is interpreted as follows.  let m=y/1000, n=y mod 1000.",KK=STEXT[LOC];,,,,,,,,,,"if(MOD(ABB[LOC],ABBNUM) == 0 || KK == 0)KK=LTEXT[LOC];",,,,,,,,,c      if n<=300     it is the location to go to.,if(FORCED(LOC) || !DARK(0)) goto L2001;,,,,,,,,,,if(WZDARK && PCT(35)) goto L90;,,,,,,,,,c      if 300<n<=500 n-300 is used in a computed goto to,KK=RTEXT[16];,,,,,,,,,,if(TOTING(BEAR))RSPEAK(141);,,,,,,,,,c                           a section of special code.,SPEAK(KK);,,,,,,,,,,K=1;,,,,,,,,,"c      if n>500      message n-500 from section 6 is printed,",if(FORCED(LOC)) goto L8;,,,,,,,,,,if(LOC == 33 && PCT(25) && !CLOSNG)RSPEAK(7);,,,,,,,,,c                           and he stays wherever he is.,,,,,,,,,,,,,,,,,,,,"c  meanwhile, m specifies the conditions on the motion.",,,,,,,,,,,,,,,,,,,,c      if m=0        it's unconditional.,,,,,,,,,,,,,,,,,,,,c      if 0<m<100    it is done with m% probability.,,,,,,,,,,,if(DARK(0)) goto L2012;,,,,,,,,,"c      if m=100      unconditional, but forbidden to dwarves.",ABB[LOC]=ABB[LOC]+1;,,,,,,,,,,I=ATLOC[LOC];,,,,,,,,,c      if 100<m<=200 he must be carrying object m-100.,if(I == 0) goto L2012;,,,,,,,,,,OBJ=I;,,,,,,,,,c      if 200<m<=300 must be carrying or in same room as m-200.,if(OBJ > 100)OBJ=OBJ-100;,,,,,,,,,,if(OBJ == STEPS && TOTING(NUGGET)) goto L2008;,,,,,,,,,c      if 300<m<=400 prop(m mod 100) must *not* be 0.,if(PROP[OBJ] >= 0) goto L2006;,,,,,,,,,,if(CLOSED) goto L2008;,,,,,,,,,c      if 400<m<=500 prop(m mod 100) must *not* be 1.,PROP[OBJ]=0;,,,,,,,,,,if(OBJ == RUG || OBJ == CHAIN)PROP[OBJ]=1;,,,,,,,,,"c      if 500<m<=600 prop(m mod 100) must *not* be 2, etc.",TALLY=TALLY-1;,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"c  if the condition (if any) is not met, then the next *different*",,,,,,,,,,,,,,,,,,,,"c  ""destination"" value is used (unless it fails to meet *its* conditions,",,,,,,,,,,,,,,,,,,,,"c  in which case the next is found, etc.).  typically, the next dest will",,,,,,,,,,,,,,,,,,,,"c  be for one of the same verbs, so that its only use is as the alternate",,,,,,,,,,,,,,,,,,,,c  destination for those verbs.  for instance:,KK=PROP[OBJ];,,,,,,,,,,if(OBJ == STEPS && LOC == FIXED[STEPS])KK=1;,,,,,,,,,c      15     110022 29     31     34     35     23     43,"PSPEAK(OBJ,KK);",,,,,,,,,,I=LINK[I];,,,,,,,,,c      15     14     29, goto L2004;,,,,,,,,,,,,,,,,,,,"c  this says that, from loc 15, any of the verbs 29, 31, etc1. will take",K=54;,,,,,,,,,,SPK=K;,,,,,,,,,"c  him to 22 if he's carrying object 10, and otherwise will go to 14.",RSPEAK(SPK);,,,,,,,,,,,,,,,,,,,c      11     303008 49,VERB=0;,,,,,,,,,,OLDOBJ=OBJ;,,,,,,,,,c      11     9      50,OBJ=0;,,,,,,,,,,,,,,,,,,,"c  this says that, from 11, 49 takes him to 8 unless prop(3)=0, in which",,,,,,,,,,,,,,,,,,,,c  case he goes to 9.  verb 50 takes him to 9 regardless of prop(3).,,,,,,,,,,,,*/,,,,,,,,c,,,,,,,,,,,if(COND[LOC] < CONDS) goto L2603;,,,,,,,,,"c  section 4: vocabulary.  each line contains a number (n), and a",/* 2602 */ for (HINT=1; HINT<=HNTMAX; HINT++) {,,,,,,,,,,if(HINTED[HINT]) goto L2602;,,,,,,,,,"c  five-letter word.  call m=n/1000.  if m=0, then the word is a motion","if(!CNDBIT(LOC,HINT+10))HINTLC[HINT]= -1;",,,,,,,,,,HINTLC[HINT]=HINTLC[HINT]+1;,,,,,,,,,"c  verb for use in travelling (see section 3).  else, if m=1, the word is",if(HINTLC[HINT] >= HINTS[HINT][1]) goto L40000;,,,,,,,,,,/*etc*/ ;,,,,,,,,,"c  an object.  else, if m=2, the word is an action verb (such as ""carry""",} /* end loop */,,,,,,,,,,,,,,,,,,,"c  or ""attack"").  else, if m=3, the word is a special case verb (such as",,,,,,,,,,,,,,,,,,,,"c  ""dig"") and n mod 1000 is an index into section 6.  objects from 50 to",,,,,,,,,,,,,,,,,,,,"c  (currently, anyway) 79 are considered treasures (for pirate, closeout).",,,,,,,,,,,,,,,,,,,,c,if(!CLOSED) goto L2605;,,,,,,,,,,"if(PROP[OYSTER] < 0 && TOTING(OYSTER))PSPEAK(OYSTER,1);",,,,,,,,,"c  section 5: object descriptions.  each line contains a number (n),",/* 2604 */ for (I=1; I<=100; I++) {,,,,,,,,,,if(TOTING(I) && PROP[I] < 0)PROP[I]= -1-PROP[I];,,,,,,,,,"c  and a message.  if n is from 1 to 100, the message is the ""inventory""",} /* end loop */,,,,,,,,,,WZDARK=DARK(0);,,,,,,,,,"c  message for object n.  otherwise, n should be 000, 100, 200, etc., and",if(KNFLOC > 0 && KNFLOC != LOC)KNFLOC=0;,,,,,,,,,,I=RAN(1);,,,,,,,,,c  the message should be the description of the preceding object when its,"GETIN(WD1,WD1X,WD2,WD2X);",,,,,,,,,,,,,,,,,,,c  prop value is n/100.  the n/100 is used only to distinguish multiple,,,,,,,,,,,,,,,,,,,,c  messages from multi-line messages; the prop info actually requires all,,,,,,,,,,,FOOBAR=(FOOBAR>0 ? -FOOBAR : 0);,,,,,,,,,c  messages for an object to be present and consecutive.  properties which,TURNS=TURNS+1;,,,,,,,,,,if(TURNS != THRESH) goto L2608;,,,,,,,,,"c  produce no message should be given the message "">$<"".",SPEAK(TTEXT[TRNDEX]);,,,,,,,,,,TRNLUZ=TRNLUZ+TRNVAL[TRNDEX]/100000;,,,,,,,,,c,TRNDEX=TRNDEX+1;,,,,,,,,,,THRESH= -1;,,,,,,,,,"c  section 6: arbitrary messages.  same format as sections 1, 2, and 5, except","if(TRNDEX <= TRNVLS)THRESH=MOD(TRNVAL[TRNDEX],100000)+1;",,,,,,,,,,if(VERB == SAY && WD2 > 0)VERB=0;,,,,,,,,,c  the numbers bear no relation to anything (except for special verbs,if(VERB == SAY) goto L4090;,,,,,,,,,,if(TALLY == 0 && INDEEP(LOC) && LOC != 33)CLOCK1=CLOCK1-1;,,,,,,,,,c  in section 4).,if(CLOCK1 == 0) goto L10000;,,,,,,,,,,if(CLOCK1 < 0)CLOCK2=CLOCK2-1;,,,,,,,,,c,if(CLOCK2 == 0) goto L11000;,,,,,,,,,,if(PROP[LAMP] == 1)LIMIT=LIMIT-1;,,,,,,,,,c  section 7: object locations.  each line contains an object number and its,if(LIMIT <= 30 && HERE(BATTER) && PROP[BATTER] == 0 && HERE(LAMP)) goto,,,,,,,,,,,L12000;,,,,,,,,c  initial location (zero (or omitted) if none).  if the object is,if(LIMIT == 0) goto L12400;,,,,,,,,,,if(LIMIT <= 30) goto L12200;,,,,,,,,,"c  immovable, the location is followed by a ""-1"".  if it has two locations",,,,,,,,,,,if(LIQLOC(LOC) == WATER)K=70;,,,,,,,,,"c  (e.g. the grate) the first location is followed with the second, and","V1=VOCAB(WD1,-1);",,,,,,,,,,"V2=VOCAB(WD2,-1);",,,,,,,,,c  the object is assumed to be immovable.,if(V1 == ENTER && (V2 == STREAM || V2 == 1000+WATER)) goto L2010;,,,,,,,,,,if(V1 == ENTER && WD2 > 0) goto L2800;,,,,,,,,,c,if((V1 != 1000+WATER && V1 != 1000+OIL) || (V2 != 1000+PLANT && V2 !=,,,,,,,,,,,1000+DOOR)) goto L2610;,,,,,,,,"c  section 8: action defaults.  each line contains an ""action-verb"" number and",{long x = V2-1000; if(AT(x))WD2=MAKEWD(16152118);},,,,,,,,,,if(V1 == 1000+CAGE && V2 == 1000+BIRD && HERE(CAGE) &&,,,,,,,,,c  the index (in section 6) of the default message for the verb.,,HERE(BIRD))WD1=MAKEWD(301200308);,,,,,,,,,if(WD1 != MAKEWD(23051920)) goto L2625;,,,,,,,,,c,IWEST=IWEST+1;,,,,,,,,,,if(IWEST == 10)RSPEAK(17);,,,,,,,,,"c  section 9: liquid assets, etc.  each line contains a number (n) and up to 20",if(WD1 != MAKEWD( 715) || WD2 == 0) goto L2630;,,,,,,,,,,IGO=IGO+1;,,,,,,,,,c  location numbers.  bit n (where 0 is the units bit) is set in cond(loc),if(IGO == 10)RSPEAK(276);,,,,,,,,,,"I=VOCAB(WD1,-1);",,,,,,,,,c  for each loc given.  the cond bits currently assigned are:,if(I == -1) goto L3000;,,,,,,,,,,"K=MOD(I,1000);",,,,,,,,,c      0      light,KQ=I/1000+1;,,,,,,,,,, switch (KQ-1) { case 0: goto L8; case 1: goto L5000; case 2: goto L4000;,,,,,,,,,"c      1      if bit 2 is on: on for oil, off for water",,case 3: goto L2010; },,,,,,,,,BUG(22);,,,,,,,,,"c      2      liquid asset, see bit 1",,,,,,,,,,,,,,,,,,,,c      3      pirate doesn't go here unless following player,,,,,,,,,,,WD1=WD2;,,,,,,,,,"c  other bits are used to indicate areas of interest to ""hint"" routines:",WD1X=WD2X;,,,,,,,,,,WD2=0;,,,,,,,,,c      4      trying to get into cave, goto L2620;,,,,,,,,,,,,,,,,,,,c      5      trying to catch bird,,,,,,,,,,,,,,,,,,,,c      6      trying to deal with snake,"SETPRM(1,WD1,WD1X);",,,,,,,,,,RSPEAK(254);,,,,,,,,,c      7      lost in maze, goto L2600;,,,,,,,,,,,,,,,,,,,c      8      pondering dark room,,,,,,,,,,,,,,,,,,,,c      9      at witt's end,I=4000; goto Laction;,,,,,,,,,,I=4090; goto Laction;,,,,,,,,,"c  cond(loc) is set to 2, overriding all other bits, if loc has forced",I=5000;,,,,,,,,,,,,,,,,,,,c  motion.,switch (action(I)) {,,,,,,,,,,   case 2: goto L2;,,,,,,,,,c,   case 8: goto L8;,,,,,,,,,,   case 2000: goto L2000;,,,,,,,,,"c  section 10: class messages.  each line contains a number (n), and a",   case 2009: goto L2009;,,,,,,,,,,   case 2010: goto L2010;,,,,,,,,,c  message describing a classification of player.  the scoring section,   case 2011: goto L2011;,,,,,,,,,,   case 2012: goto L2012;,,,,,,,,,"c  selects the appropriate message, where each message is considered to",   case 2600: goto L2600;,,,,,,,,,,   case 2607: goto L2607;,,,,,,,,,c  apply to players whose scores are higher than the previous n but not,   case 2630: goto L2630;,,,,,,,,,,   case 2800: goto L2800;,,,,,,,,,c  higher than this n.  note that these scores probably change with every,   case 8000: goto L8000;,,,,,,,,,,   case 18999: goto L18999;,,,,,,,,,c  modification (and particularly expansion) of the program.,   case 19000: goto L19000;,,,,,,,,,,   },,,,,,,,,c,BUG(99);,,,,,,,,,,,,,,,,,,,c  section 11: hints.  each line contains a hint number (corresponding to a,,,,,,,,,,,,*/,,,,,,,,"c  cond bit, see section 9), the number of turns he must be at the right",,,,,,,,,,,"SETPRM(1,WD1,WD1X);",,,,,,,,,"c  loc(s) before triggering the hint, the points deducted for taking the",RSPEAK(257);,,,,,,,,,,OBJ=0;,,,,,,,,,"c  hint, the message number (section 6) of the question, and the message",goto L2600;,,,,,,,,,,,,,,,,,,,"c  number of the hint.  these values are stashed in the ""hints"" array.",,,,,,,,,,,,,,,,,,,,c  hntmax is set to the max hint number (<= hntsiz).  numbers 1-3 are,,,,,,,,,,,,,,,,,,,,"c  unusable since cond bits are otherwise assigned, so 2 is used to",,,,,,,,,,,,,,,,,,,,"c  remember if he's read the clue in the repository, and 3 is used to",,,,,,,,,,,,,,,,,,,,"c  remember whether he asked for instructions (gets more turns, but loses",KK=KEY[LOC];,,,,,,,,,,NEWLOC=LOC;,,,,,,,,,c  points).,if(KK == 0)BUG(26);,,,,,,,,,,if(K == NUL) goto L2;,,,,,,,,,c,if(K == BACK) goto L20;,,,,,,,,,,if(K == LOOK) goto L30;,,,,,,,,,c  section 12: magic messages. not implemented ibm pc version.  stupid.,if(K == CAVE) goto L40;,,,,,,,,,,OLDLC2=OLDLOC;,,,,,,,,,c,OLDLOC=LOC;,,,,,,,,,,,,,,,,,,,c  section 0: end of database.,LL=IABS(TRAVEL[KK]);,,,,,,,,,,"if(MOD(LL,1000) == 1 || MOD(LL,1000) == K) goto L10;",,,,,,,,,c,if(TRAVEL[KK] < 0) goto L50;,,,,,,,,,,KK=KK+1;,,,,,,,,,c  clear out the various text-pointer arrays.  all text is stored in array, goto L9;,,,,,,,,,,,,,,,,,,,c  lines; each line is preceded by a word pointing to the next pointer (i.e.,LL=LL/1000;,,,,,,,,,,NEWLOC=LL/1000;,,,,,,,,,c  the word following the end of the line).  the pointer is negative if this is,"K=MOD(NEWLOC,100);",,,,,,,,,,if(NEWLOC <= 300) goto L13;,,,,,,,,,c  first line of a message.  the text-pointer arrays contain indices of,if(PROP[K] != NEWLOC/100-3) goto L16;,,,,,,,,,,if(TRAVEL[KK] < 0)BUG(25);,,,,,,,,,c  pointer-words in lines.  stext(n) is short description of location n.,KK=KK+1;,,,,,,,,,,NEWLOC=IABS(TRAVEL[KK])/1000;,,,,,,,,,c  ltext(n) is long description.  ptext(n) points to message for prop(n)=0.,if(NEWLOC == LL) goto L12;,,,,,,,,,,LL=NEWLOC;,,,,,,,,,c  successive prop messages are found by chasing pointers.  rtext contains, goto L11;,,,,,,,,,,,,,,,,,,,c  section 6's stuff.  ctext(n) points to a player-class message.,if(NEWLOC <= 100) goto L14;,,,,,,,,,,if(TOTING(K) || (NEWLOC > 200 && AT(K))) goto L16;,,,,,,,,,c  we also clear cond.  see description of section 9 for details., goto L12;,,,,,,,,,,,,,,,,,,,c,if(NEWLOC != 0 && !PCT(NEWLOC)) goto L12;,,,,,,,,,,"NEWLOC=MOD(LL,1000);",,,,,,,,,"c  the stuff for section 3 is encoded here.  each ""from-location"" gets a",if(NEWLOC <= 300) goto L2;,,,,,,,,,,if(NEWLOC <= 500) goto L30000;,,,,,,,,,"c  contiguous section of the ""travel"" array.  each entry in travel is",RSPEAK(NEWLOC-500);,,,,,,,,,,NEWLOC=LOC;,,,,,,,,,"c  newloc*1000 + keyword (from section 4, motion verbs), and is negated if", goto L2;,,,,,,,,,,,,,,,,,,,c  this is the last entry for this location.  key(n) is the index in travel,,,,,,,,,,,,,,,,,,,,c  of the first option at location n.,,,,,,,,,,,,,,,,,,,,, switch (NEWLOC) { case 1: goto L30100; case 2: goto L30200; case 3: goto,,,,,,,,,,,L30300; },,,,,,,,"c  here we read in the vocabulary.  ktab(n) is the word number, atab(n) is",BUG(20);,,,,,,,,,,,,,,,,,,,c  the corresponding word.  the -1 at the end of section 4 is left in ktab,,,,,,,,,,,,,,,,,,,,c  as an end-marker.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,if(HOLDNG == 0 || (HOLDNG == 1 && TOTING(EMRALD))) goto L2;,,,,,,,,,c  read in the initial locations for each object.  also the immovability info.,NEWLOC=LOC;,,,,,,,,,,RSPEAK(117);,,,,,,,,,c  plac contains initial locations of objects.  fixd is -1 for immovable, goto L2;,,,,,,,,,,,,,,,,,,,"c  objects (including the snake), or = second loc for two-placed objects.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  read default message numbers for action verbs, store in actspk.",,,,,,,,,,, goto L12;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  read info about available liquids and other conditions, store in cond.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  read data for hints.,,,,,,,,,,,,,,,,,,,,,"PSPEAK(TROLL,1);",,,,,,,,,,PROP[TROLL]=0;,,,,,,,,,"c  having read in the database, certain things are now constructed.  props are","MOVE(TROLL2,0);",,,,,,,,,,"MOVE(TROLL2+100,0);",,,,,,,,,c  set to zero.  we finish setting up cond by checking for forced-motion travel,"MOVE(TROLL,PLAC[TROLL]);",,,,,,,,,,"MOVE(TROLL+100,FIXD[TROLL]);",,,,,,,,,c  entries.  the plac and fixd arrays are used to set up atloc(n) as the first,JUGGLE(CHASM);,,,,,,,,,,NEWLOC=LOC;,,,,,,,,,"c  object at location n, and link(obj) as the next object at the same location", goto L2;,,,,,,,,,,,,,,,,,,,c  as obj.  (obj>100 indicates that fixed(obj-100)=loc; link(obj) is still the,,,,,,,,,,,if(PROP[TROLL] == 0)PROP[TROLL]=1;,,,,,,,,,c  correct link to use.)  abb is zeroed; it controls whether the abbreviated,if(!TOTING(BEAR)) goto L2;,,,,,,,,,,RSPEAK(162);,,,,,,,,,"c  description is printed.  counts mod 5 unless ""look"" is used.",PROP[CHASM]=1;,,,,,,,,,,PROP[TROLL]=2;,,,,,,,,,,"DROP(BEAR,NEWLOC);",,,,,,,,,,FIXED[BEAR]= -1;,,,,,,,,,c  set up the atloc and link arrays as described above.  we'll use the drop,PROP[BEAR]=3;,,,,,,,,,,OLDLC2=NEWLOC;,,,,,,,,,"c  suboutine, which prefaces new objects on the lists.  since we want things", goto L99;,,,,,,,,,,,,,,,,,,,"c  in the other order, we'll run the loop backwards.  if the object is in two",,,,,,,,,,,,,,,,,,,,"c  locs, we drop it twice.  this also sets up ""place"" and ""fixed"" as copies of",,,,,,,,,,,,,,,,,,,,"c  ""plac"" and ""fixd"".  also, since two-placed objects are typically best",,,,,,,,,,,K=OLDLOC;,,,,,,,,,"c  described last, we'll drop them first.",if(FORCED(K))K=OLDLC2;,,,,,,,,,,OLDLC2=OLDLOC;,,,,,,,,,,OLDLOC=LOC;,,,,,,,,,,K2=0;,,,,,,,,,"c  treasures, as noted earlier, are objects 50 through maxtrs (currently 79).",if(K == LOC)K2=91;,,,,,,,,,,"if(CNDBIT(LOC,4))K2=274;",,,,,,,,,"c  their props are initially -1, and are set to 0 the first time they are",if(K2 == 0) goto L21;,,,,,,,,,,RSPEAK(K2);,,,,,,,,,"c  described.  tally keeps track of how many are not yet found, so we know", goto L2;,,,,,,,,,,,,,,,,,,,c  when to close the cave.  tally2 counts how many can never be found (e.g. if,"LL=MOD((IABS(TRAVEL[KK])/1000),1000);",,,,,,,,,,if(LL == K) goto L25;,,,,,,,,,c  lost bird or bridge).,if(LL > 300) goto L22;,,,,,,,,,,J=KEY[LL];,,,,,,,,,,"if(FORCED(LL) && MOD((IABS(TRAVEL[J])/1000),1000) == K)K2=KK;",,,,,,,,,,if(TRAVEL[KK] < 0) goto L23;,,,,,,,,,c  clear the hint stuff.  hintlc(i) is how long he's been at loc with cond bit,KK=KK+1;,,,,,,,,,, goto L21;,,,,,,,,,c  i.  hinted(i) is true iff hint i has been used.,,,,,,,,,,,KK=K2;,,,,,,,,,,if(KK != 0) goto L25;,,,,,,,,,,RSPEAK(140);,,,,,,,,,c  define some handy mnemonics.  these correspond to object numbers., goto L2;,,,,,,,,,,,,,,,,,,,,"K=MOD(IABS(TRAVEL[KK]),1000);",,,,,,,,,,KK=KEY[LOC];,,,,,,,,,c  objects from 50 through whatever are treasures.  here are a few., goto L9;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  these are motion-verb numbers.,,,,,,,,,,,if(DETAIL < 3)RSPEAK(15);,,,,,,,,,,DETAIL=DETAIL+1;,,,,,,,,,,WZDARK=FALSE;,,,,,,,,,c  and some action verbs.,ABB[LOC]=0;,,,,,,,,,, goto L2;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  initialize the dwarves.  dloc is loc of dwarves, hard-wired in.  odloc is",,,,,,,,,,,K=58;,,,,,,,,,"c  prior loc of each dwarf, initially garbage.  daltlc is alternate initial loc",if(OUTSID(LOC) && LOC != 8)K=57;,,,,,,,,,,RSPEAK(K);,,,,,,,,,"c  for dwarf, in case one of them starts out on top of the adventurer.  (no 2", goto L2;,,,,,,,,,,,,,,,,,,,c  of the 5 initial locs are adjacent.)  dseen is true if dwarf has seen him.,,,,,,,,,,,,,,,,,,,,c  dflag controls the level of activation of all this:,SPK=12;,,,,,,,,,,if(K >= 43 && K <= 50)SPK=52;,,,,,,,,,c    0      no dwarf stuff yet (wait until reaches hall of mists),if(K == 29 || K == 30)SPK=52;,,,,,,,,,,if(K == 7 || K == 36 || K == 37)SPK=10;,,,,,,,,,"c    1      reached hall of mists, but hasn't met first dwarf",if(K == 11 || K == 19)SPK=11;,,,,,,,,,,if(VERB == FIND || VERB == INVENT)SPK=59;,,,,,,,,,"c    2      met first dwarf, others start moving, no knives thrown yet",if(K == 62 || K == 65)SPK=42;,,,,,,,,,,if(K == 17)SPK=80;,,,,,,,,,c    3      a knife has been thrown (first set always misses),RSPEAK(SPK);,,,,,,,,,, goto L2;,,,,,,,,,c    3+     dwarves are mad (increases their accuracy),,,,,,,,,,,,,,,,,,,,c  sixth dwarf is special (the pirate).  he always starts at his chest's,,,,,,,,,,,,,,,,,,,,c  eventual location inside the maze.  this loc is saved in chloc for ref.,,,,,,,,,,,,,,,,,,,,c  the dead end in the other maze has its loc stored in chloc2.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  other random flags and counters, as follows:",,,,,,,,,,,,,,,,,,,,c  turns  tallies how many commands he's given (ignores yes/no),,,,,,,,,,,,,,,,,,,,c  limit  lifetime of lamp (not set here),,,,,,,,,,,,,,,,,,,,"c  iwest  how many times he's said ""west"" instead of ""w""",,,,,,,,,,,,,,,,,,,,"c  knfloc 0 if no knife here, loc if knife here, -1 after caveat",,,,,,,,,,,,,,,,,,,,"c  detail how often we've said ""not allowed to give more detail""",,,,,,,,,,,,,,,,,,,,c  abbnum how often we should print non-abbreviated descriptions,,,,,,,,,,,,,,,,,,,,c  maxdie number of reincarnation messages available (up to 5),RSPEAK(23);,,,,,,,,,,OLDLC2=LOC;,,,,,,,,,c  numdie number of times killed so far,,,,,,,,,,,,,,,,,,,,c  holdng number of objects being carried,,,,,,,,,,,if(CLOSNG) goto L95;,,,,,,,,,"c  dkill  number of dwarves killed (unused in scoring, needed for msg)",NUMDIE=NUMDIE+1;,,,,,,,,,,"if(!YES(79+NUMDIE*2,80+NUMDIE*2,54)) score(0);",,,,,,,,,"c  foobar current progress in saying ""fee fie foe foo"".",if(NUMDIE == MAXDIE) score(0);,,,,,,,,,,PLACE[WATER]=0;,,,,,,,,,c  bonus  used to determine amount of bonus if he reaches closing,PLACE[OIL]=0;,,,,,,,,,,if(TOTING(LAMP))PROP[LAMP]=0;,,,,,,,,,c  clock1 number of turns from finding last treasure till closing,/* 98 */ for (J=1; J<=100; J++) {,,,,,,,,,,I=101-J;,,,,,,,,,c  clock2 number of turns from first warning till blinding flash,if(!TOTING(I)) goto L98;,,,,,,,,,,K=OLDLC2;,,,,,,,,,c  logicals were explained earlier,if(I == LAMP)K=1;,,,,,,,,,,"DROP(I,K);",,,,,,,,,,/*etc*/ ;,,,,,,,,,,} /* end loop */,,,,,,,,,c  read the database--resume restores variables at 8305 and proceeds,LOC=3;,,,,,,,,,,OLDLOC=LOC;,,,,,,,,,c, goto L2000;,,,,,,,,,,,,,,,,,,,"      write (*,1000)",,,,,,,,,,,,,,,,,,,," 1000 format(/////////////,",RSPEAK(131);,,,,,,,,,,NUMDIE=NUMDIE+1;,,,,,,,,,"     .    '                 Classic Adventure                       ',", score(0);,,,,,,,,,,,,,,,,,,,"     . //,'             The Original Colossal Cave!                 ',",,,,,,,,,,,,,,,,,,,,"     .///,'  Written originally by William Crowther and Don Woods   ',",,,,,,,,,,,,,,,,,,,,"     .  /,'  for the DEC PDP-10 minicomputer.                       ',",,,,,,,,,,,,,,,,,,,,"     . //,'  This version is implemented for Intel-based PCs running',",,,,,,,,,,,,,,,,,,,,"     .  /,'  Windows or MS-DOS.  Written in MS-PDS FORTRAN v5.10    ',",,,,,,,,,,,,,,,,,,,,"     .  /,'  by Paul Mu¤oz-Colman of FunStuff Software.             ',",,,,,,,,,,,,,,,,,,,,"     . //,'  370-point version.  15 September 1996.                 ')",,L40300; case 3: goto L40400; case 4: goto L40500; case 5: goto,,,,,,,,,,L40600; case 6: goto L40700; case 7: goto L40800; case 8: goto,,,,,,,,c,,L40900; case 9: goto L41000; },,,,,,,,,,CAVE  BIRD  SNAKE MAZE  DARK  WITT  URN   WOODS OGRE,,,,,,,,"      open (1, file='ad.dat', form='unformatted')",,JADE */,,,,,,,,,BUG(27);,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  read the data base in array format,"if(!YES(HINTS[HINT][3],0,54)) goto L2602;",,,,,,,,,,"SETPRM(1,HINTS[HINT][2],HINTS[HINT][2]);",,,,,,,,,c,RSPEAK(261);,,,,,,,,,,"HINTED[HINT]=YES(175,HINTS[HINT][4],54);",,,,,,,,,      read (1) htloc,if(HINTED[HINT] && LIMIT > 30)LIMIT=LIMIT+30*HINTS[HINT][2];,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      write (*,10011) htloc",,,,,,,,,,,,,,,,,,,,"10011 format (///,'  Check out our web site:',//, 2X, A58,",,,,,,,,,,, goto L40020;,,,,,,,,,"     .        //,'   ... Initializing, Please Wait ...          ')",,,,,,,,,,,,,,,,,,,,, goto L40030;,,,,,,,,,,,,,,,,,,,"      read (1) abbnum,axe,back,batter,bear,bird,bonus,bottle,",,,,,,,,,,, goto L40020;,,,,,,,,,"     .  cage,cave,chain,chasm,chest,chloc,chloc2,clam,",,,,,,,,,,,,,,,,,,,,"     .  clock1,clock2,closed,closng,coins,daltlc,detail,dflag,",,1) goto L40010;,,,,,,,,, goto L40020;,,,,,,,,,"     .  dkill,dloc,door,dprssn,dragon,dseen,dwarf,eggs,",,,,,,,,,,,,,,,,,,,,"     .  emrald,entrnc,find,fissur,foobar,food,gaveup,grate", goto L40020;,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      read (1) invent,iwest,keys,knfloc,knife,lamp,lmwarn,",,,,,,,,,,, goto L40020;,,,,,,,,,"     .  lock,look,magzin,maxdie,maxtrs,messag,mirror,nugget,",,,,,,,,,,,,,,,,,,,,"     .  null,numdie,oil,oyster,panic,pearl,pillow,plant,",,L40010;,,,,,,,,, goto L40030;,,,,,,,,,"     .  plant2,pyram,rod,rod2,rug,saved,say,scorng,",,,,,,,,,,,,,,,,,,,,"     .  snake,spices,steps,tablet,tally,tally2,throw,tridnt,",if(I < 0) goto L40020;,,,,,,,,,,if(HERE(OGRE) && I == 0) goto L40010;,,,,,,,,,"     .  troll,troll2,turns,vase,vend,water,tabsiz,blklin,oldloc,fixed", goto L40030;,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,, goto L40020;,,,,,,,,,"      read (1) linuse,trvs,tabndx,obj,verb,clsses,hntmax,loc,newloc,",,,,,,,,,,,,,,,,,,,,"     .  k,j,stext,ltext,ptext,rtext,ctext,cval,key,",,,,,,,,,,,,,,,,,,,,"     .  travel,ktab,plac,fixd,actspk,cond,hints,place,prop,link,",,,,,,,,,,,,,,,,,,,,"     .  abb,atloc,holdng,hinted,hintlc,kk,i,itk,atab,lines",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      close (1),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      write (*,10001)",,,,,,,,,,,,,,,,,,,,10001 format('+                                    '),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  start-up, dwarf stuff",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,, 1    i=ran(1),,,,,,,,,,,,,,,,,,,,"      hinted(3)=yes(65,1,0)",,,,,,,,,,,,,,,,,,,,      newloc=1,,,,,,,,,,,,,,,,,,,,      limit=330,,,,,,,,,,,,,,,,,,,,      if(hinted(3).eq.1)limit=1000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  can't leave cave once it's closing (except by main office).,,,,,,,,,,,,,,,,,,,,,PROP[FISSUR]=0;,,,,,,,,,,/* 10010 */ for (I=1; I<=6; I++) {,,,,,,,,, 2    if(newloc.ge.9.or.newloc.eq.0.or.closng.eq.0) go to 71,DSEEN[I]=FALSE;,,,,,,,,,,,,,,,,,,,      call rspeak(130),} /* end loop */,,,,,,,,,,"MOVE(TROLL,0);",,,,,,,,,      newloc=loc,"MOVE(TROLL+100,0);",,,,,,,,,,"MOVE(TROLL2,PLAC[TROLL]);",,,,,,,,,      if(panic.eq.0)clock2=15,"MOVE(TROLL2+100,FIXD[TROLL]);",,,,,,,,,,JUGGLE(CHASM);,,,,,,,,,      panic=1,if(PROP[BEAR] != 3)DSTROY(BEAR);,,,,,,,,,,PROP[CHAIN]=0;,,,,,,,,,,FIXED[CHAIN]=0;,,,,,,,,,,PROP[AXE]=0;,,,,,,,,,"c  see if a dwarf has seen him and has come from where he wants to go.  if so,",FIXED[AXE]=0;,,,,,,,,,,RSPEAK(129);,,,,,,,,,c  the dwarf's blocking his way.  if coming from place forbidden to pirate,CLOCK1= -1;,,,,,,,,,,CLOSNG=TRUE;,,,,,,,,,c  (dwarves rooted in place) let him get out (and attacked)., goto L19999;,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,," 71   if(newloc.eq.loc.or.forced(loc).eq.1.or.bitset(loc,3).eq.1)goto74",,,,,,,,,,,,,,,,,,,,"      do 73 i=1,5",,,,,,,,,,,,,,,,,,,,      if(odloc(i).ne.newloc.or.dseen(i).eq.0)goto 73,,,,,,,,,,,,,,,,,,,,      newloc=loc,,,,,,,,,,,,,,,,,,,,      call rspeak(2),,,,,,,,,,,,,,,,,,,,      goto 74,,,,,,,,,,,"PROP[PLANT]=PUT(PLANT,115,0);",,,,,,,,, 73   continue,"PROP[OYSTER]=PUT(OYSTER,115,0);",,,,,,,,,,OBJTXT[OYSTER]=3;,,,,,,,,, 74   loc=newloc,"PROP[LAMP]=PUT(LAMP,115,0);",,,,,,,,,,"PROP[ROD]=PUT(ROD,115,0);",,,,,,,,,,"PROP[DWARF]=PUT(DWARF,115,0);",,,,,,,,,,LOC=115;,,,,,,,,,c  dwarf stuff.  see earlier comments for description of variables.  remember,OLDLOC=115;,,,,,,,,,,NEWLOC=115;,,,,,,,,,c  sixth dwarf is pirate and is thus very different except for motion rules.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"I=PUT(GRATE,116,0);",,,,,,,,,"c  first off, don't let the dwarves follow him into a pit or a wall.  activate","I=PUT(SIGN,116,0);",,,,,,,,,,OBJTXT[SIGN]=OBJTXT[SIGN]+1;,,,,,,,,,c  the whole mess the first time he gets as far as the hall of mists (loc 15).,"PROP[SNAKE]=PUT(SNAKE,116,1);",,,,,,,,,,"PROP[BIRD]=PUT(BIRD,116,1);",,,,,,,,,"c  if newloc is forbidden to pirate (in particular, if it's beyond the troll","PROP[CAGE]=PUT(CAGE,116,0);",,,,,,,,,,"PROP[ROD2]=PUT(ROD2,116,0);",,,,,,,,,"c  bridge), bypass dwarf stuff.  that way pirate can't steal return toll, and","PROP[PILLOW]=PUT(PILLOW,116,0);",,,,,,,,,,,,,,,,,,,c  dwarves can't meet the bear.  also means dwarves won't follow him into dead,"PROP[MIRROR]=PUT(MIRROR,115,0);",,,,,,,,,,FIXED[MIRROR]=116;,,,,,,,,,"c  end in maze, but c'est la vie.  they'll wait for him outside the dead end.",,,,,,,,,,,/* 11010 */ for (I=1; I<=100; I++) {,,,,,,,,,,,,,,,,,,,,} /* end loop */,,,,,,,,,      nl=newloc,,,,,,,,,,,RSPEAK(132);,,,,,,,,,"      if(loc.eq.0.or.forced(loc).eq.1.or.bitset(nl,3).eq.1)goto2000",CLOSED=TRUE;,,,,,,,,,, goto L2;,,,,,,,,,      if(dflag.ne.0)goto 6000,,,,,,,,,,,,,,,,,,,,      if(loc.ge.15)dflag=1,,,,,,,,,,,,,,,,,,,,      goto 2000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  when we encounter the first dwarf, we kill 0, 1, or 2 of the 5 dwarves.  if",PROP[BATTER]=1;,,,,,,,,,,"if(TOTING(BATTER))DROP(BATTER,LOC);",,,,,,,,,"c  any of the survivors is at loc, replace him with the alternate.",LIMIT=LIMIT+2500;,,,,,,,,,,LMWARN=FALSE;,,,,,,,,,, goto L19999;,,,,,,,,,,,,,,,,,,, 6000 if(dflag.ne.1)goto 6010,,,,,,,,,,,LMWARN=TRUE;,,,,,,,,,      if(loc.lt.15.or.pct(95).eq.1)goto 2000,SPK=187;,,,,,,,,,,if(PLACE[BATTER] == 0)SPK=183;,,,,,,,,,      dflag=2,if(PROP[BATTER] == 1)SPK=189;,,,,,,,,,,RSPEAK(SPK);,,,,,,,,,"      do 6001 i=1,2", goto L19999;,,,,,,,,,,,,,,,,,,,      j=1+ran(5),,,,,,,,,,,PROP[LAMP]=0;,,,,,,,,, 6001 if(pct(50).eq.1) dloc(j)=0,if(HERE(LAMP))RSPEAK(184);,,,,,,,,,, goto L19999;,,,,,,,,,"      do 6002 i=1,5",,,,,,,,,,,,,,,,,,,,      if(dloc(i).eq.loc)dloc(i)=daltlc,,,,,,,,,,,,,,,,,,,, 6002 odloc(i)=dloc(i),,,,,,,,,,,score(0);,,,,,,,,,      call rspeak(3),,,,,,,,,,,,,,,,,,,,"      call drop(axe,loc)",,,,,,,,,,,"DO 2602 HINT=4,HNTMAX",,,,,,,,,      goto 2000,IF(HINTED(HINT))GOTO 2602,,,,,,,,,,IDONDX=HINT,,,,,,,,,,"IF(.NOT.BITSET(LOC,IDONDX))HINTLC(HINT)=-1",,,,,,,,,,HINTLC(HINT)=HINTLC(HINT)+1,,,,,,,,,"c  things are in full swing.  move each dwarf at random, except if he's seen us","IF(HINTLC(HINT).GE.HINTS(HINT,1))GOTO 40000",,,,,,,,,,CONTINUE,,,,,,,,,"c  he sticks with us.  dwarves never go to locs <15.  if wandering at random,",,,,,,,,,,,,,,,,,,,,c  they don't back up unless there's no alternative.  if they don't have to,,,,,,,,,,,,,,,,,,,,"c  move, they attack.  and, of course, dead dwarves don't do much of anything.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IF(.NOT.CLOSED)GOTO 2605,,,,,,,,, 6010 dtotal=0,IF(PROP(OYSTER).LT.0.AND.TOTING(OYSTER)),,,,,,,,,,1,"CALL PSPEAK(OYSTER,1)",,,,,,,,      attack=0,"DO 2604 I=1,100",,,,,,,,,,IDONDX=I,,,,,,,,,      stick=0,IF(TOTING(IDONDX).AND.PROP(IDONDX).LT.0),,,,,,,,,,1 PROP(IDONDX)=-1-PROP(IDONDX),,,,,,,,,"      do 6030 i=1,6",WZDARK=DARK(0),,,,,,,,,,IF(KNFLOC.GT.0.AND.KNFLOC.NE.LOC)KNFLOC=0,,,,,,,,,      if(dloc(i).eq.0)goto 6030,I=RAN(1),,,,,,,,,,"CALL GETIN(WD1,WD1X,WD2,WD2X)",,,,,,,,,      j=1,,,,,,,,,,,,,,,,,,,,      kk=dloc(i),,,,,,,,,,,,,,,,,,,,      kk=key(kk),"FOOBAR=MIN0(0,-FOOBAR)",,,,,,,,,,IF(TURNS.EQ.0.AND.WD1.EQ.'MAGIC'.AND.WD2.EQ.'MODE')CALL MAINT,,,,,,,,,      if(kk.eq.0)goto 6016,TURNS=TURNS+1,,,,,,,,,,IF(DEMO.AND.TURNS.GE.SHORT)GOTO 13000,,,,,,,,," 6012 newloc=mod(iabs(travel(kk))/1000,1000)",IF(VERB.EQ.SAY.AND.WD2.NE.0)VERB=0,,,,,,,,,,IF(VERB.EQ.SAY)GOTO 4090,,,,,,,,,      nl=newloc,IF(TALLY.EQ.0.AND.LOC.GE.15.AND.LOC.NE.33)CLOCK1=CLOCK1-1,,,,,,,,,,IF(CLOCK1.EQ.0)GOTO 10000,,,,,,,,,      trv=iabs(travel(kk))/1000000,IF(CLOCK1.LT.0)CLOCK2=CLOCK2-1,,,,,,,,,,IF(CLOCK2.EQ.0)GOTO 11000,,,,,,,,,      itk2=itk(j-1),IF(PROP(LAMP).EQ.1)LIMIT=LIMIT-1,,,,,,,,,,IF(LIMIT.LE.30.AND.HERE(BATTER).AND.PROP(BATTER).EQ.0,,,,,,,,,      if(nl.gt.300.or.nl.lt.15.or.nl.eq.odloc(i),1,.AND.HERE(LAMP))GOTO 12000,,,,,,,,,IF(LIMIT.EQ.0)GOTO 12400,,,,,,,,,     .   .or.(j.gt.1.and.nl.eq.itk2) .or.j.ge.20,IF(LIMIT.LT.0.AND.LOC.LE.8)GOTO 12600,,,,,,,,,,IF(LIMIT.LE.30)GOTO 12200,,,,,,,,,     .   .or.nl.eq.dloc(i).or.forced(nl).eq.1,K=43,,,,,,,,,,IF(LIQLOC(LOC).EQ.WATER)K=70,,,,,,,,,"     .   .or.(i.eq.6.and.bitset(nl,3).eq.1)",IF(WD1.EQ.'ENTER'.AND.(WD2.EQ.'STREA'.OR.WD2.EQ.'WATER')),,,,,,,,,,1,GOTO 2010,,,,,,,,     .   .or.trv.eq.100) go to 6014,IF(WD1.EQ.'ENTER'.AND.WD2.NE.0)GOTO 2800,,,,,,,,,,IF((WD1.NE.'WATER'.AND.WD1.NE.'OIL'),,,,,,,,,      itk(j)=newloc,1,.OR.(WD2.NE.'PLANT'.AND.WD2.NE.'DOOR'))GOTO 2610,,,,,,,,,"IF(AT(VOCAB(WD2,1)))WD2='POUR'",,,,,,,,,      j=j+1,IF(WD1.NE.'WEST')GOTO 2630,,,,,,,,,,IWEST=IWEST+1,,,,,,,,, 6014 kk=kk+1,IF(IWEST.EQ.10)CALL RSPEAK(17),,,,,,,,,,"I=VOCAB(WD1,-1)",,,,,,,,,      if(travel(kk-1).ge.0)goto 6012,IF(I.EQ.-1)GOTO 3000,,,,,,,,,,"K=MOD(I,1000)",,,,,,,,, 6016 itk(j)=odloc(i),KQ=I/1000+1,,,,,,,,,,"GOTO (8,5000,4000,2010)KQ",,,,,,,,,      if(j.ge.2)j=j-1,CALL BUG(22),,,,,,,,,,,,,,,,,,,      j=1+ran(j),,,,,,,,,,,,,,,,,,,,      odloc(i)=dloc(i),WD1=WD2,,,,,,,,,,WD1X=WD2X,,,,,,,,,      dloc(i)=itk(j),WD2=0,,,,,,,,,,GOTO 2610,,,,,,,,,      zzz=0,,,,,,,,,,,,,,,,,,,,      if (dseen(i).eq.1.and.loc.ge.15) zzz=1,,,,,,,,,,,SPK=60,,,,,,,,,      dseen(i)=0,IF(PCT(20))SPK=61,,,,,,,,,,IF(PCT(20))SPK=13,,,,,,,,,      if (zzz.eq.1.or.(dloc(i).eq.loc.or.odloc(i).eq.loc))dseen(i)=1,CALL RSPEAK(SPK),,,,,,,,,,GOTO 2600,,,,,,,,,      if(dseen(i).eq.0) go to 6030,,,,,,,,,,,,,,,,,,,,      dloc(i)=loc,,,,,,,,,,,,,,,,,,,,      if(i.ne.6)goto 6027,VERB=K,,,,,,,,,,SPK=ACTSPK(VERB),,,,,,,,,,IF(WD2.NE.0.AND.VERB.NE.SAY)GOTO 2800,,,,,,,,,,IF(VERB.EQ.SAY)OBJ=WD2,,,,,,,,,c  the pirate's spotted him.  he leaves him alone once we've found chest.,IF(OBJ.NE.0)GOTO 4090,,,,,,,,,,,,,,,,,,,"c  k counts if a treasure is here.  if not, and tally=tally2 plus one for",,,,,,,,,,,,,,,,,,,,"c  an unseen chest, let the pirate be spotted.","GOTO(8010,8000,8000,8040,2009,8040,9070,9080,8000,8000,",,,,,,,,,,"1    2011,9120,9130,8140,9150,8000,8000,8180,8000,8200,",,,,,,,,,,"2    8000,9220,9230,8240,8250,8260,8270,8000,8000,8300,",,,,,,,,,,3    8310)VERB,,,,,,,,,      if(loc.eq.chloc.or.prop(chest).ge.0)goto 6030,     TAKE DROP  SAY OPEN NOTH LOCK   ON  OFF WAVE CALM,,,,,,,,,,     WALK KILL POUR  EAT DRNK  RUB TOSS QUIT FIND INVN,,,,,,,,,      k=0,     FEED FILL BLST SCOR  FOO  BRF READ BREK WAKE SUSP,,,,,,,,,,     HOUR,,,,,,,,,"      do 6020 j=50,maxtrs",CALL BUG(23),,,,,,,,,,,,,,,,,,,c  pirate won't take pyramid from plover room or dark room (too easy!).,,,,,,,,,,,,,,,,,,,,      if(j.eq.pyram.and.(loc.eq.plac(pyram),"GOTO(9010,9020,9030,9040,2009,9040,9070,9080,9090,2011,",,,,,,,,,,"1    2011,9120,9130,9140,9150,9160,9170,2011,9190,9190,",,,,,,,,,     .   .or.loc.eq.plac(emrald)))goto 6020,"2    9210,9220,9230,2011,2011,2011,9270,9280,9290,2011,",,,,,,,,,,3    2011)VERB,,,,,,,,,      idondx=j,     TAKE DROP  SAY OPEN NOTH LOCK   ON  OFF WAVE CALM,,,,,,,,,,     WALK KILL POUR  EAT DRNK  RUB TOSS QUIT FIND INVN,,,,,,,,,      if(toting(idondx).eq.1)goto 6022,     FEED FILL BLST SCOR  FOO  BRF READ BREK WAKE SUSP,,,,,,,,,,     HOUR,,,,,,,,, 6020 if(here(idondx).eq.1)k=1,CALL BUG(24),,,,,,,,,,,,,,,,,,,      if(tally.eq.tally2+1.and.k.eq.0.and.place(chest).eq.0,,,,,,,,,,,,,,,,,,,,     .   .and.here(lamp).eq.1.and.prop(lamp).eq.1)goto 6025,,,,,,,,,,,,,,,,,,,,      if(odloc(6).ne.dloc(6).and.pct(20).eq.1)call rspeak(127),,,,,,,,,,,,,,,,,,,,      goto 6030,OBJ=K,,,,,,,,,,IF(FIXED(K).NE.LOC.AND..NOT.HERE(K))GOTO 5100,,,,,,,,,,IF(WD2.NE.0)GOTO 2800,,,,,,,,,,IF(VERB.NE.0)GOTO 4090,,,,,,,,, 6022 call rspeak(128),"CALL A5TOA1(WD1,WD1X,'?',TK,K)",,,,,,,,,,"TYPE 5015,(TK(I),I=1,K)",,,,,,,,,c  don't steal chest back from troll!,"FORMAT(/' What do you want to do with the ',20A1)",,,,,,,,,,GOTO 2600,,,,,,,,,"      if(place(messag).eq.0)call move(chest,chloc)",,,,,,,,,,,IF(K.NE.GRATE)GOTO 5110,,,,,,,,,"      call move(messag,chloc2)",IF(LOC.EQ.1.OR.LOC.EQ.4.OR.LOC.EQ.7)K=DPRSSN,,,,,,,,,,IF(LOC.GT.9.AND.LOC.LT.15)K=ENTRNC,,,,,,,,,"      do 6023 j=50,maxtrs",IF(K.NE.GRATE)GOTO 8,,,,,,,,,,IF(K.NE.DWARF)GOTO 5120,,,,,,,,,      if(j.eq.pyram.and.(loc.eq.plac(pyram),"DO 5112 I=1,5",,,,,,,,,,IF(DLOC(I).EQ.LOC.AND.DFLAG.GE.2)GOTO 5010,,,,,,,,,     .   .or.loc.eq.plac(emrald)))goto 6023,CONTINUE,,,,,,,,,,IF((LIQ(0).EQ.K.AND.HERE(BOTTLE)).OR.K.EQ.LIQLOC(LOC))GOTO 5010,,,,,,,,,      idondx=j,IF(OBJ.NE.PLANT.OR..NOT.AT(PLANT2).OR.PROP(PLANT2).EQ.0)GOTO 5130,,,,,,,,,,OBJ=PLANT2,,,,,,,,,      if(at(idondx).eq.1.and.fixed(idondx).eq.0),GOTO 5010,,,,,,,,,,IF(OBJ.NE.KNIFE.OR.KNFLOC.NE.LOC)GOTO 5140,,,,,,,,,"     .  call carry(idondx,loc)",KNFLOC=-1,,,,,,,,,,SPK=116,,,,,,,,,"      if(toting(idondx).eq.1)call drop(idondx,chloc)",GOTO 2011,,,,,,,,,,IF(OBJ.NE.ROD.OR..NOT.HERE(ROD2))GOTO 5190,,,,,,,,, 6023 continue,OBJ=ROD2,,,,,,,,,,GOTO 5010,,,,,,,,, 6024 dloc(6)=chloc,IF((VERB.EQ.FIND.OR.VERB.EQ.INVENT).AND.WD2.EQ.0)GOTO 5010,,,,,,,,,,"CALL A5TOA1(WD1,WD1X,'here.',TK,K)",,,,,,,,,      odloc(6)=chloc,"TYPE 5199,(TK(I),I=1,K)",,,,,,,,,,"FORMAT(/' I see no ',20A1)",,,,,,,,,      dseen(6)=0,GOTO 2012,,,,,,,,,,,,,,,,,,,      goto 6030,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 6025 call rspeak(186),,,,,,,,,,,,,,,,,,,,"      call move(chest,chloc)",,,,,,,,,,,,,,,,,,,,"      call move(messag,chloc2)",,,,,,,,,,,KK=KEY(LOC),,,,,,,,,      goto 6024,NEWLOC=LOC,,,,,,,,,,IF(KK.EQ.0)CALL BUG(26),,,,,,,,,,IF(K.EQ.NULL)GOTO 2,,,,,,,,,,IF(K.EQ.BACK)GOTO 20,,,,,,,,,c  this threatening little dwarf is in the room with him!,IF(K.EQ.LOOK)GOTO 30,,,,,,,,,,IF(K.EQ.CAVE)GOTO 40,,,,,,,,,,OLDLC2=OLDLOC,,,,,,,,,,OLDLOC=LOC,,,,,,,,, 6027 dtotal=dtotal+1,,,,,,,,,,,LL=IABS(TRAVEL(KK)),,,,,,,,,      if(odloc(i).ne.dloc(i))goto 6030,"IF(MOD(LL,1000).EQ.1.OR.MOD(LL,1000).EQ.K)GOTO 10",,,,,,,,,,IF(TRAVEL(KK).LT.0)GOTO 50,,,,,,,,,      attack=attack+1,KK=KK+1,,,,,,,,,,GOTO 9,,,,,,,,,      if(knfloc.ge.0)knfloc=loc,,,,,,,,,,,LL=LL/1000,,,,,,,,,      if(ran(1000).lt.95*(dflag-2))stick=stick+1,NEWLOC=LL/1000,,,,,,,,,,"K=MOD(NEWLOC,100)",,,,,,,,, 6030 continue,IF(NEWLOC.LE.300)GOTO 13,,,,,,,,,,IF(PROP(K).NE.NEWLOC/100-3)GOTO 16,,,,,,,,,,IF(TRAVEL(KK).LT.0)CALL BUG(25),,,,,,,,,,KK=KK+1,,,,,,,,,c  now we know what's happening.  let's tell the poor sucker about it.,NEWLOC=IABS(TRAVEL(KK))/1000,,,,,,,,,,IF(NEWLOC.EQ.LL)GOTO 12,,,,,,,,,,LL=NEWLOC,,,,,,,,,,GOTO 11,,,,,,,,,      if(dtotal.eq.0)goto 2000,,,,,,,,,,,IF(NEWLOC.LE.100)GOTO 14,,,,,,,,,      if(dtotal.eq.1)goto 75,IF(TOTING(K).OR.(NEWLOC.GT.200.AND.AT(K)))GOTO 16,,,,,,,,,,GOTO 12,,,,,,,,,"      write (*,67) dtotal",,,,,,,,,,,IF(NEWLOC.NE.0.AND..NOT.PCT(NEWLOC))GOTO 12,,,,,,,,," 67   format(/' There are ',i1,' THREATENING LITTLE DWARVES in the'","NEWLOC=MOD(LL,1000)",,,,,,,,,,IF(NEWLOC.LE.300)GOTO 2,,,,,,,,,"     .,' room with you.')",IF(NEWLOC.LE.500)GOTO 30000,,,,,,,,,,CALL RSPEAK(NEWLOC-500),,,,,,,,,      goto 77,NEWLOC=LOC,,,,,,,,,,GOTO 2,,,,,,,,, 75   call rspeak(4),,,,,,,,,,,,,,,,,,,, 77   if(attack.eq.0)goto 2000,,,,,,,,,,,,,,,,,,,,      if(dflag.eq.2)dflag=3,NEWLOC=NEWLOC-300,,,,,,,,,,"GOTO (30100,30200,30300)NEWLOC",,,,,,,,,      if(attack.eq.1)goto 79,CALL BUG(20),,,,,,,,,,,,,,,,,,,"      write (*,78) attack",,,,,,,,,,,,,,,,,,,," 78   format(/' ',i1,' of them THROW KNIVES at you!')",,,,,,,,,,,,,,,,,,,,      k=6,NEWLOC=99+100-LOC,,,,,,,,,,IF(HOLDNG.EQ.0.OR.(HOLDNG.EQ.1.AND.TOTING(EMRALD)))GOTO 2,,,,,,,,, 82   if(stick.gt.1)goto 83,NEWLOC=LOC,,,,,,,,,,CALL RSPEAK(117),,,,,,,,,      call rspeak(k+stick),GOTO 2,,,,,,,,,,,,,,,,,,,      if(stick.eq.0)goto 2000,,,,,,,,,,,,,,,,,,,,      goto 84,,,,,,,,,,,,,,,,,,,," 83   write (*,68) stick","CALL DROP(EMRALD,LOC)",,,,,,,,,,GOTO 12,,,,,,,,," 68   format(/' ',i1,' of them get you!')",,,,,,,,,,,,,,,,,,,, 84   oldlc2=loc,,,,,,,,,,,,,,,,,,,,      goto 99,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IF(PROP(TROLL).NE.1)GOTO 30310,,,,,,,,, 79   call rspeak(5),"CALL PSPEAK(TROLL,1)",,,,,,,,,,PROP(TROLL)=0,,,,,,,,,      k=52,"CALL MOVE(TROLL2,0)",,,,,,,,,,"CALL MOVE(TROLL2+100,0)",,,,,,,,,      goto 82,"CALL MOVE(TROLL,PLAC(TROLL))",,,,,,,,,,"CALL MOVE(TROLL+100,FIXD(TROLL))",,,,,,,,,c  describe the current location and (maybe) get next command.,CALL JUGGLE(CHASM),,,,,,,,,,NEWLOC=LOC,,,,,,,,,,GOTO 2,,,,,,,,,,,,,,,,,,,c  print text for current loc.,NEWLOC=PLAC(TROLL)+FIXD(TROLL)-LOC,,,,,,,,,,IF(PROP(TROLL).EQ.0)PROP(TROLL)=1,,,,,,,,,,IF(.NOT.TOTING(BEAR))GOTO 2,,,,,,,,,,CALL RSPEAK(162),,,,,,,,, 2000 if(loc.eq.0)goto 99,PROP(CHASM)=1,,,,,,,,,,PROP(TROLL)=2,,,,,,,,,      kk=stext(loc),"CALL DROP(BEAR,NEWLOC)",,,,,,,,,,FIXED(BEAR)=-1,,,,,,,,,"      if(mod(abb(loc),abbnum).eq.0.or.kk.eq.0)kk=ltext(loc)",PROP(BEAR)=3,,,,,,,,,,IF(PROP(SPICES).LT.0)TALLY2=TALLY2+1,,,,,,,,,      if(forced(loc).eq.1.or.dark(0).eq.0)goto 2001,OLDLC2=NEWLOC,,,,,,,,,,GOTO 99,,,,,,,,,      if(wzdark.eq.1.and.pct(35).eq.1)goto 90,,,,,,,,,,,,,,,,,,,,      kk=rtext(16),,,,,,,,,,,,,,,,,,,, 2001 if(toting(bear).eq.1)call rspeak(141),,,,,,,,,,,,,,,,,,,,      kk2=kk,K=OLDLOC,,,,,,,,,,IF(FORCED(K))K=OLDLC2,,,,,,,,,      call speak(kk2),OLDLC2=OLDLOC,,,,,,,,,,OLDLOC=LOC,,,,,,,,,      k=1,K2=0,,,,,,,,,,IF(K.NE.LOC)GOTO 21,,,,,,,,,      if(forced(loc).eq.1)goto 8,CALL RSPEAK(91),,,,,,,,,,GOTO 2,,,,,,,,,      if(loc.eq.33.and.pct(25).eq.1.and.closng.eq.0)call rspeak(8),,,,,,,,,,,"LL=MOD((IABS(TRAVEL(KK))/1000),1000)",,,,,,,,,,IF(LL.EQ.K)GOTO 25,,,,,,,,,,IF(LL.GT.300)GOTO 22,,,,,,,,,c  print out descriptions of objects at this location.  if not closing and,J=KEY(LL),,,,,,,,,,"IF(FORCED(LL).AND.MOD((IABS(TRAVEL(J))/1000),1000).EQ.K)K2=KK",,,,,,,,,"c  property value is negative, tally off another treasure.  rug is special",IF(TRAVEL(KK).LT.0)GOTO 23,,,,,,,,,,KK=KK+1,,,,,,,,,"c  case; once seen, its prop is 1 (dragon on it) till dragon is killed.",GOTO 21,,,,,,,,,,,,,,,,,,,c  similarly for chain; prop is initially 1 (locked to bear).  these hacks,KK=K2,,,,,,,,,,IF(KK.NE.0)GOTO 25,,,,,,,,,c  are because prop=0 is needed to get full score.,CALL RSPEAK(140),,,,,,,,,,GOTO 2,,,,,,,,,,,,,,,,,,,,"K=MOD(IABS(TRAVEL(KK)),1000)",,,,,,,,,      if(dark(0).eq.1)goto 2012,KK=KEY(LOC),,,,,,,,,,GOTO 9,,,,,,,,,      abb(loc)=abb(loc)+1,,,,,,,,,,,,,,,,,,,,      i=atloc(loc),,,,,,,,,,,,,,,,,,,,      blklin=1,IF(DETAIL.LT.3)CALL RSPEAK(15),,,,,,,,,,DETAIL=DETAIL+1,,,,,,,,, 2004 if(i.eq.0)goto 2012,WZDARK=.FALSE.,,,,,,,,,,ABB(LOC)=0,,,,,,,,,      obj=i,GOTO 2,,,,,,,,,,,,,,,,,,,      if(obj.gt.100)obj=obj-100,,,,,,,,,,,,,,,,,,,,      if(obj.eq.steps.and.toting(nugget).eq.1)goto 2008,IF(LOC.LT.8)CALL RSPEAK(57),,,,,,,,,,IF(LOC.GE.8)CALL RSPEAK(58),,,,,,,,,      if(prop(obj).ge.0)goto 2006,GOTO 2,,,,,,,,,,,,,,,,,,,      if(closed.eq.1)goto 2008,,,,,,,,,,,,,,,,,,,,      prop(obj)=0,SPK=12,,,,,,,,,,IF(K.GE.43.AND.K.LE.50)SPK=9,,,,,,,,,      if(obj.eq.rug.or.obj.eq.chain)prop(obj)=1,IF(K.EQ.29.OR.K.EQ.30)SPK=9,,,,,,,,,,IF(K.EQ.7.OR.K.EQ.36.OR.K.EQ.37)SPK=10,,,,,,,,,      tally=tally-1,IF(K.EQ.11.OR.K.EQ.19)SPK=11,,,,,,,,,,IF(VERB.EQ.FIND.OR.VERB.EQ.INVENT)SPK=59,,,,,,,,,"c  if remaining treasures too elusive, zap his lamp.",IF(K.EQ.62.OR.K.EQ.65)SPK=42,,,,,,,,,,IF(K.EQ.17)SPK=80,,,,,,,,,"      if(tally.eq.tally2.and.tally.ne.0)limit=min0(35,limit)",CALL RSPEAK(SPK),,,,,,,,,,GOTO 2,,,,,,,,, 2006 kk=prop(obj),,,,,,,,,,,,,,,,,,,,      if(obj.eq.steps.and.loc.eq.fixed(steps))kk=1,,,,,,,,,,,,,,,,,,,,      kk2=kk,,,,,,,,,,,,,,,,,,,,"      call pspeak(obj,kk2)",,,,,,,,,,,,,,,,,,,,      if (blklin.eq.1) blklin=0,,,,,,,,,,,,,,,,,,,, 2008 i=link(i),,,,,,,,,,,,,,,,,,,,      goto 2004,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 2009 k=54,,,,,,,,,,,,,,,,,,,, 2010 spk=k,,,,,,,,,,,,,,,,,,,, 2011 call rspeak(spk),,,,,,,,,,,CALL RSPEAK(23),,,,,,,,,,OLDLC2=LOC,,,,,,,,,,,,,,,,,,, 2012 verb=0,,,,,,,,,,,,,,,,,,,,      obj=0,IF(CLOSNG)GOTO 95,,,,,,,,,,"YEA=YES(81+NUMDIE*2,82+NUMDIE*2,54)",,,,,,,,,      blklin=1,NUMDIE=NUMDIE+1,,,,,,,,,,IF(NUMDIE.EQ.MAXDIE.OR..NOT.YEA)GOTO 20000,,,,,,,,,,PLACE(WATER)=0,,,,,,,,,,PLACE(OIL)=0,,,,,,,,,"c  check if this loc is eligible for any hints.  if been here long enough,",IF(TOTING(LAMP))PROP(LAMP)=0,,,,,,,,,,"DO 98 J=1,100",,,,,,,,,c  branch to help section (on later page).  hints all come back here eventually,I=101-J,,,,,,,,,,IF(.NOT.TOTING(I))GOTO 98,,,,,,,,,"c  to finish the loop.  ignore ""hints"" < 4 (special stuff, see database notes).",K=OLDLC2,,,,,,,,,,IF(I.EQ.LAMP)K=1,,,,,,,,,,"CALL DROP(I,K)",,,,,,,,,,CONTINUE,,,,,,,,," 2600 do 2602 hint=4,hntmax",LOC=3,,,,,,,,,,OLDLOC=LOC,,,,,,,,,      if(hinted(hint).eq.1)goto 2602,GOTO 2000,,,,,,,,,,,,,,,,,,,      idondx=hint,,,,,,,,,,,,,,,,,,,,"      if(bitset(loc,idondx).eq.0)hintlc(hint)=-1",CALL RSPEAK(131),,,,,,,,,,NUMDIE=NUMDIE+1,,,,,,,,,      hintlc(hint)=hintlc(hint)+1,GOTO 20000,,,,,,,,,,,,,,,,,,,"      if(hintlc(hint).ge.hints(hint,1))goto 40000",,,,,,,,,,,,,,,,,,,, 2602 continue,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  kick the random number generator just to add variety to the chase.  also,",,,,,,,,,,,,,,,,,,,,"c  if closing time, check for any objects being toted with prop < 0 and set",,,,,,,,,,,"CALL A5TOA1(WD1,WD1X,'What?',TK,K)",,,,,,,,,c  the prop to -1-prop.  this way objects won't be described until they've,"TYPE 8002,(TK(I),I=1,K)",,,,,,,,,,"FORMAT(/' ',20A1)",,,,,,,,,c  been picked up and put down seperate from their seperate piles.  don't,OBJ=0,,,,,,,,,,GOTO 2600,,,,,,,,,c  tick clock1 unless well into cave (and not at y2).,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,IF(ATLOC(LOC).EQ.0.OR.LINK(ATLOC(LOC)).NE.0)GOTO 8000,,,,,,,,,26021 continue,"DO 8012 I=1,5",,,,,,,,,,IF(DLOC(I).EQ.LOC.AND.DFLAG.GE.2)GOTO 8000,,,,,,,,,      if(closed.eq.0)goto 2605,CONTINUE,,,,,,,,,,OBJ=ATLOC(LOC),,,,,,,,,      if(prop(oyster).lt.0.and.toting(oyster).eq.1),,,,,,,,,,,,,,,,,,,,"     .   call pspeak(oyster,1)",,,,,,,,,,,,,,,,,,,,"      do 2604 i=1,100",,,,,,,,,,,IF(TOTING(OBJ))GOTO 2011,,,,,,,,,      idondx=i,SPK=25,,,,,,,,,,IF(OBJ.EQ.PLANT.AND.PROP(PLANT).LE.0)SPK=115,,,,,,,,, 2604 if(toting(idondx).eq.1.and.prop(idondx).lt.0),IF(OBJ.EQ.BEAR.AND.PROP(BEAR).EQ.1)SPK=169,,,,,,,,,,IF(OBJ.EQ.CHAIN.AND.PROP(BEAR).NE.0)SPK=170,,,,,,,,,     .   prop(idondx)=-1-prop(idondx),IF(FIXED(OBJ).NE.0)GOTO 2011,,,,,,,,,,IF(OBJ.NE.WATER.AND.OBJ.NE.OIL)GOTO 9017,,,,,,,,, 2605 wzdark=dark(0),IF(HERE(BOTTLE).AND.LIQ(0).EQ.OBJ)GOTO 9018,,,,,,,,,,OBJ=BOTTLE,,,,,,,,,      if(knfloc.gt.0.and.knfloc.ne.loc)knfloc=0,IF(TOTING(BOTTLE).AND.PROP(BOTTLE).EQ.1)GOTO 9220,,,,,,,,,,IF(PROP(BOTTLE).NE.1)SPK=105,,,,,,,,,      i=ran(1),IF(.NOT.TOTING(BOTTLE))SPK=104,,,,,,,,,,GOTO 2011,,,,,,,,,"      call getin(wd1,wd1x,wd2,wd2x)",OBJ=BOTTLE,,,,,,,,,,IF(HOLDNG.LT.7)GOTO 9016,,,,,,,,,,CALL RSPEAK(92),,,,,,,,,,GOTO 2012,,,,,,,,,"c  every input, check ""foobar"" flag.  if zero, nothing's going on.  if pos,",IF(OBJ.NE.BIRD)GOTO 9014,,,,,,,,,,IF(PROP(BIRD).NE.0)GOTO 9014,,,,,,,,,"c  make neg.  if neg, he skipped a word, so make it zero.",IF(.NOT.TOTING(ROD))GOTO 9013,,,,,,,,,,CALL RSPEAK(26),,,,,,,,,,GOTO 2012,,,,,,,,,,IF(TOTING(CAGE))GOTO 9015,,,,,,,,," 2608 foobar=min0(0,-foobar)",CALL RSPEAK(27),,,,,,,,,,GOTO 2012,,,,,,,,,      if (turns.eq.0.and.wd1.eq.'resu')go to 8305,PROP(BIRD)=1,,,,,,,,,,IF((OBJ.EQ.BIRD.OR.OBJ.EQ.CAGE).AND.PROP(BIRD).NE.0),,,,,,,,,      turns=turns+1,1,"CALL CARRY(BIRD+CAGE-OBJ,LOC)",,,,,,,,,"CALL CARRY(OBJ,LOC)",,,,,,,,,      if(verb.eq.say.and.wd2.ne.iz)verb=0,K=LIQ(0),,,,,,,,,,IF(OBJ.EQ.BOTTLE.AND.K.NE.0)PLACE(K)=-1,,,,,,,,,      if(verb.eq.say)goto 4090,GOTO 2009,,,,,,,,,,,,,,,,,,,      if(tally.eq.0.and.loc.ge.15.and.loc.ne.33)clock1=clock1-1,,,,,,,,,,,,,,,,,,,,      if(clock1.eq.0)goto 10000,,,,,,,,,,,,,,,,,,,,      if(clock1.lt.0)clock2=clock2-1,IF(TOTING(ROD2).AND.OBJ.EQ.ROD.AND..NOT.TOTING(ROD))OBJ=ROD2,,,,,,,,,,IF(.NOT.TOTING(OBJ))GOTO 2011,,,,,,,,,      if(clock2.eq.0)goto 11000,IF(OBJ.NE.BIRD.OR..NOT.HERE(SNAKE))GOTO 9024,,,,,,,,,,CALL RSPEAK(30),,,,,,,,,      if(prop(lamp).eq.1)limit=limit-1,IF(CLOSED)GOTO 19000,,,,,,,,,,CALL DSTROY(SNAKE),,,,,,,,,      if(limit.le.30.and.here(batter).eq.1.and.prop(batter).eq.0,,,,,,,,,,,PROP(SNAKE)=1,,,,,,,,,     . .and.here(lamp).eq.1)goto 12000,K=LIQ(0),,,,,,,,,,IF(K.EQ.OBJ)OBJ=BOTTLE,,,,,,,,,      if(limit.eq.0)goto 12400,IF(OBJ.EQ.BOTTLE.AND.K.NE.0)PLACE(K)=0,,,,,,,,,,"IF(OBJ.EQ.CAGE.AND.PROP(BIRD).NE.0)CALL DROP(BIRD,LOC)",,,,,,,,,      if(limit.lt.0.and.loc.le.8)goto 12600,IF(OBJ.EQ.BIRD)PROP(BIRD)=0,,,,,,,,,,"CALL DROP(OBJ,LOC)",,,,,,,,,      if(limit.le.30)goto 12200,GOTO 2012,,,,,,,,,,,,,,,,,,,19999  k=43,IF(OBJ.NE.COINS.OR..NOT.HERE(VEND))GOTO 9025,,,,,,,,,,CALL DSTROY(COINS),,,,,,,,,      if(liqloc(loc).eq.water)k=70,"CALL DROP(BATTER,LOC)",,,,,,,,,,"CALL PSPEAK(BATTER,0)",,,,,,,,,      if(wd1.eq.'ente'.and.(wd2.eq.'stre'.or.wd2.eq.'wate')),GOTO 2012,,,,,,,,,,,,,,,,,,,     .   goto 2010,IF(OBJ.NE.BIRD.OR..NOT.AT(DRAGON).OR.PROP(DRAGON).NE.0)GOTO 9026,,,,,,,,,,CALL RSPEAK(154),,,,,,,,,      if(wd1.eq.'ente'.and.wd2.ne.iz)goto 2800,CALL DSTROY(BIRD),,,,,,,,,,PROP(BIRD)=0,,,,,,,,,      if((wd1.ne.'wate'.and.wd1.ne.'oil '),IF(PLACE(SNAKE).EQ.PLAC(SNAKE))TALLY2=TALLY2+1,,,,,,,,,,GOTO 2012,,,,,,,,,     . .or.(wd2.ne.'plan'.and.wd2.ne.'door'))goto 2610,,,,,,,,,,,IF(OBJ.NE.BEAR.OR..NOT.AT(TROLL))GOTO 9027,,,,,,,,,"      if(at(vocab(wd2,1)).eq.1)wd2='pour'",CALL RSPEAK(163),,,,,,,,,,"CALL MOVE(TROLL,0)",,,,,,,,, 2610 if(wd1.ne.'west')goto 2630,"CALL MOVE(TROLL+100,0)",,,,,,,,,,"CALL MOVE(TROLL2,PLAC(TROLL))",,,,,,,,,      iwest=iwest+1,"CALL MOVE(TROLL2+100,FIXD(TROLL))",,,,,,,,,,CALL JUGGLE(CHASM),,,,,,,,,      if(iwest.eq.10)call rspeak(17),PROP(TROLL)=2,,,,,,,,,,GOTO 9021,,,,,,,,," 2630 i=vocab(wd1,-1)",,,,,,,,,,,IF(OBJ.EQ.VASE.AND.LOC.NE.PLAC(PILLOW))GOTO 9028,,,,,,,,,      if(i.eq.-1)goto 3000,CALL RSPEAK(54),,,,,,,,,,GOTO 9021,,,,,,,,,"      k=mod(i,1000)",,,,,,,,,,,PROP(VASE)=2,,,,,,,,,      kq=i/1000+1,IF(AT(PILLOW))PROP(VASE)=0,,,,,,,,,,"CALL PSPEAK(VASE,PROP(VASE)+1)",,,,,,,,,      if(kq.gt.4) call bug(22),IF(PROP(VASE).NE.0)FIXED(VASE)=-1,,,,,,,,,,GOTO 9021,,,,,,,,,"      goto (8,5000,4000,2010),kq",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"CALL A5TOA1(WD2,WD2X,'"".',TK,K)",,,,,,,,,c  get second word for analysis.,"IF(WD2.EQ.0)CALL A5TOA1(WD1,WD1X,'"".',TK,K)",,,,,,,,,,IF(WD2.NE.0)WD1=WD2,,,,,,,,,,"I=VOCAB(WD1,-1)",,,,,,,,,,IF(I.EQ.62.OR.I.EQ.65.OR.I.EQ.71.OR.I.EQ.2025)GOTO 9035,,,,,,,,, 2800 wd1=wd2,"TYPE 9032,(TK(I),I=1,K)",,,,,,,,,,"FORMAT(/' Okay, ""',20A1)",,,,,,,,,      wd1x=wd2x,GOTO 2012,,,,,,,,,,,,,,,,,,,      wd2=iz,WD2=0,,,,,,,,,,OBJ=0,,,,,,,,,      goto 2610,GOTO 2630,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  gee, i don't understand.",SPK=28,,,,,,,,,,IF(HERE(CLAM))OBJ=CLAM,,,,,,,,,,IF(HERE(OYSTER))OBJ=OYSTER,,,,,,,,,,IF(AT(DOOR))OBJ=DOOR,,,,,,,,, 3000 spk=60,IF(AT(GRATE))OBJ=GRATE,,,,,,,,,,IF(OBJ.NE.0.AND.HERE(CHAIN))GOTO 8000,,,,,,,,,      if(pct(20).eq.1)spk=61,IF(HERE(CHAIN))OBJ=CHAIN,,,,,,,,,,IF(OBJ.EQ.0)GOTO 2011,,,,,,,,,      if(pct(20).eq.1)spk=13,,,,,,,,,,,,,,,,,,,,      call rspeak(spk),,,,,,,,,,,IF(OBJ.EQ.CLAM.OR.OBJ.EQ.OYSTER)GOTO 9046,,,,,,,,,      goto 2600,IF(OBJ.EQ.DOOR)SPK=111,,,,,,,,,,IF(OBJ.EQ.DOOR.AND.PROP(DOOR).EQ.1)SPK=54,,,,,,,,,,IF(OBJ.EQ.CAGE)SPK=32,,,,,,,,,,IF(OBJ.EQ.KEYS)SPK=55,,,,,,,,,"c  analyze a verb.  remember what it was, go back for object if second word",IF(OBJ.EQ.GRATE.OR.OBJ.EQ.CHAIN)SPK=31,,,,,,,,,,IF(SPK.NE.31.OR..NOT.HERE(KEYS))GOTO 2011,,,,,,,,,"c  unless verb is ""say"", which snarfs arbitrary second word.",IF(OBJ.EQ.CHAIN)GOTO 9048,,,,,,,,,,IF(.NOT.CLOSNG)GOTO 9043,,,,,,,,,,K=130,,,,,,,,,,IF(.NOT.PANIC)CLOCK2=15,,,,,,,,, 4000 verb=k,PANIC=.TRUE.,,,,,,,,,,GOTO 2010,,,,,,,,,      spk=actspk(verb),,,,,,,,,,,K=34+PROP(GRATE),,,,,,,,,      if(wd2.ne.iz.and.verb.ne.say)goto 2800,PROP(GRATE)=1,,,,,,,,,,IF(VERB.EQ.LOCK)PROP(GRATE)=0,,,,,,,,,      if(verb.eq.say)obj=wd2,K=K+2*PROP(GRATE),,,,,,,,,,GOTO 2010,,,,,,,,,      if(verb.gt.31)call bug(23),,,,,,,,,,,,,,,,,,,,      if(obj.ne.0)goto 4090,K=0,,,,,,,,,,IF(OBJ.EQ.OYSTER)K=1,,,,,,,,,,SPK=124+K,,,,,,,,,,IF(TOTING(OBJ))SPK=120+K,,,,,,,,,"c  analyze an intransitive verb (ie, no object given yet).",IF(.NOT.TOTING(TRIDNT))SPK=122+K,,,,,,,,,,IF(VERB.EQ.LOCK)SPK=61,,,,,,,,,,IF(SPK.NE.124)GOTO 2011,,,,,,,,,,CALL DSTROY(CLAM),,,,,,,,," 4080 goto(8010,8000,8000,8040,2009,8040,9070,9080,8000,8000,","CALL DROP(OYSTER,LOC)",,,,,,,,,,"CALL DROP(PEARL,105)",,,,,,,,,"     .    2011,9120,9130,8140,9150,8000,8000,8180,8000,8200,",GOTO 2011,,,,,,,,,,,,,,,,,,,"     .    8000,9220,9230,8240,8250,8260,8270,8000,8000,8300,",,,,,,,,,,,IF(VERB.EQ.LOCK)GOTO 9049,,,,,,,,,"     .    8310),verb",SPK=171,,,,,,,,,,IF(PROP(BEAR).EQ.0)SPK=41,,,,,,,,,c         take drop  say open noth lock   on  off wave calm,IF(PROP(CHAIN).EQ.0)SPK=37,,,,,,,,,,IF(SPK.NE.171)GOTO 2011,,,,,,,,,c         walk kill pour  eat drnk  rub toss quit find invn,PROP(CHAIN)=0,,,,,,,,,,FIXED(CHAIN)=0,,,,,,,,,c         feed fill blst scor  foo  brf read brek wake susp,IF(PROP(BEAR).NE.3)PROP(BEAR)=2,,,,,,,,,,FIXED(BEAR)=2-PROP(BEAR),,,,,,,,,c         hour,GOTO 2011,,,,,,,,,,,,,,,,,,,,SPK=172,,,,,,,,,,IF(PROP(CHAIN).NE.0)SPK=34,,,,,,,,,c  analyze a transitive verb.,IF(LOC.NE.PLAC(CHAIN))SPK=173,,,,,,,,,,IF(SPK.NE.172)GOTO 2011,,,,,,,,,,PROP(CHAIN)=2,,,,,,,,,,"IF(TOTING(CHAIN))CALL DROP(CHAIN,LOC)",,,,,,,,," 4090 goto(9010,9020,9030,9040,2009,9040,9070,9080,9090,2011,",FIXED(CHAIN)=-1,,,,,,,,,,GOTO 2011,,,,,,,,,"     .    2011,9120,9130,9140,9150,9160,9170,2011,9190,9190,",,,,,,,,,,,,,,,,,,,,"     .    9210,9220,9230,2011,2011,2011,9270,9280,9290,2011,",,,,,,,,,,,IF(.NOT.HERE(LAMP))GOTO 2011,,,,,,,,,"     .    2011),verb",SPK=184,,,,,,,,,,IF(LIMIT.LT.0)GOTO 2011,,,,,,,,,c         take drop  say open noth lock   on  off wave calm,PROP(LAMP)=1,,,,,,,,,,CALL RSPEAK(39),,,,,,,,,c         walk kill pour  eat drnk  rub toss quit find invn,IF(WZDARK)GOTO 2000,,,,,,,,,,GOTO 2012,,,,,,,,,c         feed fill blst scor  foo  brf read brek wake susp,,,,,,,,,,,,,,,,,,,,c         hour,,,,,,,,,,,IF(.NOT.HERE(LAMP))GOTO 2011,,,,,,,,,,PROP(LAMP)=0,,,,,,,,,,CALL RSPEAK(40),,,,,,,,,"c  analyze an object word.  see if the thing is here, whether we've got a verb",IF(DARK(0))CALL RSPEAK(16),,,,,,,,,,GOTO 2012,,,,,,,,,"c  yet, and so on.  object must be here unless verb is ""find"" or ""invent(ory)""",,,,,,,,,,,,,,,,,,,,"c  (and no new verb yet to be analyzed).  water and oil are also funny, since",,,,,,,,,,,IF((.NOT.TOTING(OBJ)).AND.(OBJ.NE.ROD.OR..NOT.TOTING(ROD2))),,,,,,,,,"c  they are never actually dropped at any location, but might be here inside",1,SPK=29,,,,,,,,,IF(OBJ.NE.ROD.OR..NOT.AT(FISSUR).OR..NOT.TOTING(OBJ),,,,,,,,,c  the bottle or as a feature of the location.,1,.OR.CLOSNG)GOTO 2011,,,,,,,,,PROP(FISSUR)=1-PROP(FISSUR),,,,,,,,,,"CALL PSPEAK(FISSUR,2-PROP(FISSUR))",,,,,,,,,,GOTO 2012,,,,,,,,, 5000 obj=k,,,,,,,,,,,,,,,,,,,,      if(fixed(k).ne.loc.and.here(k).eq.0)goto 5100,,,,,,,,,,,,,,,,,,,, 5010 if(wd2.ne.iz)goto 2800,,,,,,,,,,,"DO 9121 I=1,5",,,,,,,,,      if(verb.ne.0)goto 4090,IF(DLOC(I).EQ.LOC.AND.DFLAG.GE.2)GOTO 9122,,,,,,,,,,CONTINUE,,,,,,,,,"      call a5toa1(wd1,wd1x,'?   ','    ',tk,k)",I=0,,,,,,,,,,IF(OBJ.NE.0)GOTO 9124,,,,,,,,,"      write (*,5015) (tk(i),i=1,k)",IF(I.NE.0)OBJ=DWARF,,,,,,,,,,IF(HERE(SNAKE))OBJ=OBJ*100+SNAKE,,,,,,,,," 5015 format(/' What do you want to do with the ',20a1)",IF(AT(DRAGON).AND.PROP(DRAGON).EQ.0)OBJ=OBJ*100+DRAGON,,,,,,,,,,IF(AT(TROLL))OBJ=OBJ*100+TROLL,,,,,,,,,      goto 2600,IF(HERE(BEAR).AND.PROP(BEAR).EQ.0)OBJ=OBJ*100+BEAR,,,,,,,,,,IF(OBJ.GT.100)GOTO 8000,,,,,,,,,,IF(OBJ.NE.0)GOTO 9124,,,,,,,,,,,,,,,,,,, 5100 if(k.ne.grate)goto 5110,IF(HERE(BIRD).AND.VERB.NE.THROW)OBJ=BIRD,,,,,,,,,,,,,,,,,,,      if(loc.eq.1.or.loc.eq.4.or.loc.eq.7)k=dprssn,IF(HERE(CLAM).OR.HERE(OYSTER))OBJ=100*OBJ+CLAM,,,,,,,,,,IF(OBJ.GT.100)GOTO 8000,,,,,,,,,      if(loc.gt.9.and.loc.lt.15)k=entrnc,IF(OBJ.NE.BIRD)GOTO 9125,,,,,,,,,,SPK=137,,,,,,,,,      if(k.ne.grate)goto 8,IF(CLOSED)GOTO 2011,,,,,,,,,,CALL DSTROY(BIRD),,,,,,,,, 5110 if(k.ne.dwarf)goto 5120,PROP(BIRD)=0,,,,,,,,,,IF(PLACE(SNAKE).EQ.PLAC(SNAKE))TALLY2=TALLY2+1,,,,,,,,,"      do 5112 i=1,5",SPK=45,,,,,,,,,,IF(OBJ.EQ.0)SPK=44,,,,,,,,,      if(dloc(i).eq.loc.and.dflag.ge.2)goto 5010,IF(OBJ.EQ.CLAM.OR.OBJ.EQ.OYSTER)SPK=150,,,,,,,,,,IF(OBJ.EQ.SNAKE)SPK=46,,,,,,,,, 5112 continue,IF(OBJ.EQ.DWARF)SPK=49,,,,,,,,,,IF(OBJ.EQ.DWARF.AND.CLOSED)GOTO 19000,,,,,,,,, 5120 if((liq(0).eq.k.and.here(bottle).eq.1).or.k.eq.liqloc(loc)),IF(OBJ.EQ.DRAGON)SPK=167,,,,,,,,,,IF(OBJ.EQ.TROLL)SPK=157,,,,,,,,,     .  go to 5010,IF(OBJ.EQ.BEAR)SPK=165+(PROP(BEAR)+1)/2,,,,,,,,,,IF(OBJ.NE.DRAGON.OR.PROP(DRAGON).NE.0)GOTO 2011,,,,,,,,,      if(obj.ne.plant.or.at(plant2).eq.0.or.prop(plant2).eq.0)goto 5130,,,,,,,,,,,,,,,,,,,,      obj=plant2,,,,,,,,,,,CALL RSPEAK(49),,,,,,,,,      goto 5010,VERB=0,,,,,,,,,,OBJ=0,,,,,,,,, 5130 if(obj.ne.knife.or.knfloc.ne.loc)goto 5140,"CALL GETIN(WD1,WD1X,WD2,WD2X)",,,,,,,,,,IF(WD1.NE.'Y'.AND.WD1.NE.'YES')GOTO 2608,,,,,,,,,      knfloc=-1,"CALL PSPEAK(DRAGON,1)",,,,,,,,,,PROP(DRAGON)=2,,,,,,,,,      spk=116,PROP(RUG)=0,,,,,,,,,,K=(PLAC(DRAGON)+FIXD(DRAGON))/2,,,,,,,,,      goto 2011,"CALL MOVE(DRAGON+100,-1)",,,,,,,,,,"CALL MOVE(RUG+100,0)",,,,,,,,, 5140 if(obj.ne.rod.or.here(rod2).eq.0)go to 5190,"CALL MOVE(DRAGON,K)",,,,,,,,,,"CALL MOVE(RUG,K)",,,,,,,,,      obj=rod2,"DO 9126 OBJ=1,100",,,,,,,,,,IDONDX=OBJ,,,,,,,,,      goto 5010,IF(PLACE(IDONDX).EQ.PLAC(DRAGON).OR.,,,,,,,,,,1 PLACE(IDONDX).EQ.FIXD(DRAGON)),,,,,,,,, 5190 if((verb.eq.find.or.verb.eq.invent).and.wd2.eq.iz)goto 5010,"2 CALL MOVE(IDONDX,K)",,,,,,,,,,CONTINUE,,,,,,,,,"      call a5toa1(wd1,wd1x,' her','e.  ',tk,k)",LOC=K,,,,,,,,,,K=NULL,,,,,,,,,"      write (*,5199) (tk(i),i=1,k)",GOTO 8,,,,,,,,,,,,,,,,,,," 5199 format(/' I see no ',20a1)",,,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,IF(OBJ.EQ.BOTTLE.OR.OBJ.EQ.0)OBJ=LIQ(0),,,,,,,,,c  figure out the new location,IF(OBJ.EQ.0)GOTO 8000,,,,,,,,,,IF(.NOT.TOTING(OBJ))GOTO 2011,,,,,,,,,c,SPK=78,,,,,,,,,,IF(OBJ.NE.OIL.AND.OBJ.NE.WATER)GOTO 2011,,,,,,,,,"c  given the current location in ""loc"", and a motion verb number in ""k"", put",PROP(BOTTLE)=1,,,,,,,,,,PLACE(OBJ)=0,,,,,,,,,"c  the new location in ""newloc"".  the current loc is saved in ""oldloc"" in case",SPK=77,,,,,,,,,,IF(.NOT.(AT(PLANT).OR.AT(DOOR)))GOTO 2011,,,,,,,,,"c  he wants to retreat.  the current oldloc is saved in oldlc2, in case he",,,,,,,,,,,IF(AT(DOOR))GOTO 9132,,,,,,,,,"c  dies.  (if he does, newloc will be limbo, and oldloc will be what killed",SPK=112,,,,,,,,,,IF(OBJ.NE.WATER)GOTO 2011,,,,,,,,,"c  him, so we need oldlc2, which is the last place he was safe.)","CALL PSPEAK(PLANT,PROP(PLANT)+1)",,,,,,,,,,"PROP(PLANT)=MOD(PROP(PLANT)+2,6)",,,,,,,,,,PROP(PLANT2)=PROP(PLANT)/2,,,,,,,,,,K=NULL,,,,,,,,, 8    kk=key(loc),GOTO 8,,,,,,,,,,,,,,,,,,,      newloc=loc,PROP(DOOR)=0,,,,,,,,,,IF(OBJ.EQ.OIL)PROP(DOOR)=1,,,,,,,,,      if(kk.eq.0)call bug(26),SPK=113+PROP(DOOR),,,,,,,,,,GOTO 2011,,,,,,,,,      if(k.eq.null)goto 2,,,,,,,,,,,,,,,,,,,,      if(k.eq.back)goto 20,,,,,,,,,,,,,,,,,,,,      if(k.eq.look)goto 30,IF(.NOT.HERE(FOOD))GOTO 8000,,,,,,,,,,CALL DSTROY(FOOD),,,,,,,,,      if(k.eq.cave)goto 40,SPK=72,,,,,,,,,,GOTO 2011,,,,,,,,,      oldlc2=oldloc,,,,,,,,,,,IF(OBJ.EQ.FOOD)GOTO 8142,,,,,,,,,      oldloc=loc,IF(OBJ.EQ.BIRD.OR.OBJ.EQ.SNAKE.OR.OBJ.EQ.CLAM.OR.OBJ.EQ.OYSTER,,,,,,,,,,1,.OR.OBJ.EQ.DWARF.OR.OBJ.EQ.DRAGON.OR.OBJ.EQ.TROLL,,,,,,,,,2,.OR.OBJ.EQ.BEAR)SPK=71,,,,,,,,,GOTO 2011,,,,,,,,, 9    ll=iabs(travel(kk)),,,,,,,,,,,,,,,,,,,,"      if(mod(ll,1000).eq.1.or.mod(ll,1000).eq.k)goto 10",,,,,,,,,,,,,,,,,,,,      if(travel(kk).lt.0)goto 50,IF(OBJ.EQ.0.AND.LIQLOC(LOC).NE.WATER.AND.(LIQ(0).NE.WATER,,,,,,,,,,1,.OR..NOT.HERE(BOTTLE)))GOTO 8000,,,,,,,,      kk=kk+1,IF(OBJ.NE.0.AND.OBJ.NE.WATER)SPK=110,,,,,,,,,,IF(SPK.EQ.110.OR.LIQ(0).NE.WATER.OR..NOT.HERE(BOTTLE))GOTO 2011,,,,,,,,,      goto 9,PROP(BOTTLE)=1,,,,,,,,,,PLACE(WATER)=0,,,,,,,,,,SPK=74,,,,,,,,,,GOTO 2011,,,,,,,,, 10   ll=ll/1000,,,,,,,,,,,,,,,,,,,, 11   newloc=ll/1000,,,,,,,,,,,IF(OBJ.NE.LAMP)SPK=76,,,,,,,,,"      k=mod(newloc,100)",GOTO 2011,,,,,,,,,,,,,,,,,,,      if(newloc.le.300)goto 13,,,,,,,,,,,,,,,,,,,,      nl=newloc,,,,,,,,,,,,,,,,,,,,      if(prop(k).ne.((nl/100)-3)) go to 16,IF(TOTING(ROD2).AND.OBJ.EQ.ROD.AND..NOT.TOTING(ROD))OBJ=ROD2,,,,,,,,,,IF(.NOT.TOTING(OBJ))GOTO 2011,,,,,,,,, 12   if(travel(kk).lt.0)call bug(25),IF(OBJ.GE.50.AND.OBJ.LE.MAXTRS.AND.AT(TROLL))GOTO 9178,,,,,,,,,,IF(OBJ.EQ.FOOD.AND.HERE(BEAR))GOTO 9177,,,,,,,,,      kk=kk+1,IF(OBJ.NE.AXE)GOTO 9020,,,,,,,,,,"DO 9171 I=1,5",,,,,,,,,      newloc=iabs(travel(kk))/1000,,,,,,,,,,,IF(DLOC(I).EQ.LOC)GOTO 9172,,,,,,,,,      if(newloc.eq.ll)goto 12,CONTINUE,,,,,,,,,,SPK=152,,,,,,,,,      ll=newloc,IF(AT(DRAGON).AND.PROP(DRAGON).EQ.0)GOTO 9175,,,,,,,,,,SPK=158,,,,,,,,,      goto 11,IF(AT(TROLL))GOTO 9175,,,,,,,,,,IF(HERE(BEAR).AND.PROP(BEAR).EQ.0)GOTO 9176,,,,,,,,,,OBJ=0,,,,,,,,,,GOTO 9120,,,,,,,,, 13   if(newloc.le.100)goto 14,,,,,,,,,,,SPK=48,,,,,,,,,      nl=newloc,,,,,,,,,,,IF(RAN(3).EQ.0.OR.SAVED.NE.-1)GOTO 9175,,,,,,,,,      if(toting(k).eq.1.or.(nl.gt.200.and.at(k).eq.1))goto 16,DSEEN(I)=.FALSE.,,,,,,,,,,DLOC(I)=0,,,,,,,,,      goto 12,SPK=47,,,,,,,,,,DKILL=DKILL+1,,,,,,,,,,IF(DKILL.EQ.1)SPK=149,,,,,,,,,,CALL RSPEAK(SPK),,,,,,,,, 14   nl=newloc,"CALL DROP(AXE,LOC)",,,,,,,,,,K=NULL,,,,,,,,,      if(nl.ne.0.and.pct(nl).eq.0) go to 12,GOTO 8,,,,,,,,,,,,,,,,,,," 16   newloc=mod(ll,1000)",,,,,,,,,,,SPK=164,,,,,,,,,      if(newloc.le.300)goto 2,"CALL DROP(AXE,LOC)",,,,,,,,,,FIXED(AXE)=-1,,,,,,,,,      if(newloc.le.500)goto 30000,PROP(AXE)=1,,,,,,,,,,CALL JUGGLE(BEAR),,,,,,,,,      nl=newloc,GOTO 2011,,,,,,,,,,,,,,,,,,,      call rspeak(nl-500),,,,,,,,,,,OBJ=BEAR,,,,,,,,,      newloc=loc,GOTO 9210,,,,,,,,,,,,,,,,,,,      goto 2,SPK=159,,,,,,,,,,,,,,,,,,,,"CALL DROP(OBJ,0)",,,,,,,,,,"CALL MOVE(TROLL,0)",,,,,,,,,c  special motions come here.  labelling convention: statement numbers nnnxxc  (,"CALL MOVE(TROLL+100,0)",,,,,,,,,,"CALL DROP(TROLL2,PLAC(TROLL))",,,,,,,,,,"CALL DROP(TROLL2+100,FIXD(TROLL))",,,,,,,,,,CALL JUGGLE(CHASM),,,,,,,,,30000 newloc=newloc-300,GOTO 2011,,,,,,,,,,,,,,,,,,,      if(newloc.gt.3)call bug(20),,,,,,,,,,,,,,,,,,,,"      goto (30100,30200,30300),newloc","GAVEUP=YES(22,54,54)",,,,,,,,,,IF(GAVEUP)GOTO 20000,,,,,,,,,,GOTO 2012,,,,,,,,,,,,,,,,,,,c  travel 301.  plover-alcove passage.  can carry only emerald.  note: travel,,,,,,,,,,,,,,,,,,,,"c  table must include ""useless"" entries going through passage, which can never",IF(AT(OBJ).OR.(LIQ(0).EQ.OBJ.AND.AT(BOTTLE)),,,,,,,,,,1,.OR.K.EQ.LIQLOC(LOC))SPK=94,,,,,,,,"c  be used for actual motion, but can be spotted by ""go back"".","DO 9192 I=1,5",,,,,,,,,,IF(DLOC(I).EQ.LOC.AND.DFLAG.GE.2.AND.OBJ.EQ.DWARF)SPK=94,,,,,,,,,,IF(CLOSED)SPK=138,,,,,,,,,,IF(TOTING(OBJ))SPK=24,,,,,,,,,30100 newloc=99+100-loc,GOTO 2011,,,,,,,,,,,,,,,,,,,      if(holdng.eq.0.or.(holdng.eq.1.and.toting(emrald).eq.1))goto 2,,,,,,,,,,,,,,,,,,,,      newloc=loc,SPK=98,,,,,,,,,,"DO 8201 I=1,100",,,,,,,,,      call rspeak(117),IDONDX=I,,,,,,,,,,IF(IDONDX.EQ.BEAR.OR..NOT.TOTING(IDONDX))GOTO 8201,,,,,,,,,      goto 2,IF(SPK.EQ.98)CALL RSPEAK(99),,,,,,,,,,BLKLIN=.FALSE.,,,,,,,,,,"CALL PSPEAK(IDONDX,-1)",,,,,,,,,,BLKLIN=.TRUE.,,,,,,,,,c  travel302.  plover transport.  drop the emerald (only use special travel if,SPK=0,,,,,,,,,,CONTINUE,,,,,,,,,"c  toting it), so he's forced to use the plover-passage to get it out.  having",IF(TOTING(BEAR))SPK=141,,,,,,,,,,GOTO 2011,,,,,,,,,"c  dropped it, go back and pretend he wasn't carrying it after all.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"30200 call drop(emrald,loc)",IF(OBJ.NE.BIRD)GOTO 9212,,,,,,,,,,SPK=100,,,,,,,,,      goto 12,GOTO 2011,,,,,,,,,,,,,,,,,,,,IF(OBJ.NE.SNAKE.AND.OBJ.NE.DRAGON.AND.OBJ.NE.TROLL)GOTO 9213,,,,,,,,,,SPK=102,,,,,,,,,c  travel 303.  troll bridge.  must be done only as special motion so that,IF(OBJ.EQ.DRAGON.AND.PROP(DRAGON).NE.0)SPK=110,,,,,,,,,,IF(OBJ.EQ.TROLL)SPK=182,,,,,,,,,c  dwarves won't wander across and encounter the bear.  (they won't follow the,IF(OBJ.NE.SNAKE.OR.CLOSED.OR..NOT.HERE(BIRD))GOTO 2011,,,,,,,,,,SPK=101,,,,,,,,,c  player there because that region is forbidden to the pirate.)  if,CALL DSTROY(BIRD),,,,,,,,,,PROP(BIRD)=0,,,,,,,,,"c  prop(troll)=1, he's crossed since paying, so step out and block him.",TALLY2=TALLY2+1,,,,,,,,,,GOTO 2011,,,,,,,,,c  (standard travel entries check for prop(troll)=0.)  special stuff for bear.,,,,,,,,,,,IF(OBJ.NE.DWARF)GOTO 9214,,,,,,,,,,IF(.NOT.HERE(FOOD))GOTO 2011,,,,,,,,,,SPK=103,,,,,,,,,30300 if(prop(troll).ne.1)goto 30310,DFLAG=DFLAG+1,,,,,,,,,,GOTO 2011,,,,,,,,,"      call pspeak(troll,1)",,,,,,,,,,,IF(OBJ.NE.BEAR)GOTO 9215,,,,,,,,,      prop(troll)=0,IF(PROP(BEAR).EQ.0)SPK=102,,,,,,,,,,IF(PROP(BEAR).EQ.3)SPK=110,,,,,,,,,"      call move(troll2,0)",IF(.NOT.HERE(FOOD))GOTO 2011,,,,,,,,,,CALL DSTROY(FOOD),,,,,,,,,"      call move(troll2+100,0)",PROP(BEAR)=1,,,,,,,,,,FIXED(AXE)=0,,,,,,,,,"      call move(troll,plac(troll))",PROP(AXE)=0,,,,,,,,,,SPK=168,,,,,,,,,"      call move(troll+100,fixd(troll))",GOTO 2011,,,,,,,,,,,,,,,,,,,      call juggle(chasm),SPK=14,,,,,,,,,,GOTO 2011,,,,,,,,,      newloc=loc,,,,,,,,,,,,,,,,,,,,      goto 2,,,,,,,,,,,IF(OBJ.EQ.VASE)GOTO 9222,,,,,,,,,,IF(OBJ.NE.0.AND.OBJ.NE.BOTTLE)GOTO 2011,,,,,,,,,,IF(OBJ.EQ.0.AND..NOT.HERE(BOTTLE))GOTO 8000,,,,,,,,,30310 newloc=plac(troll)+fixd(troll)-loc,SPK=107,,,,,,,,,,IF(LIQLOC(LOC).EQ.0)SPK=106,,,,,,,,,      if(prop(troll).eq.0)prop(troll)=1,IF(LIQ(0).NE.0)SPK=105,,,,,,,,,,IF(SPK.NE.107)GOTO 2011,,,,,,,,,      if(toting(bear).eq.0)goto 2,"PROP(BOTTLE)=MOD(COND(LOC),4)/2*2",,,,,,,,,,K=LIQ(0),,,,,,,,,      call rspeak(162),IF(TOTING(BOTTLE))PLACE(K)=-1,,,,,,,,,,IF(K.EQ.OIL)SPK=108,,,,,,,,,      prop(chasm)=1,GOTO 2011,,,,,,,,,,,,,,,,,,,      prop(troll)=2,SPK=29,,,,,,,,,,IF(LIQLOC(LOC).EQ.0)SPK=144,,,,,,,,,      nl=newloc,IF(LIQLOC(LOC).EQ.0.OR..NOT.TOTING(VASE))GOTO 2011,,,,,,,,,,CALL RSPEAK(145),,,,,,,,,"      call drop(bear,nl)",PROP(VASE)=2,,,,,,,,,,FIXED(VASE)=-1,,,,,,,,,      fixed(bear)=-1,GOTO 9024,,,,,,,,,,,,,,,,,,,      prop(bear)=3,,,,,,,,,,,,,,,,,,,,      if(prop(spices).lt.0)tally2=tally2+1,IF(PROP(ROD2).LT.0.OR..NOT.CLOSED)GOTO 2011,,,,,,,,,,BONUS=133,,,,,,,,,      oldlc2=newloc,IF(LOC.EQ.115)BONUS=134,,,,,,,,,,IF(HERE(ROD2))BONUS=135,,,,,,,,,      goto 99,CALL RSPEAK(BONUS),,,,,,,,,,GOTO 20000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  end of specials.,,,,,,,,,,,SCORNG=.TRUE.,,,,,,,,,,GOTO 20000,,,,,,,,,,,,,,,,,,,"c  handle ""go back"".  look for verb which goes from loc to oldloc, or to oldlc2",SCORNG=.FALSE.,,,,,,,,,,"TYPE 8243,SCORE,MXSCOR",,,,,,,,,c  if oldloc has forced-motion.  k2 saves entry -> forced loc -> previous loc.,"FORMAT(/' If you were to quit now, you would score',I4",,,,,,,,,,1,",' out of a possible',I4,'.')",,,,,,,,,"GAVEUP=YES(143,54,54)",,,,,,,,,,GOTO 8185,,,,,,,,, 20   k=oldloc,,,,,,,,,,,,,,,,,,,,      if(forced(k).eq.1)k=oldlc2,,,,,,,,,,,,,,,,,,,,      oldlc2=oldloc,,,,,,,,,,,"K=VOCAB(WD1,3)",,,,,,,,,      oldloc=loc,SPK=42,,,,,,,,,,IF(FOOBAR.EQ.1-K)GOTO 8252,,,,,,,,,      k2=0,IF(FOOBAR.NE.0)SPK=151,,,,,,,,,,GOTO 2011,,,,,,,,,      if(k.ne.loc)goto 21,,,,,,,,,,,FOOBAR=K,,,,,,,,,      call rspeak(91),IF(K.NE.4)GOTO 2009,,,,,,,,,,FOOBAR=0,,,,,,,,,      goto 2,IF(PLACE(EGGS).EQ.PLAC(EGGS),,,,,,,,,,1,.OR.(TOTING(EGGS).AND.LOC.EQ.PLAC(EGGS)))GOTO 2011,,,,,,,,,,,,,,,,,,,IF(PLACE(EGGS).EQ.0.AND.PLACE(TROLL).EQ.0.AND.PROP(TROLL).EQ.0),,,,,,,,," 21   ll=mod((iabs(travel(kk))/1000),1000)",1,PROP(TROLL)=1,,,,,,,,,K=2,,,,,,,,,      if(ll.eq.k)goto 25,IF(HERE(EGGS))K=1,,,,,,,,,,IF(LOC.EQ.PLAC(EGGS))K=0,,,,,,,,,      if(ll.gt.300)goto 22,"CALL MOVE(EGGS,PLAC(EGGS))",,,,,,,,,,"CALL PSPEAK(EGGS,K)",,,,,,,,,      j=key(ll),GOTO 2012,,,,,,,,,,,,,,,,,,,      ls=ll,,,,,,,,,,,,,,,,,,,,"      trv=mod((iabs(travel(j))/1000),1000)",SPK=156,,,,,,,,,,ABBNUM=10000,,,,,,,,,      if(forced(ls).eq.1.and.trv.eq.k),DETAIL=3,,,,,,,,,,GOTO 2011,,,,,,,,,     .  k2=kk,,,,,,,,,,,,,,,,,,,, 22   if(travel(kk).lt.0)goto 23,,,,,,,,,,,IF(HERE(MAGZIN))OBJ=MAGZIN,,,,,,,,,      kk=kk+1,IF(HERE(TABLET))OBJ=OBJ*100+TABLET,,,,,,,,,,IF(HERE(MESSAG))OBJ=OBJ*100+MESSAG,,,,,,,,,      goto 21,IF(CLOSED.AND.TOTING(OYSTER))OBJ=OYSTER,,,,,,,,,,IF(OBJ.GT.100.OR.OBJ.EQ.0.OR.DARK(0))GOTO 8000,,,,,,,,,,,,,,,,,,,,IF(DARK(0))GOTO 5190,,,,,,,,, 23   kk=k2,IF(OBJ.EQ.MAGZIN)SPK=190,,,,,,,,,,IF(OBJ.EQ.TABLET)SPK=196,,,,,,,,,      if(kk.ne.0)goto 25,IF(OBJ.EQ.MESSAG)SPK=191,,,,,,,,,,IF(OBJ.EQ.OYSTER.AND.HINTED(2).AND.TOTING(OYSTER))SPK=194,,,,,,,,,      call rspeak(140),IF(OBJ.NE.OYSTER.OR.HINTED(2).OR..NOT.TOTING(OYSTER),,,,,,,,,,1,.OR..NOT.CLOSED)GOTO 2011,,,,,,,,      goto 2,"HINTED(2)=YES(192,193,54)",,,,,,,,,,GOTO 2012,,,,,,,,,,,,,,,,,,,,,,,,,,,,," 25   k=mod(iabs(travel(kk)),1000)",,,,,,,,,,,IF(OBJ.EQ.MIRROR)SPK=148,,,,,,,,,      kk=key(loc),IF(OBJ.EQ.VASE.AND.PROP(VASE).EQ.0)GOTO 9282,,,,,,,,,,IF(OBJ.NE.MIRROR.OR..NOT.CLOSED)GOTO 2011,,,,,,,,,      goto 9,CALL RSPEAK(197),,,,,,,,,,GOTO 19000,,,,,,,,,,,,,,,,,,,,SPK=198,,,,,,,,,"c  look.  can't give more detail.  pretend it wasn't dark (though it may ""now""","IF(TOTING(VASE))CALL DROP(VASE,LOC)",,,,,,,,,,PROP(VASE)=2,,,,,,,,,c  be dark) so he won't fall into a pit while staring into the gloom.,FIXED(VASE)=-1,,,,,,,,,,GOTO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 30   if(detail.lt.3)call rspeak(15),,,,,,,,,,,IF(OBJ.NE.DWARF.OR..NOT.CLOSED)GOTO 2011,,,,,,,,,      detail=detail+1,CALL RSPEAK(199),,,,,,,,,,GOTO 19000,,,,,,,,,      wzdark=0,,,,,,,,,,,,,,,,,,,,      abb(loc)=0,,,,,,,,,,,,,,,,,,,,      goto 2,,,,,,,,,,,SPK=201,,,,,,,,,,IF(DEMO)GOTO 2011,,,,,,,,,,"TYPE 8302,LATNCY",,,,,,,,,c  cave.  different messages depending on whether above ground.,"FORMAT(/' I can suspend your adventure for you so that you can',",,,,,,,,,,1,"' resume later, but'/' you will have to wait at least',",,,,,,,,,2,"I3,' minutes before continuing.')",,,,,,,,,"IF(.NOT.YES(200,54,54))GOTO 2012",,,,,,,,, 40   if(loc.lt.8)call rspeak(57),"CALL DATIME(SAVED,SAVET)",,,,,,,,,,SETUP=-1,,,,,,,,,      if(loc.ge.8)call rspeak(58),CALL CIAO,,,,,,,,,,,,,,,,,,,      goto 2,YEA=START(0),,,,,,,,,,SETUP=3,,,,,,,,,,K=NULL,,,,,,,,,,GOTO 8,,,,,,,,,c  non-applicable motion.  various messages depending on word given.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,CALL MSPEAK(6),,,,,,,,, 50   spk=12,CALL HOURS,,,,,,,,,,GOTO 2012,,,,,,,,,      if(k.ge.43.and.k.le.50)spk=9,,,,,,,,,,,,,,,,,,,,      if(k.eq.29.or.k.eq.30)spk=9,,,,,,,,,,,,,,,,,,,,      if(k.eq.7.or.k.eq.36.or.k.eq.37)spk=10,,,,,,,,,,,,,,,,,,,,      if(k.eq.11.or.k.eq.19)spk=11,,,,,,,,,,,,,,,,,,,,      if(verb.eq.find.or.verb.eq.invent)spk=59,,,,,,,,,,,,,,,,,,,,      if(k.eq.62.or.k.eq.65)spk=42,"GOTO (40400,40500,40600,40700,40800,40900)(HINT-3)",,,,,,,,,,      CAVE  BIRD  SNAKE MAZE  DARK  WITT,,,,,,,,,      if(k.eq.17)spk=80,CALL BUG(27),,,,,,,,,,,,,,,,,,,      call rspeak(spk),HINTLC(HINT)=0,,,,,,,,,,"IF(.NOT.YES(HINTS(HINT,3),0,54))GOTO 2602",,,,,,,,,      goto 2,"TYPE 40012,HINTS(HINT,2)",,,,,,,,,,,,,,,,,,,"c  ""you're dead, jim.""","I2,' points.')",,,,,,,,,,"HINTED(HINT)=YES(175,HINTS(HINT,4),54)",,,,,,,,,c,"IF(HINTED(HINT).AND.LIMIT.GT.30)LIMIT=LIMIT+30*HINTS(HINT,2)",,,,,,,,,,HINTLC(HINT)=0,,,,,,,,,"c  if the current loc is zero, it means the clown got himself killed.  we'll",GOTO 2602,,,,,,,,,,,,,,,,,,,c  allow this maxdie times.  maxdie is automatically set based on the number of,,,,,,,,,,,,,,,,,,,,"c  snide messages available.  each death results in a message (81, 83, etc.)",IF(PROP(GRATE).EQ.0.AND..NOT.HERE(KEYS))GOTO 40010,,,,,,,,,,GOTO 40020,,,,,,,,,"c  which offers reincarnation; if accepted, this results in message 82, 84,",,,,,,,,,,,IF(HERE(BIRD).AND.TOTING(ROD).AND.OBJ.EQ.BIRD)GOTO 40010,,,,,,,,,"c  etc.  the last time, if he wants another chance, he gets a snide remark as",GOTO 40030,,,,,,,,,,,,,,,,,,,"c  we exit.  when reincarnated, all objects being carried get dropped at oldlc2",IF(HERE(SNAKE).AND..NOT.HERE(BIRD))GOTO 40010,,,,,,,,,,GOTO 40020,,,,,,,,,c  (presumably the last place prior to being killed) without change of props.,,,,,,,,,,,IF(ATLOC(LOC).EQ.0.AND.ATLOC(OLDLOC).EQ.0,,,,,,,,,c  the loop runs backwards to assure that the bird is dropped before the cage.,1,.AND.ATLOC(OLDLC2).EQ.0.AND.HOLDNG.GT.1)GOTO 40010,,,,,,,,,GOTO 40020,,,,,,,,,c  (this kluge could be changed once we're sure all references to bird and cage,,,,,,,,,,,IF(PROP(EMRALD).NE.-1.AND.PROP(PYRAM).EQ.-1)GOTO 40010,,,,,,,,,c  are done by keywords.)  the lamp is a special case (it wouldn't do to leave,GOTO 40020,,,,,,,,,,,,,,,,,,,c  it in the cave).  it is turned off and left outside the building (only if he,GOTO 40010,,,,,,,,,,,,,,,,,,,"c  was carrying it, of course).  he himself is left inside the building (and",,,,,,,,,,,,,,,,,,,,c  heaven help him if he tries to xyzzy back into the cave without the lamp).,,,,,,,,,,,,,,,,,,,,"c  oldloc is zapped so he can't just ""retreat"".",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  the easiest way to get killed is to fall into a pit in pitch darkness.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 90   call rspeak(23),,,,,,,,,,,,,,,,,,,,      oldlc2=loc,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  okay, he's dead.  let's get on with it.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 99   if(closng.eq.1)goto 95,,,,,,,,,,,,,,,,,,,,"      yea=yes(81+numdie*2,82+numdie*2,54)",,,,,,,,,,,,,,,,,,,,      numdie=numdie+1,,,,,,,,,,,,,,,,,,,,      if(numdie.eq.maxdie.or.yea.eq.0)goto 20000,,,,,,,,,,,,,,,,,,,,      place(water)=0,,,,,,,,,,,,,,,,,,,,      place(oil)=0,,,,,,,,,,,PROP(GRATE)=0,,,,,,,,,      if(toting(lamp).eq.1)prop(lamp)=0,PROP(FISSUR)=0,,,,,,,,,,"DO 10010 I=1,6",,,,,,,,,"      do 98 j=1,100",DSEEN(I)=.FALSE.,,,,,,,,,,DLOC(I)=0,,,,,,,,,      i=101-j,"CALL MOVE(TROLL,0)",,,,,,,,,,"CALL MOVE(TROLL+100,0)",,,,,,,,,      if(toting(i).eq.0)goto 98,"CALL MOVE(TROLL2,PLAC(TROLL))",,,,,,,,,,"CALL MOVE(TROLL2+100,FIXD(TROLL))",,,,,,,,,      k=oldlc2,CALL JUGGLE(CHASM),,,,,,,,,,IF(PROP(BEAR).NE.3)CALL DSTROY(BEAR),,,,,,,,,      if(i.eq.lamp)k=1,PROP(CHAIN)=0,,,,,,,,,,FIXED(CHAIN)=0,,,,,,,,,"      call drop(i,k)",PROP(AXE)=0,,,,,,,,,,FIXED(AXE)=0,,,,,,,,, 98   continue,CALL RSPEAK(129),,,,,,,,,,CLOCK1=-1,,,,,,,,,      loc=3,CLOSNG=.TRUE.,,,,,,,,,,GOTO 19999,,,,,,,,,      oldloc=loc,,,,,,,,,,,,,,,,,,,,      goto 2000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  he died during closing time.  no resurrection.  tally up a death and exit.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 95   call rspeak(131),,,,,,,,,,,,,,,,,,,,      numdie=numdie+1,,,,,,,,,,,"PROP(BOTTLE)=PUT(BOTTLE,115,1)",,,,,,,,,      goto 20000,"PROP(PLANT)=PUT(PLANT,115,0)",,,,,,,,,,"PROP(OYSTER)=PUT(OYSTER,115,0)",,,,,,,,,c  routines for performing the various action verbs,"PROP(LAMP)=PUT(LAMP,115,0)",,,,,,,,,,"PROP(ROD)=PUT(ROD,115,0)",,,,,,,,,,"PROP(DWARF)=PUT(DWARF,115,0)",,,,,,,,,,LOC=115,,,,,,,,,"c  statement numbers in this section are 8000 for intransitive verbs, 9000 for",OLDLOC=115,,,,,,,,,,NEWLOC=115,,,,,,,,,"c  transitive, plus ten times the verb number.  many intransitive verbs use the",,,,,,,,,,,,,,,,,,,,"c  transitive code, and some verbs use code for other verbs, as noted below.",,,,,,,,,,,"FOO=PUT(GRATE,116,0)",,,,,,,,,,"PROP(SNAKE)=PUT(SNAKE,116,1)",,,,,,,,,,"PROP(BIRD)=PUT(BIRD,116,1)",,,,,,,,,"c  random intransitive verbs come here.  clear obj just in case (see ""attack"").","PROP(CAGE)=PUT(CAGE,116,0)",,,,,,,,,,"PROP(ROD2)=PUT(ROD2,116,0)",,,,,,,,,,"PROP(PILLOW)=PUT(PILLOW,116,0)",,,,,,,,,,,,,,,,,,," 8000 call a5toa1(wd1,wd1x,' wha','t?  ',tk,k)","PROP(MIRROR)=PUT(MIRROR,115,0)",,,,,,,,,,FIXED(MIRROR)=116,,,,,,,,,"      write (*,8002) (tk(i),i=1,k)",,,,,,,,,,,"DO 11010 I=1,100",,,,,,,,," 8002 format(/' ',20a1)",IDONDX=I,,,,,,,,,,IF(TOTING(IDONDX))CALL DSTROY(IDONDX),,,,,,,,,      obj=0,,,,,,,,,,,CALL RSPEAK(132),,,,,,,,,      goto 2600,CLOSED=.TRUE.,,,,,,,,,,GOTO 2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  carry, no object given yet.  ok if only one object present.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8010 if(atloc(loc).eq.0.or.link(atloc(loc)).ne.0)goto 8000,,,,,,,,,,,,,,,,,,,,"      do 8012 i=1,5",CALL RSPEAK(188),,,,,,,,,,PROP(BATTER)=1,,,,,,,,,      if(dloc(i).eq.loc.and.dflag.ge.2)goto 8000,"IF(TOTING(BATTER))CALL DROP(BATTER,LOC)",,,,,,,,,,LIMIT=LIMIT+2500,,,,,,,,, 8012 continue,LMWARN=.FALSE.,,,,,,,,,,GOTO 19999,,,,,,,,,      obj=atloc(loc),,,,,,,,,,,IF(LMWARN.OR..NOT.HERE(LAMP))GOTO 19999,,,,,,,,,,LMWARN=.TRUE.,,,,,,,,,,SPK=187,,,,,,,,,"c  carry an object.  special cases for bird and cage (if bird in cage, can't",IF(PLACE(BATTER).EQ.0)SPK=183,,,,,,,,,,IF(PROP(BATTER).EQ.1)SPK=189,,,,,,,,,"c  take one without the other.  liquids also special, since they depend on",CALL RSPEAK(SPK),,,,,,,,,,GOTO 19999,,,,,,,,,"c  status of bottle.  also various side effects, etc.",,,,,,,,,,,LIMIT=-1,,,,,,,,,,PROP(LAMP)=0,,,,,,,,,,IF(HERE(LAMP))CALL RSPEAK(184),,,,,,,,, 9010 if(toting(obj).eq.1)goto 2011,GOTO 19999,,,,,,,,,,,,,,,,,,,      spk=25,CALL RSPEAK(185),,,,,,,,,,GAVEUP=.TRUE.,,,,,,,,,      if(obj.eq.plant.and.prop(plant).le.0)spk=115,GOTO 20000,,,,,,,,,,,,,,,,,,,      if(obj.eq.bear.and.prop(bear).eq.1)spk=169,,,,,,,,,,,,,,,,,,,,      if(obj.eq.chain.and.prop(bear).ne.0)spk=170,CALL MSPEAK(1),,,,,,,,,,GOTO 20000,,,,,,,,,      if(fixed(obj).ne.0)goto 2011,,,,,,,,,,,,,,,,,,,,      if(obj.ne.water.and.obj.ne.oil)goto 9017,,,,,,,,,,,CALL RSPEAK(136),,,,,,,,,      if(here(bottle).eq.1.and.liq(0).eq.obj)goto 9018,,,,,,,,,,,,,,,,,,,,      obj=bottle,,,,,,,,,,,,,,,,,,,,      if(toting(bottle).eq.1.and.prop(bottle).eq.1)goto 9220,,,,,,,,,,,,,,,,,,,,      if(prop(bottle).ne.1)spk=105,,,,,,,,,,,,,,,,,,,,      if(toting(bottle).eq.0)spk=104,,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,, 9018 obj=bottle,,,,,,,,,,,,,,,,,,,, 9017 if(holdng.lt.7)goto 9016,,,,,,,,,,,,,,,,,,,,      call rspeak(92),,,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,, 9016 if(obj.ne.bird)goto 9014,,,,,,,,,,,SCORE=0,,,,,,,,,      if(prop(bird).ne.0)goto 9014,MXSCOR=0,,,,,,,,,,,,,,,,,,,      if(toting(rod).eq.0)goto 9013,,,,,,,,,,,,,,,,,,,,      call rspeak(26),,,,,,,,,,,"DO 20010 I=50,MAXTRS",,,,,,,,,      goto 2012,IF(PTEXT(I).EQ.0)GOTO 20010,,,,,,,,,,K=12,,,,,,,,, 9013 if(toting(cage).eq.1)goto 9015,IF(I.EQ.CHEST)K=14,,,,,,,,,,IF(I.GT.CHEST)K=16,,,,,,,,,      call rspeak(27),IF(PROP(I).GE.0)SCORE=SCORE+2,,,,,,,,,,IF(PLACE(I).EQ.3.AND.PROP(I).EQ.0)SCORE=SCORE+K-2,,,,,,,,,      goto 2012,MXSCOR=MXSCOR+K,,,,,,,,,,CONTINUE,,,,,,,,, 9015 prop(bird)=1,,,,,,,,,,,,,,,,,,,, 9014 if((obj.eq.bird.or.obj.eq.cage).and.prop(bird).ne.0),,,,,,,,,,,,,,,,,,,,"     .   call carry(bird+cage-obj,loc)",,,,,,,,,,,,,,,,,,,,"      call carry(obj,loc)",,,,,,,,,,,,,,,,,,,,      k=liq(0),SCORE=SCORE+(MAXDIE-NUMDIE)*10,,,,,,,,,,MXSCOR=MXSCOR+MAXDIE*10,,,,,,,,,      if(obj.eq.bottle.and.k.ne.0)place(k)=-1,IF(.NOT.(SCORNG.OR.GAVEUP))SCORE=SCORE+4,,,,,,,,,,MXSCOR=MXSCOR+4,,,,,,,,,      goto 2009,IF(DFLAG.NE.0)SCORE=SCORE+25,,,,,,,,,,MXSCOR=MXSCOR+25,,,,,,,,,,IF(CLOSNG)SCORE=SCORE+25,,,,,,,,,,MXSCOR=MXSCOR+25,,,,,,,,,"c  discard object.  ""throw"" also comes here for most objects.  special cases for",IF(.NOT.CLOSED)GOTO 20020,,,,,,,,,,IF(BONUS.EQ.0)SCORE=SCORE+10,,,,,,,,,c  bird (might attack snake or dragon) and cage (might contain bird) and vase.,IF(BONUS.EQ.135)SCORE=SCORE+25,,,,,,,,,,IF(BONUS.EQ.134)SCORE=SCORE+30,,,,,,,,,c  drop coins at vending machine for extra batteries.,IF(BONUS.EQ.133)SCORE=SCORE+45,,,,,,,,,,MXSCOR=MXSCOR+45,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9020 if(toting(rod2).eq.1.and.obj.eq.rod.and.toting(rod).eq.0)obj=rod2,,,,,,,,,,,IF(PLACE(MAGZIN).EQ.108)SCORE=SCORE+1,,,,,,,,,      if(toting(obj).eq.0)goto 2011,MXSCOR=MXSCOR+1,,,,,,,,,,,,,,,,,,,      if(obj.ne.bird.or.here(snake).eq.0)goto 9024,,,,,,,,,,,,,,,,,,,,      call rspeak(30),SCORE=SCORE+2,,,,,,,,,,MXSCOR=MXSCOR+2,,,,,,,,,      if(closed.eq.1)goto 19000,,,,,,,,,,,,,,,,,,,,      call dstroy(snake),,,,,,,,,,,"DO 20030 I=1,HNTMAX",,,,,,,,,c  set prop for use by travel options,"IF(HINTED(I))SCORE=SCORE-HINTS(I,2)",,,,,,,,,,,,,,,,,,,      prop(snake)=1,,,,,,,,,,,,,,,,,,,, 9021 k=liq(0),IF(SCORNG)GOTO 8241,,,,,,,,,,,,,,,,,,,      if(k.eq.obj)obj=bottle,,,,,,,,,,,,,,,,,,,,      if(obj.eq.bottle.and.k.ne.0)place(k)=0,"TYPE 20100,SCORE,MXSCOR,TURNS",,,,,,,,,,"FORMAT(///' You scored',I4,' out of a possible',I4,",,,,,,,,,"      if(obj.eq.cage.and.prop(bird).ne.0)call drop(bird,loc)",1,"', using',I5,' turns.')",,,,,,,,,,,,,,,,,,      if(obj.eq.bird)prop(bird)=0,"DO 20200 I=1,CLSSES",,,,,,,,,,IF(CVAL(I).GE.SCORE)GOTO 20210,,,,,,,,,"      call drop(obj,loc)",CONTINUE,,,,,,,,,,TYPE 20202,,,,,,,,,      goto 2012,FORMAT(/' You just went off my scale!!'/),,,,,,,,,,GOTO 25000,,,,,,,,,,,,,,,,,,,,CALL SPEAK(CTEXT(I)),,,,,,,,, 9024 if(obj.ne.coins.or.here(vend).eq.0)goto 9025,IF(I.EQ.CLSSES-1)GOTO 20220,,,,,,,,,,K=CVAL(I)+1-SCORE,,,,,,,,,      call dstroy(coins),KK='s.',,,,,,,,,,IF(K.EQ.1)KK='. ',,,,,,,,,"      call drop(batter,loc)","TYPE 20212,K,KK",,,,,,,,,,"FORMAT(/' To achieve the next higher rating, you need',I3,",,,,,,,,,"      call pspeak(batter,0)",1,"' more point',A2/)",,,,,,,,,GOTO 25000,,,,,,,,,      goto 2012,,,,,,,,,,,TYPE 20222,,,,,,,,,,"FORMAT(/' To achieve the next higher rating ',",,,,,,,,,,1,'would be a neat trick!'//' Congratulations!!'/),,,,,,,, 9025 if(obj.ne.bird.or.at(dragon).eq.0.or.prop(dragon).ne.0)goto 9026,,,,,,,,,,,STOP,,,,,,,,,      call rspeak(154),,,,,,,,,,,,,,,,,,,,      call dstroy(bird),END,,,,,,,,,,,,,,,,,,,      prop(bird)=0,,,,,,,,,,,,,,,,,,,,      if(place(snake).eq.plac(snake))tally2=tally2+1,SUBROUTINE SPEAK(N),,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,, 9026 if(obj.ne.bear.or.at(troll).eq.0)goto 9027,LOGICAL BLKLIN,,,,,,,,,,"COMMON /TXTCOM/ RTEXT,LINES",,,,,,,,,      call rspeak(163),COMMON /BLKCOM/ BLKLIN,,,,,,,,,,"DIMENSION RTEXT(205),LINES(9650)",,,,,,,,,"      call move(troll,0)",,,,,,,,,,,IF(N.EQ.0)RETURN,,,,,,,,,"      call move(troll+100,0)",IF(LINES(N+1).EQ.'>$<')RETURN,,,,,,,,,,IF(BLKLIN)TYPE 2,,,,,,,,,"      call move(troll2,plac(troll))",K=N,,,,,,,,,,L=IABS(LINES(K))-1,,,,,,,,,"      call move(troll2+100,fixd(troll))",K=K+1,,,,,,,,,,"TYPE 2,(LINES(I),I=K,L)",,,,,,,,,      call juggle(chasm),"FORMAT(' ',14A5)",,,,,,,,,,K=L+1,,,,,,,,,      prop(troll)=2,IF(LINES(K).GE.0)GOTO 1,,,,,,,,,,RETURN,,,,,,,,,      goto 9021,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9027 if(obj.eq.vase.and.loc.ne.plac(pillow))goto 9028,"SUBROUTINE PSPEAK(MSG,SKIP)",,,,,,,,,,,,,,,,,,,      call rspeak(54),,,,,,,,,,,,,,,,,,,,      goto 9021,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,,"COMMON /TXTCOM/ RTEXT,LINES",,,,,,,,,,COMMON /PTXCOM/ PTEXT,,,,,,,,, 9028 prop(vase)=2,"DIMENSION RTEXT(205),LINES(9650),PTEXT(100)",,,,,,,,,,,,,,,,,,,      if(at(pillow).eq.1)prop(vase)=0,M=PTEXT(MSG),,,,,,,,,,IF(SKIP.LT.0)GOTO 9,,,,,,,,,"      call pspeak(vase,prop(vase)+1)","DO 3 I=0,SKIP",,,,,,,,,,M=IABS(LINES(M)),,,,,,,,,      if(prop(vase).ne.0)fixed(vase)=-1,IF(LINES(M).GE.0)GOTO 1,,,,,,,,,,CONTINUE,,,,,,,,,      goto 9021,CALL SPEAK(M),,,,,,,,,,RETURN,,,,,,,,,,END,,,,,,,,,,,,,,,,,,,"c  say.  echo wd2 (or wd1 if no wd2 (say what?, etc.).)  magic words override.",,,,,,,,,,,,,,,,,,,,,SUBROUTINE RSPEAK(I),,,,,,,,,,,,,,,,,,," 9030 call a5toa1(wd2,wd2x,'"".  ','    ',tk,k)",,,,,,,,,,,,,,,,,,,,"      if(wd2.eq.iz)call a5toa1(wd1,wd1x,'"".  ','    ',tk,k)",IMPLICIT INTEGER(A-Z),,,,,,,,,,COMMON /TXTCOM/ RTEXT,,,,,,,,,      if(wd2.ne.iz)wd1=wd2,DIMENSION RTEXT(205),,,,,,,,,,,,,,,,,,,"      i=vocab(wd1,-1)",IF(I.NE.0)CALL SPEAK(RTEXT(I)),,,,,,,,,,RETURN,,,,,,,,,      if(i.eq.62.or.i.eq.65.or.i.eq.71.or.i.eq.2025)goto 9035,END,,,,,,,,,,,,,,,,,,,"      write (*,9032) (tk(i),i=1,k)",,,,,,,,,,,,,,,,,,,," 9032 format(/' Okay, ""',20a1)",SUBROUTINE MSPEAK(I),,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,,COMMON /MTXCOM/ MTEXT,,,,,,,,, 9035 wd2=iz,DIMENSION MTEXT(35),,,,,,,,,,,,,,,,,,,      obj=0,IF(I.NE.0)CALL SPEAK(MTEXT(I)),,,,,,,,,,RETURN,,,,,,,,,      goto 2630,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  lock, unlock, no object given.  assume various things if present.","SUBROUTINE GETIN(WORD1,WORD1X,WORD2,WORD2X)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8040 spk=28,,,,,,,,,,,,,,,,,,,,      if(here(clam).eq.1)obj=clam,,,,,,,,,,,,,,,,,,,,      if(here(oyster).eq.1)obj=oyster,IMPLICIT INTEGER(A-Z),,,,,,,,,,LOGICAL BLKLIN,,,,,,,,,      if(at(door).eq.1)obj=door,COMMON /BLKCOM/ BLKLIN,,,,,,,,,,"DIMENSION A(5),MASKS(6)",,,,,,,,,      if(at(grate).eq.1)obj=grate,"DATA MASKS/""4000000000,""20000000,""100000,""400,""2,0/",,,,,,,,,,1,",BLANKS/'     '/",,,,,,,,      if(obj.ne.0.and.here(chain).eq.1)goto 8000,,,,,,,,,,,IF(BLKLIN)TYPE 1,,,,,,,,,      if(here(chain).eq.1)obj=chain,FORMAT(),,,,,,,,,,"ACCEPT 3,(A(I),I=1,4)",,,,,,,,,      if(obj.eq.0)goto 2011,FORMAT(4A5),,,,,,,,,,J=0,,,,,,,,,,"DO 9 I=1,4",,,,,,,,,,IF(A(I).NE.BLANKS)J=1,,,,,,,,,"c  lock, unlock object.  special stuff for opening clam/oyster and for chain.","A(I)=A(I).AND.(SHIFT((A(I).AND.'@@@@@'),-1).XOR.-1)",,,,,,,,,,IF(BLKLIN.AND.J.EQ.0)GOTO 2,,,,,,,,,,,,,,,,,,,,SECOND=0,,,,,,,,, 9040 if(obj.eq.clam.or.obj.eq.oyster)goto 9046,WORD1=A(1),,,,,,,,,,WORD1X=A(2),,,,,,,,,      if(obj.eq.door)spk=111,WORD2=0,,,,,,,,,,,,,,,,,,,      if(obj.eq.door.and.prop(door).eq.1)spk=54,"DO 10 J=1,4",,,,,,,,,,"DO 10 K=1,5",,,,,,,,,      if(obj.eq.cage)spk=32,"MSK=""774000000000",,,,,,,,,,"IF(K.NE.1)MSK=""177*MASKS(K)",,,,,,,,,      if(obj.eq.keys)spk=55,IF(((A(J).XOR.BLANKS).AND.MSK).EQ.0)GOTO 15,,,,,,,,,,IF(SECOND.EQ.0)GOTO 10,,,,,,,,,      if(obj.eq.grate.or.obj.eq.chain)spk=31,MSK=-MASKS(6-K),,,,,,,,,,"WORD2=(SHIFT(A(J),7*(K-1)).AND.MSK)",,,,,,,,,      if(spk.ne.31.or.here(keys).eq.0)goto 2011,1,"+(SHIFT(A(J+1),7*(K-6)).AND.(-2-MSK))",,,,,,,,,"WORD2X=(SHIFT(A(J+1),7*(K-1)).AND.MSK)",,,,,,,,,      if(obj.eq.chain)goto 9048,1,"+(SHIFT(A(J+2),7*(K-6)).AND.(-2-MSK))",,,,,,,,,RETURN,,,,,,,,,      if(closng.eq.0)goto 9043,,,,,,,,,,,IF(SECOND.EQ.1)GOTO 10,,,,,,,,,      k=130,SECOND=1,,,,,,,,,,IF(J.EQ.1)WORD1=(WORD1.AND.-MASKS(K)),,,,,,,,,      if(panic.eq.0)clock2=15,1,.OR.(BLANKS.AND.(-MASKS(K).XOR.-1)),,,,,,,,,CONTINUE,,,,,,,,,      panic=1,RETURN,,,,,,,,,,END,,,,,,,,,      goto 2010,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"LOGICAL FUNCTION YES(X,Y,Z)",,,,,,,,, 9043 k=34+prop(grate),,,,,,,,,,,,,,,,,,,,      prop(grate)=1,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      if(verb.eq.lock)prop(grate)=0,EXTERNAL RSPEAK,,,,,,,,,,LOGICAL YESX,,,,,,,,,      k=k+2*prop(grate),,,,,,,,,,,"YES=YESX(X,Y,Z,RSPEAK)",,,,,,,,,      goto 2010,RETURN,,,,,,,,,,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  clam/oyster.,,,,,,,,,,,"LOGICAL FUNCTION YESM(X,Y,Z)",,,,,,,,, 9046 k=0,,,,,,,,,,,,,,,,,,,,      if(obj.eq.oyster)k=1,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      spk=124+k,EXTERNAL MSPEAK,,,,,,,,,,LOGICAL YESX,,,,,,,,,      if(toting(obj).eq.1)spk=120+k,,,,,,,,,,,"YESM=YESX(X,Y,Z,MSPEAK)",,,,,,,,,      if(toting(tridnt).eq.0)spk=122+k,RETURN,,,,,,,,,,END,,,,,,,,,      if(verb.eq.lock)spk=61,,,,,,,,,,,,,,,,,,,,      if(spk.ne.124)goto 2011,,,,,,,,,,,"LOGICAL FUNCTION YESX(X,Y,Z,SPK)",,,,,,,,,      call dstroy(clam),,,,,,,,,,,,,,,,,,,,"      call drop(oyster,loc)",,,,,,,,,,,,,,,,,,,,"      call drop(pearl,105)",IMPLICIT INTEGER(A-Z),,,,,,,,,,,,,,,,,,,      goto 2011,IF(X.NE.0)CALL SPK(X),,,,,,,,,,"CALL GETIN(REPLY,JUNK1,JUNK2,JUNK3)",,,,,,,,,,IF(REPLY.EQ.'YES'.OR.REPLY.EQ.'Y')GOTO 10,,,,,,,,,,IF(REPLY.EQ.'NO'.OR.REPLY.EQ.'N')GOTO 20,,,,,,,,,c  chain.,TYPE 9,,,,,,,,,,FORMAT(/' Please answer the question.'),,,,,,,,, 9048 if(verb.eq.lock)goto 9049,GOTO 1,,,,,,,,,,YESX=.TRUE.,,,,,,,,,      spk=171,IF(Y.NE.0)CALL SPK(Y),,,,,,,,,,RETURN,,,,,,,,,      if(prop(bear).eq.0)spk=41,YESX=.FALSE.,,,,,,,,,,IF(Z.NE.0)CALL SPK(Z),,,,,,,,,      if(prop(chain).eq.0)spk=37,RETURN,,,,,,,,,,END,,,,,,,,,      if(spk.ne.171)goto 2011,,,,,,,,,,,,,,,,,,,,      prop(chain)=0,,,,,,,,,,,"SUBROUTINE A5TOA1(A,B,C,CHARS,LENG)",,,,,,,,,      fixed(chain)=0,,,,,,,,,,,,,,,,,,,,      if(prop(bear).ne.3)prop(bear)=2,,,,,,,,,,,,,,,,,,,,      fixed(bear)=2-prop(bear),,,,,,,,,,,,,,,,,,,,      goto 2011,IMPLICIT INTEGER(A-Z),,,,,,,,,,"DIMENSION CHARS(20),WORDS(3)",,,,,,,,,,"DATA MASK,BLANK/""774000000000,' '/",,,,,,,,,,,,,,,,,,, 9049 spk=172,WORDS(1)=A,,,,,,,,,,WORDS(2)=B,,,,,,,,,      if(prop(chain).ne.0)spk=34,WORDS(3)=C,,,,,,,,,,POSN=1,,,,,,,,,      if(loc.ne.plac(chain))spk=173,"DO 1 WORD=1,3",,,,,,,,,,IF(WORD.EQ.2.AND.POSN.NE.6)GOTO 1,,,,,,,,,      if(spk.ne.172)goto 2011,IF(WORD.EQ.3.AND.C.LT.0)POSN=POSN+1,,,,,,,,,,"DO 2 CH=1,5",,,,,,,,,      prop(chain)=2,CHARS(POSN)=(WORDS(WORD).AND.MASK)+(BLANK-(BLANK.AND.MASK)),,,,,,,,,,IF(CHARS(POSN).EQ.BLANK)GOTO 1,,,,,,,,,"      if(toting(chain).eq.1)call drop(chain,loc)",LENG=POSN,,,,,,,,,,"WORDS(WORD)=SHIFT(WORDS(WORD),7)",,,,,,,,,      fixed(chain)=-1,POSN=POSN+1,,,,,,,,,,CONTINUE,,,,,,,,,      goto 2011,RETURN,,,,,,,,,,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  light lamp,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"INTEGER FUNCTION VOCAB(ID,INIT)",,,,,,,,, 9070 if(here(lamp).eq.0)goto 2011,,,,,,,,,,,,,,,,,,,,      spk=184,,,,,,,,,,,,,,,,,,,,      if(limit.lt.0)goto 2011,,,,,,,,,,,,,,,,,,,,      prop(lamp)=1,,,,,,,,,,,,,,,,,,,,      call rspeak(39),IMPLICIT INTEGER(A-Z),,,,,,,,,,"COMMON /VOCCOM/ KTAB,ATAB,TABSIZ",,,,,,,,,      if(wzdark.eq.1)goto 2000,"DIMENSION KTAB(300),ATAB(300)",,,,,,,,,,,,,,,,,,,      goto 2012,HASH=ID.XOR.'PHROG',,,,,,,,,,"DO 1 I=1,TABSIZ",,,,,,,,,,IF(KTAB(I).EQ.-1)GOTO 2,,,,,,,,,,IF(INIT.GE.0.AND.KTAB(I)/1000.NE.INIT)GOTO 1,,,,,,,,,c  lamp off,IF(ATAB(I).EQ.HASH)GOTO 3,,,,,,,,,,CONTINUE,,,,,,,,,,CALL BUG(21),,,,,,,,,,,,,,,,,,, 9080 if(here(lamp).eq.0)goto 2011,VOCAB=-1,,,,,,,,,,IF(INIT.LT.0)RETURN,,,,,,,,,      prop(lamp)=0,CALL BUG(5),,,,,,,,,,,,,,,,,,,      call rspeak(40),VOCAB=KTAB(I),,,,,,,,,,"IF(INIT.GE.0)VOCAB=MOD(VOCAB,1000)",,,,,,,,,      if(dark(0).eq.1)call rspeak(16),RETURN,,,,,,,,,,END,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,SUBROUTINE DSTROY(OBJECT),,,,,,,,,c  wave.  no effect unless waving rod at fissure.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,, 9090 if((toting(obj)).eq.0.and.(obj.ne.rod.or.toting(rod2).eq.0)),,,,,,,,,,,"CALL MOVE(OBJECT,0)",,,,,,,,,     .   spk=29,RETURN,,,,,,,,,,END,,,,,,,,,      if(obj.ne.rod.or.at(fissur).eq.0.or.toting(obj).eq.0,,,,,,,,,,,,,,,,,,,,     .   .or.closng.eq.1)go to 2011,,,,,,,,,,,SUBROUTINE JUGGLE(OBJECT),,,,,,,,,      prop(fissur)=1-prop(fissur),,,,,,,,,,,,,,,,,,,,"      call pspeak(fissur,2-prop(fissur))",,,,,,,,,,,,,,,,,,,,      goto 2012,IMPLICIT INTEGER(A-Z),,,,,,,,,,"COMMON /PLACOM/ ATLOC,LINK,PLACE,FIXED,HOLDNG",,,,,,,,,,"DIMENSION ATLOC(150),LINK(200),PLACE(100),FIXED(100)",,,,,,,,,,,,,,,,,,,"c  attack.  assume target if unambiguous.  ""throw"" also links here.  attackable",I=PLACE(OBJECT),,,,,,,,,,J=FIXED(OBJECT),,,,,,,,,"c  objects fall into two categories: enemies (snake, dwarf, etc.)  and others","CALL MOVE(OBJECT,I)",,,,,,,,,,"CALL MOVE(OBJECT+100,J)",,,,,,,,,"c  (bird, clam).  ambiguous if two enemies, or if no enemies but two others.",RETURN,,,,,,,,,,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,," 9120 do 9121 i=1,5",,,,,,,,,,,"SUBROUTINE MOVE(OBJECT,WHERE)",,,,,,,,,      if(dloc(i).eq.loc.and.dflag.ge.2)goto 9122,,,,,,,,,,,,,,,,,,,, 9121 continue,,,,,,,,,,,,,,,,,,,,      i=0,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,, 9122 if(obj.ne.0)goto 9124,"COMMON /PLACOM/ ATLOC,LINK,PLACE,FIXED,HOLDNG",,,,,,,,,,"DIMENSION ATLOC(150),LINK(200),PLACE(100),FIXED(100)",,,,,,,,,      if(i.ne.0)obj=dwarf,,,,,,,,,,,IF(OBJECT.GT.100)GOTO 1,,,,,,,,,      if(here(snake).eq.1)obj=obj*100+snake,FROM=PLACE(OBJECT),,,,,,,,,,GOTO 2,,,,,,,,,      if(at(dragon).eq.1.and.prop(dragon).eq.0)obj=obj*100+dragon,FROM=FIXED(OBJECT-100),,,,,,,,,,"IF(FROM.GT.0.AND.FROM.LE.300)CALL CARRY(OBJECT,FROM)",,,,,,,,,      if(at(troll).eq.1)obj=obj*100+troll,"CALL DROP(OBJECT,WHERE)",,,,,,,,,,RETURN,,,,,,,,,      if(here(bear).eq.1.and.prop(bear).eq.0)obj=obj*100+bear,END,,,,,,,,,,,,,,,,,,,      if(obj.gt.100)goto 8000,,,,,,,,,,,,,,,,,,,,      if(obj.ne.0)goto 9124,"INTEGER FUNCTION PUT(OBJECT,WHERE,PVAL)",,,,,,,,,,,,,,,,,,,c  can't attack bird by throwing axe.,,,,,,,,,,,,,,,,,,,,      if(here(bird).eq.1.and.verb.ne.throw)obj=bird,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,c  clam and oyster both treated as clam for intransitive case; no harm done.,,,,,,,,,,,"CALL MOVE(OBJECT,WHERE)",,,,,,,,,      if(here(clam).eq.1.or.here(oyster).eq.1)obj=100*obj+clam,PUT=(-1)-PVAL,,,,,,,,,,RETURN,,,,,,,,,      if(obj.gt.100)goto 8000,END,,,,,,,,,,,,,,,,,,, 9124 if(obj.ne.bird)goto 9125,,,,,,,,,,,,,,,,,,,,      spk=137,"SUBROUTINE CARRY(OBJECT,WHERE)",,,,,,,,,,,,,,,,,,,      if(closed.eq.1)goto 2011,,,,,,,,,,,,,,,,,,,,      call dstroy(bird),,,,,,,,,,,,,,,,,,,,      prop(bird)=0,IMPLICIT INTEGER(A-Z),,,,,,,,,,"COMMON /PLACOM/ ATLOC,LINK,PLACE,FIXED,HOLDNG",,,,,,,,,      if(place(snake).eq.plac(snake))tally2=tally2+1,"DIMENSION ATLOC(150),LINK(200),PLACE(100),FIXED(100)",,,,,,,,,,,,,,,,,,,      spk=45,IF(OBJECT.GT.100)GOTO 5,,,,,,,,,,IF(PLACE(OBJECT).EQ.-1)RETURN,,,,,,,,, 9125 if(obj.eq.0)spk=44,PLACE(OBJECT)=-1,,,,,,,,,,HOLDNG=HOLDNG+1,,,,,,,,,      if(obj.eq.clam.or.obj.eq.oyster)spk=150,IF(ATLOC(WHERE).NE.OBJECT)GOTO 6,,,,,,,,,,ATLOC(WHERE)=LINK(OBJECT),,,,,,,,,      if(obj.eq.snake)spk=46,RETURN,,,,,,,,,,TEMP=ATLOC(WHERE),,,,,,,,,      if(obj.eq.dwarf)spk=49,IF(LINK(TEMP).EQ.OBJECT)GOTO 8,,,,,,,,,,TEMP=LINK(TEMP),,,,,,,,,      if(obj.eq.dwarf.and.closed.eq.1)goto 19000,GOTO 7,,,,,,,,,,LINK(TEMP)=LINK(OBJECT),,,,,,,,,      if(obj.eq.dragon)spk=167,RETURN,,,,,,,,,,END,,,,,,,,,      if(obj.eq.troll)spk=157,,,,,,,,,,,,,,,,,,,,      if(obj.eq.bear)spk=165+(prop(bear)+1)/2,,,,,,,,,,,"SUBROUTINE DROP(OBJECT,WHERE)",,,,,,,,,      if(obj.ne.dragon.or.prop(dragon).ne.0)goto 2011,,,,,,,,,,,,,,,,,,,,"c  fun stuff for dragon.  if he insists on attacking it, win!  set prop to dead,",,,,,,,,,,,,,,,,,,,,"c  move dragon to central loc (still fixed), move rug there (not fixed), and",IMPLICIT INTEGER(A-Z),,,,,,,,,,"COMMON /PLACOM/ ATLOC,LINK,PLACE,FIXED,HOLDNG",,,,,,,,,"c  move him there, too.  then do a null motion to get new description.","DIMENSION ATLOC(150),LINK(200),PLACE(100),FIXED(100)",,,,,,,,,,,,,,,,,,,      call rspeak(49),IF(OBJECT.GT.100)GOTO 1,,,,,,,,,,IF(PLACE(OBJECT).EQ.-1)HOLDNG=HOLDNG-1,,,,,,,,,      verb=0,PLACE(OBJECT)=WHERE,,,,,,,,,,GOTO 2,,,,,,,,,      obj=0,FIXED(OBJECT-100)=WHERE,,,,,,,,,,IF(WHERE.LE.0)RETURN,,,,,,,,,"      call getin(wd1,wd1x,wd2,wd2x)",LINK(OBJECT)=ATLOC(WHERE),,,,,,,,,,ATLOC(WHERE)=OBJECT,,,,,,,,,      if(wd1.ne.'y   '.and.wd1.ne.'yes ')goto 2608,RETURN,,,,,,,,,,END,,,,,,,,,"      call pspeak(dragon,1)",,,,,,,,,,,,,,,,,,,,      prop(dragon)=2,,,,,,,,,,,,,,,,,,,,      prop(rug)=0,,,,,,,,,,,LOGICAL FUNCTION START(DUMMY),,,,,,,,,      k=(plac(dragon)+fixd(dragon))/2,,,,,,,,,,,,,,,,,,,,"      call move(dragon+100,-1)",,,,,,,,,,,,,,,,,,,,"      call move(rug+100,0)",,,,,,,,,,,,,,,,,,,,"      call move(dragon,k)",IMPLICIT INTEGER(A-Z),,,,,,,,,,"LOGICAL PTIME,SOON,YESM",,,,,,,,,"      call move(rug,k)",DIMENSION HNAME(4),,,,,,,,,,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME,",,,,,,,,,"      do 9126 obj=1,100",1,"SHORT,MAGIC,MAGNM,LATNCY,SAVED,SAVET,SETUP",,,,,,,,,,,,,,,,,,      idondx=obj,,,,,,,,,,,,,,,,,,,,      if(place(idondx).eq.plac(dragon).or.,,,,,,,,,,,,,,,,,,,,     .   place(idondx).eq.fixd(dragon)),,,,,,,,,,,"CALL DATIME(D,T)",,,,,,,,,"     .   call move(idondx,k)",PRIMTM=WKDAY,,,,,,,,,,"IF(MOD(D,7).LE.1)PRIMTM=WKEND",,,,,,,,, 9126 continue,IF(D.GE.HBEGIN.AND.D.LE.HEND)PRIMTM=HOLID,,,,,,,,,,"PTIME=(PRIMTM.AND.SHIFT(1,T/60)).NE.0",,,,,,,,,      loc=k,SOON=.FALSE.,,,,,,,,,,IF(SETUP.GE.0)GOTO 20,,,,,,,,,      k=null,DELAY=(D-SAVED)*1440+(T-SAVET),,,,,,,,,,IF(DELAY.GE.LATNCY)GOTO 20,,,,,,,,,      goto 8,"TYPE 10,DELAY",,,,,,,,,,"FORMAT(' This adventure was suspended a mere',I3,' minutes ago.')",,,,,,,,,,SOON=.TRUE.,,,,,,,,,,IF(DELAY.GE.LATNCY/3)GOTO 20,,,,,,,,,"c  pour.  if no object, or object is bottle, assume contents of bottle.",CALL MSPEAK(2),,,,,,,,,,STOP,,,,,,,,,c  special tests for pouring water or oil on plant or rusty door.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,START=.FALSE.,,,,,,,,, 9130 if(obj.eq.bottle.or.obj.eq.0)obj=liq(0),IF(SOON)GOTO 30,,,,,,,,,,IF(PTIME)GOTO 25,,,,,,,,,      if(obj.eq.0)goto 8000,SAVED=-1,,,,,,,,,,RETURN,,,,,,,,,      if(toting(obj).eq.0)goto 2011,,,,,,,,,,,,,,,,,,,,      spk=78,,,,,,,,,,,,,,,,,,,,      if(obj.ne.oil.and.obj.ne.water)goto 2011,,,,,,,,,,,CALL MSPEAK(3),,,,,,,,,      prop(bottle)=1,CALL HOURS,,,,,,,,,,CALL MSPEAK(4),,,,,,,,,      place(obj)=0,IF(WIZARD(0))GOTO 22,,,,,,,,,,IF(SETUP.LT.0)GOTO 33,,,,,,,,,      spk=77,"START=YESM(5,7,7)",,,,,,,,,,IF(START)GOTO 22,,,,,,,,,      if(at(plant).eq.0.and.at(door).eq.0) go to 2011,STOP ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      if(at(door).eq.1)goto 9132,,,,,,,,,,,CALL MSPEAK(8),,,,,,,,,      spk=112,IF(WIZARD(0))GOTO 22,,,,,,,,,,CALL MSPEAK(9),,,,,,,,,      if(obj.ne.water)goto 2011,STOP,,,,,,,,,,END,,,,,,,,,"      call pspeak(plant,prop(plant)+1)",,,,,,,,,,,,,,,,,,,,"      prop(plant)=mod(prop(plant)+2,6)",,,,,,,,,,,SUBROUTINE MAINT,,,,,,,,,      prop(plant2)=prop(plant)/2,,,,,,,,,,,,,,,,,,,,      k=null,,,,,,,,,,,,,,,,,,,,      goto 8,,,,,,,,,,,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,,"LOGICAL YESM,BLKLIN",,,,,,,,, 9132 prop(door)=0,"DIMENSION HNAME(4),ABB(150)",,,,,,,,,,COMMON /BLKCOM/ BLKLIN,,,,,,,,,      if(obj.eq.oil)prop(door)=1,COMMON /ABBCOM/ ABB,,,,,,,,,,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME,",,,,,,,,,      spk=113+prop(door),1,"SHORT,MAGIC,MAGNM,LATNCY,SAVED,SAVET,SETUP",,,,,,,,,,,,,,,,,,      goto 2011,IF(.NOT.WIZARD(0))RETURN,,,,,,,,,,BLKLIN=.FALSE.,,,,,,,,,,"IF(YESM(10,0,0))CALL HOURS",,,,,,,,,,"IF(YESM(11,0,0))CALL NEWHRS",,,,,,,,,"c  eat.  intransitive: assume food if present, else ask what.  transitive: food","IF(.NOT.YESM(26,0,0))GOTO 10",,,,,,,,,,CALL MSPEAK(27),,,,,,,,,"c  ok, some things lose appetite, rest are ridiculous.","ACCEPT 1,HBEGIN",,,,,,,,,,FORMAT(G),,,,,,,,,,CALL MSPEAK(28),,,,,,,,,,"ACCEPT 1,HEND",,,,,,,,, 8140 if(here(food).eq.0)goto 8000,"CALL DATIME(D,T)",,,,,,,,,,HBEGIN=HBEGIN+D,,,,,,,,, 8142 call dstroy(food),HEND=HBEGIN+HEND-1,,,,,,,,,,CALL MSPEAK(29),,,,,,,,,      spk=72,"ACCEPT 2,HNAME",,,,,,,,,,FORMAT(4A5),,,,,,,,,      goto 2011,"TYPE 12,SHORT",,,,,,,,,,"FORMAT(' Length of short game (null to leave at',I3,'):')",,,,,,,,, 9140 if(obj.eq.food)goto 8142,"ACCEPT 1,X",,,,,,,,,,IF(X.GT.0)SHORT=X,,,,,,,,,      if(obj.eq.bird.or.obj.eq.snake.or.obj.eq.clam.or.obj.eq.oyster,CALL MSPEAK(12),,,,,,,,,,"CALL GETIN(X,Y,Y,Y)",,,,,,,,,     .   .or.obj.eq.dwarf.or.obj.eq.dragon.or.obj.eq.troll,IF(X.NE.' ')MAGIC=X,,,,,,,,,,CALL MSPEAK(13),,,,,,,,,     .   .or.obj.eq.bear)spk=71,"ACCEPT 1,X",,,,,,,,,,IF(X.GT.0)MAGNM=X,,,,,,,,,      goto 2011,"TYPE 16,LATNCY",,,,,,,,,,"FORMAT(' Latency for restart (null to leave at',I3,'):')",,,,,,,,,,"ACCEPT 1,X",,,,,,,,,,IF(X.GT.0.AND.X.LT.45)CALL MSPEAK(30),,,,,,,,,"c  drink.  if no object, assume water and look for it here.  if water is in","IF(X.GT.0)LATNCY=MAX0(45,X)",,,,,,,,,,"IF(YESM(14,0,0))CALL MOTD(.TRUE.)",,,,,,,,,"c  the bottle, drink that, else must be at a water loc, so drink stream.",SAVED=0,,,,,,,,,,SETUP=2,,,,,,,,,,ABB(1)=0,,,,,,,,,,CALL MSPEAK(15),,,,,,,,, 9150 if(obj.eq.0.and.liqloc(loc).ne.water.and.(liq(0).ne.water,BLKLIN=.TRUE.,,,,,,,,,,CALL CIAO,,,,,,,,,     .   .or.here(bottle).eq.0))goto 8000,END,,,,,,,,,,,,,,,,,,,      if(obj.ne.0.and.obj.ne.water)spk=110,,,,,,,,,,,,,,,,,,,,      if(spk.eq.110.or.liq(0).ne.water.or.here(bottle).eq.0)goto 2011,LOGICAL FUNCTION WIZARD(DUMMY),,,,,,,,,,,,,,,,,,,      prop(bottle)=1,,,,,,,,,,,,,,,,,,,,      place(water)=0,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      spk=74,LOGICAL YESM,,,,,,,,,,"DIMENSION HNAME(4),VAL(5)",,,,,,,,,      goto 2011,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME,",,,,,,,,,,1,"SHORT,MAGIC,MAGNM,LATNCY,SAVED,SAVET,SETUP",,,,,,,,,,,,,,,,,,,"WIZARD=YESM(16,0,7)",,,,,,,,,c  rub.  yields various snide remarks.,IF(.NOT.WIZARD)RETURN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9160 if(obj.ne.lamp)spk=76,CALL MSPEAK(17),,,,,,,,,,"CALL GETIN(WORD,X,Y,Z)",,,,,,,,,      goto 2011,IF(WORD.NE.MAGIC)GOTO 99,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  throw.  same as discard unless axe.  then same as attack except ignore bird,","CALL DATIME(D,T)",,,,,,,,,,T=T*2+1,,,,,,,,,c  and if dwarf is present then one might be killed.  (only way to do so),WORD='@@@@@',,,,,,,,,,"DO 15 Y=1,5",,,,,,,,,"c  axe also special for dragon, bear, and troll.  treasures special for troll.","X=79+MOD(D,5)",,,,,,,,,,D=D/5,,,,,,,,,,"DO 12 Z=1,X",,,,,,,,,,"T=MOD(T*1027,1048576)",,,,,,,,, 9170 if(toting(rod2).eq.1.and.obj.eq.rod.and.toting(rod).eq.0)obj=rod2,VAL(Y)=(T*26)/1048576+1,,,,,,,,,,"WORD=WORD+SHIFT(VAL(Y),36-7*Y)",,,,,,,,,      if(toting(obj).eq.0)goto 2011,"IF(YESM(18,0,0))GOTO 99",,,,,,,,,,"TYPE 18,WORD",,,,,,,,,      if(obj.ge.50.and.obj.le.maxtrs.and.at(troll).eq.1)goto 9178,"FORMAT(/1X,A5)",,,,,,,,,,"CALL GETIN(WORD,X,Y,Z)",,,,,,,,,      if(obj.eq.food.and.here(bear).eq.1)goto 9177,"CALL DATIME(D,T)",,,,,,,,,,T=(T/60)*40+(T/10)*10,,,,,,,,,      if(obj.ne.axe)goto 9020,D=MAGNM,,,,,,,,,,"DO 19 Y=1,5",,,,,,,,,"      do 9171 i=1,5","Z=MOD(Y,5)+1",,,,,,,,,,"X=MOD(IABS(VAL(Y)-VAL(Z))*MOD(D,10)+MOD(T,10),26)+1",,,,,,,,,c  needn't check dflag if axe is here.,T=T/10,,,,,,,,,,D=D/10,,,,,,,,,      if(dloc(i).eq.loc)goto 9172,"WORD=WORD-SHIFT(X,36-7*Y)",,,,,,,,,,IF(WORD.NE.'@@@@@')GOTO 99,,,,,,,,, 9171 continue,,,,,,,,,,,,,,,,,,,,      spk=152,,,,,,,,,,,CALL MSPEAK(19),,,,,,,,,      if(at(dragon).eq.1.and.prop(dragon).eq.0)goto 9175,RETURN,,,,,,,,,,,,,,,,,,,      spk=158,,,,,,,,,,,,,,,,,,,,      if(at(troll).eq.1)goto 9175,CALL MSPEAK(20),,,,,,,,,,WIZARD=.FALSE.,,,,,,,,,      if(here(bear).eq.1.and.prop(bear).eq.0)goto 9176,RETURN,,,,,,,,,,END,,,,,,,,,      obj=0,,,,,,,,,,,,,,,,,,,,      goto 9120,,,,,,,,,,,SUBROUTINE HOURS,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9172 spk=48,,,,,,,,,,,,,,,,,,,,      if(ran(3).eq.0) go to 9175,,,,,,,,,,,,,,,,,,,,      dseen(i)=0,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      dloc(i)=0,"DIMENSION HNAME(4),VAL(5)",,,,,,,,,,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME",,,,,,,,,      spk=47,,,,,,,,,,,TYPE 1,,,,,,,,,      dkill=dkill+1,FORMAT(),,,,,,,,,,"CALL HOURSX(WKDAY,'Mon -',' Fri:')",,,,,,,,,      if(dkill.eq.1)spk=149,"CALL HOURSX(WKEND,'Sat -',' Sun:')",,,,,,,,,,"CALL HOURSX(Holid,'Holid','ays: ')",,,,,,,,, 9175 call rspeak(spk),"CALL DATIME(D,T)",,,,,,,,,,IF(HEND.LT.D.OR.HEND.LT.HBEGIN)RETURN,,,,,,,,,"      call drop(axe,loc)",IF(HBEGIN.GT.D)GOTO 10,,,,,,,,,,"TYPE 5,HNAME",,,,,,,,,      k=null,"FORMAT(/' Today is a holiday, namely ',4A5)",,,,,,,,,,RETURN,,,,,,,,,      goto 8,,,,,,,,,,,D=HBEGIN-D,,,,,,,,,,"T='Days,'",,,,,,,,,,"IF(D.EQ.1)T='Day, '",,,,,,,,,c  this'll teach him to throw the axe at the bear!,"TYPE 15,D,T,HNAME",,,,,,,,,,"FORMAT(/' The next holiday will be in',I3,' ',A5,' namely ',4A5)",,,,,,,,, 9176 spk=164,RETURN,,,,,,,,,,END,,,,,,,,,"      call drop(axe,loc)",,,,,,,,,,,,,,,,,,,,      fixed(axe)=-1,,,,,,,,,,,"SUBROUTINE HOURSX(H,DAY1,DAY2)",,,,,,,,,      prop(axe)=1,,,,,,,,,,,,,,,,,,,,      call juggle(bear),,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      goto 2011,LOGICAL FIRST,,,,,,,,,,,,,,,,,,,,FIRST=.TRUE.,,,,,,,,,,FROM=-1,,,,,,,,,c  but throwing food is another story.,IF(H.NE.0)GOTO 10,,,,,,,,,,"TYPE 2,DAY1,DAY2",,,,,,,,, 9177 obj=bear,"FORMAT(10X,2A5,'  Open all day')",,,,,,,,,,RETURN,,,,,,,,,      goto 9210,,,,,,,,,,,FROM=FROM+1,,,,,,,,,,"IF((H.AND.SHIFT(1,FROM)).NE.0)GOTO 10",,,,,,,,,,IF(FROM.GE.24)GOTO 20,,,,,,,,, 9178 spk=159,TILL=FROM,,,,,,,,,,TILL=TILL+1,,,,,,,,,c  snarf a treasure for the troll.,"IF((H.AND.SHIFT(1,TILL)).EQ.0.AND.TILL.NE.24)GOTO 14",,,,,,,,,,"IF(FIRST)TYPE 16,DAY1,DAY2,FROM,TILL",,,,,,,,,"      call drop(obj,0)","IF(.NOT.FIRST)TYPE 18,FROM,TILL",,,,,,,,,,"FORMAT(10X,2A5,I4,':00 to',I3,':00')",,,,,,,,,"      call move(troll,0)","FORMAT(20X,I4,':00 to',I3,':00')",,,,,,,,,,FIRST=.FALSE.,,,,,,,,,"      call move(troll+100,0)",FROM=TILL,,,,,,,,,,GOTO 10,,,,,,,,,"      call drop(troll2,plac(troll))",,,,,,,,,,,"IF(FIRST)TYPE 22,DAY1,DAY2",,,,,,,,,"      call drop(troll2+100,fixd(troll))","FORMAT(10X,2A5,'  Closed all day')",,,,,,,,,,RETURN,,,,,,,,,      call juggle(chasm),END,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,SUBROUTINE NEWHRS,,,,,,,,,,,,,,,,,,,c  quit.  intransitive only.  verify intent and exit if that's what he wants.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,," 8180 gaveup=yes(22,54,54)",DIMENSION HNAME(4),,,,,,,,,,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME",,,,,,,,, 8185 if(gaveup.eq.1)goto 20000,,,,,,,,,,,CALL MSPEAK(21),,,,,,,,,      goto 2012,"WKDAY=NEWHRX('Weekd','ays:')",,,,,,,,,,"WKEND=NEWHRX('Weeke','nds:')",,,,,,,,,,"HOLID=NEWHRX('Holid','ays:')",,,,,,,,,,CALL MSPEAK(22),,,,,,,,,"c  find.  might be carrying it, or it might be here.  else give caveat.",CALL HOURS,,,,,,,,,,RETURN,,,,,,,,,,END,,,,,,,,,,,,,,,,,,, 9190 if(at(obj).eq.1.or.(liq(0).eq.obj.and.at(bottle).eq.1),,,,,,,,,,,,,,,,,,,,     .   .or.k.eq.liqloc(loc))spk=94,"INTEGER FUNCTION NEWHRX(DAY1,DAY2)",,,,,,,,,,,,,,,,,,,"      do 9192 i=1,5",,,,,,,,,,,,,,,,,,,, 9192 if(dloc(i).eq.loc.and.dflag.ge.2.and.obj.eq.dwarf)spk=94,IMPLICIT INTEGER(A-Z),,,,,,,,,,,,,,,,,,,      if(closed.eq.1)spk=138,NEWHRX=0,,,,,,,,,,"TYPE 1,DAY1,DAY2",,,,,,,,,      if(toting(obj).eq.1)spk=24,"FORMAT(' Prime time on ',2A5)",,,,,,,,,,TYPE 2,,,,,,,,,      goto 2011,FORMAT(' from:'),,,,,,,,,,"ACCEPT 3,FROM",,,,,,,,,,FORMAT(G),,,,,,,,,,IF(FROM.LT.0.OR.FROM.GE.24)RETURN,,,,,,,,,"c  inventory.  if object, treat same as find.  else report on current burden.",TYPE 4,,,,,,,,,,FORMAT(' till:'),,,,,,,,,,"ACCEPT 3,TILL",,,,,,,,,,TILL=TILL-1,,,,,,,,, 8200 spk=98,IF(TILL.LT.FROM.OR.TILL.GE.24)RETURN,,,,,,,,,,"DO 5 I=FROM,TILL",,,,,,,,,      blklin=1,IDONDX=I,,,,,,,,,,"NEWHRX=(NEWHRX.OR.SHIFT(1,IDONDX))",,,,,,,,,"      do 8201 i=1,100",GOTO 10,,,,,,,,,,END,,,,,,,,,      idondx=i,,,,,,,,,,,,,,,,,,,,      if(idondx.eq.bear.or.toting(idondx).eq.0)goto 8201,,,,,,,,,,,SUBROUTINE MOTD(ALTER),,,,,,,,,      if(spk.eq.98)call rspeak(99),,,,,,,,,,,,,,,,,,,,"      call pspeak(idondx,-1)",,,,,,,,,,,,,,,,,,,,      if (blklin.eq.1) blklin=0,IMPLICIT INTEGER(A-Z),,,,,,,,,,LOGICAL ALTER,,,,,,,,,      spk=0,DIMENSION MSG(100),,,,,,,,,,DATA MSG/100*-1/,,,,,,,,, 8201 continue,,,,,,,,,,,IF(ALTER)GOTO 50,,,,,,,,,      blklin=1,,,,,,,,,,,K=1,,,,,,,,,      if(toting(bear).eq.1)spk=141,IF(MSG(K).LT.0)RETURN,,,,,,,,,,"TYPE 20,(MSG(I),I=K+1,MSG(K)-1)",,,,,,,,,      goto 2011,"FORMAT(' ',14A5)",,,,,,,,,,K=MSG(K),,,,,,,,,,GOTO 10,,,,,,,,,,,,,,,,,,,"c  feed.  if bird, no seed.  snake, dragon, troll: quip.  if dwarf, make him",M=1,,,,,,,,,,CALL MSPEAK(23),,,,,,,,,"c  mad.  bear, special.","ACCEPT 56,(MSG(I),I=M+1,M+14),K",,,,,,,,,,FORMAT(15A5),,,,,,,,,,IF(K.EQ.' ')GOTO 60,,,,,,,,,,CALL MSPEAK(24),,,,,,,,, 9210 if(obj.ne.bird)goto 9212,GOTO 55,,,,,,,,,,"DO 62 I=1,14",,,,,,,,,      spk=100,K=M+15-I,,,,,,,,,,IF(MSG(K).NE.' ')GOTO 65,,,,,,,,,      goto 2011,CONTINUE,,,,,,,,,,GOTO 90,,,,,,,,,,MSG(M)=K+1,,,,,,,,,,M=K+1,,,,,,,,, 9212 if(obj.ne.snake.and.obj.ne.dragon.and.obj.ne.troll)goto 9213,IF(M+14.LT.100)GOTO 55,,,,,,,,,,CALL MSPEAK(25),,,,,,,,,      spk=102,MSG(M)=-1,,,,,,,,,,RETURN,,,,,,,,,      if(obj.eq.dragon.and.prop(dragon).ne.0)spk=110,END,,,,,,,,,,,,,,,,,,,      if(obj.eq.troll)spk=182,,,,,,,,,,,,,,,,,,,,      if(obj.ne.snake.or.closed.eq.1.or.here(bird).eq.0)goto 2011,SUBROUTINE POOF,,,,,,,,,,,,,,,,,,,      spk=101,,,,,,,,,,,,,,,,,,,,      call dstroy(bird),,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      prop(bird)=0,DIMENSION HNAME(4),,,,,,,,,,"COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME,",,,,,,,,,      tally2=tally2+1,1,"SHORT,MAGIC,MAGNM,LATNCY,SAVED,SAVET,SETUP",,,,,,,,,,,,,,,,,,      goto 2011,"WKDAY=""00777400",,,,,,,,,,WKEND=0,,,,,,,,,,HOLID=0,,,,,,,,,,HBEGIN=0,,,,,,,,, 9213 if(obj.ne.dwarf)goto 9214,HEND=-1,,,,,,,,,,SHORT=30,,,,,,,,,      if(here(food).eq.0)goto 2011,MAGIC='DWARF',,,,,,,,,,MAGNM=11111,,,,,,,,,      spk=103,LATNCY=90,,,,,,,,,,RETURN,,,,,,,,,      dflag=dflag+1,END,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9214 if(obj.ne.bear)goto 9215,"INTEGER FUNCTION SHIFT(VAL,DIST)",,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      if(prop(bear).eq.0)spk=102,,,,,,,,,,,,,,,,,,,,      if(prop(bear).eq.3)spk=110,,,,,,,,,,,SHIFT=VAL,,,,,,,,,      if(here(food).eq.0)goto 2011,"IF(DIST)10,20,30",,,,,,,,,,IDIST=-DIST,,,,,,,,,      call dstroy(food),"DO 11 I=1,IDIST",,,,,,,,,,J=0,,,,,,,,,      prop(bear)=1,"IF(SHIFT.LT.0)J=""200000000000",,,,,,,,,,"SHIFT=((SHIFT.AND.""377777777777)/2)+J",,,,,,,,,      fixed(axe)=0,RETURN,,,,,,,,,,"DO 31 I=1,DIST",,,,,,,,,      prop(axe)=0,J=0,,,,,,,,,,"IF((SHIFT.AND.""200000000000).NE.0)J=""400000000000",,,,,,,,,      spk=168,"SHIFT=(SHIFT.AND.""177777777777)*2+J",,,,,,,,,,RETURN,,,,,,,,,      goto 2011,END,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9215 spk=14,INTEGER FUNCTION RAN(RANGE),,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  fill.  bottle must be empty, and some liquid available.  (vase is nasty.)",,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,,DATA R/0/,,,,,,,,,,,,,,,,,,, 9220 if(obj.eq.vase)goto 9222,D=1,,,,,,,,,,IF(R.NE.0)GOTO 1,,,,,,,,,      if(obj.ne.0.and.obj.ne.bottle)goto 2011,"CALL DATIME(D,T)",,,,,,,,,,R=18*T+5,,,,,,,,,      if(obj.eq.0.and.here(bottle).eq.0)goto 8000,"D=1000+MOD(D,1000)",,,,,,,,,,"DO 2 T=1,D",,,,,,,,,      spk=107,"R=MOD(R*1021,1048576)",,,,,,,,,,RAN=(RANGE*R)/1048576,,,,,,,,,      if(liqloc(loc).eq.0)spk=106,RETURN,,,,,,,,,,END,,,,,,,,,      if(liq(0).ne.0)spk=105,,,,,,,,,,,,,,,,,,,,      if(spk.ne.107)goto 2011,,,,,,,,,,,"SUBROUTINE DATIME(D,T)",,,,,,,,,"      prop(bottle)=mod(cond(loc),4)/2*2",,,,,,,,,,,,,,,,,,,,      k=liq(0),,,,,,,,,,,,,,,,,,,,      if(toting(bottle).eq.1)place(k)=-1,,,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,      if(k.eq.oil)spk=108,"DIMENSION DAT(2),MONTHS(12),HATH(12)",,,,,,,,,,"DATA MONTHS/'-JAN-','-FEB-','-MAR-','-APR-','-MAY-','-JUN-',",,,,,,,,,      goto 2011,1,"'-JUL-','-AUG-','-SEP-','-OCT-','-NOV-','-DEC-'/",,,,,,,,,"DATA HATH/31,28,31,30,31,30,31,31,30,31,30,31/",,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9222 spk=29,,,,,,,,,,,"I2(X)=(SHIFT(X,-29).AND.15)*10+(SHIFT(X,-22).AND.15)",,,,,,,,,      if(liqloc(loc).eq.0)spk=144,,,,,,,,,,,CALL DATE(DAT),,,,,,,,,      if(liqloc(loc).eq.0.or.toting(vase).eq.0)goto 2011,CALL TIME(TIM),,,,,,,,,,,,,,,,,,,      call rspeak(145),"YEAR=I2(SHIFT(DAT(2),14))-77",,,,,,,,,,D=I2(DAT(1))-1,,,,,,,,,      prop(vase)=2,"X=((SHIFT(DAT(1),14).OR.SHIFT(DAT(2),-21)).AND..NOT.""1004020001)",,,,,,,,,,1,.OR.'-@@@-',,,,,,,,      fixed(vase)=-1,,,,,,,,,,,"DO 1 MON=1,12",,,,,,,,,      goto 9024,IF(X.EQ.MONTHS(MON))GOTO 2,,,,,,,,,,D=D+HATH(MON),,,,,,,,,,CALL BUG(28),,,,,,,,,,,,,,,,,,,"c  blast.  no effect unless you've got dynamite, which is a neat trick!",D=D+YEAR*365+YEAR/4,,,,,,,,,,"IF(MOD(YEAR,4).EQ.3.AND.MON.GT.2)D=D+1",,,,,,,,,,"T=I2(TIM)*60+I2(SHIFT(TIM,21))",,,,,,,,,,RETURN,,,,,,,,, 9230 if(prop(rod2).lt.0.or.closed.eq.0)goto 2011,END,,,,,,,,,,,,,,,,,,,      bonus=133,,,,,,,,,,,,,,,,,,,,      if(loc.eq.115)bonus=134,SUBROUTINE CIAO,,,,,,,,,,,,,,,,,,,      if(here(rod2).eq.1)bonus=135,,,,,,,,,,,,,,,,,,,,      call rspeak(bonus),,,,,,,,,,,,,,,,,,,,      goto 20000,IMPLICIT INTEGER(A-Z),,,,,,,,,,DATA K/32/,,,,,,,,,,,,,,,,,,,,CALL MSPEAK(K),,,,,,,,,"c  score.  go to scoring section, which will return to 8241 if scorng is true.","IF(K.EQ.31)CALL GETIN(A,B,C,D)",,,,,,,,,,STOP,,,,,,,,,,END,,,,,,,,,,,,,,,,,,, 8240 scorng=1,,,,,,,,,,,,,,,,,,,,      goto 20000,SUBROUTINE BUG(NUM),,,,,,,,,,IMPLICIT INTEGER(A-Z),,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8241 scorng=0,,,,,,,,,,,0,MESSAGE LINE > 70 CHARACTERS,,,,,,,,"      write(*,8243) score, mxscor, turns",1,NULL LINE IN MESSAGE,,,,,,,,,2,TOO MANY WORDS OF MESSAGES,,,,,,,," 8243 format(/' If you were to quit now,',/,' You would score',i4",3,TOO MANY TRAVEL OPTIONS,,,,,,,,,4,TOO MANY VOCABULARY WORDS,,,,,,,,"     . ,' out of a possible',i4,', using ',i5,' turns.')",5,REQUIRED VOCABULARY WORD NOT FOUND,,,,,,,,,6,TOO MANY RTEXT OR MTEXT MESSAGES,,,,,,,,"c  gaveup=yes(143,54,54)",7,TOO MANY HINTS,,,,,,,,,8,LOCATION HAS COND BIT BEING SET TWICE,,,,,,,,c  goto 8185,9,INVALID SECTION NUMBER IN DATABASE,,,,,,,,,20,SPECIAL TRAVEL (500>L>300) EXCEEDS GOTO LIST,,,,,,,,      go to 2012,21,RAN OFF END OF VOCABULARY TABLE,,,,,,,,,22,VOCABULARY TYPE (N/1000) NOT BETWEEN 0 AND 3,,,,,,,,c  fee fie foe foo (and fum).  advance to next state if given in proper order.,23,INTRANSITIVE ACTION VERB EXCEEDS GOTO LIST,,,,,,,,,24,TRANSITIVE ACTION VERB EXCEEDS GOTO LIST,,,,,,,,c  look up wd1 in section 3 of vocab to determine which word we've got.  last,25,CONDITIONAL TRAVEL ENTRY WITH NO ALTERNATIVE,,,,,,,,,26,LOCATION HAS NO TRAVEL ENTRIES,,,,,,,,c  word zips the eggs back to the giant room (unless already there).,27,HINT NUMBER EXCEEDS GOTO LIST,,,,,,,,,28,INVALID MONTH RETURNED BY DATE FUNCTION,,,,,,,,,,,,,,,,,,,"TYPE 1, NUM",,,,,,,,," 8250 k=vocab(wd1,3)","FORMAT (' Fatal error, see source code for interpretation.'/",,,,,,,,,,1,' Probable cause: erroneous info in database.'/,,,,,,,,      spk=42,2,"' Error code =',I2/)",,,,,,,,,STOP,,,,,,,,,      if(foobar.eq.1-k)goto 8252,END,,,,,,,,,,,,,,,,,,,      if(foobar.ne.0)spk=151,,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8252 foobar=k,,,,,,,,,,,,,,,,,,,,      if(k.ne.4)goto 2009,,,,,,,,,,,,,,,,,,,,      foobar=0,,,,,,,,,,,,,,,,,,,,      if(place(eggs).eq.plac(eggs),,,,,,,,,,,,,,,,,,,,     .      .or.(toting(eggs).eq.1.and.loc.eq.plac(eggs)))goto 2011,,,,,,,,,,,,,,,,,,,,c  bring back troll if we steal the eggs back from him before crossing.,,,,,,,,,,,,,,,,,,,,      if(place(eggs).eq.0.and.place(troll).eq.0.and.prop(troll).eq.0),,,,,,,,,,,,,,,,,,,,     .      prop(troll)=1,,,,,,,,,,,,,,,,,,,,      k=2,,,,,,,,,,,,,,,,,,,,      if(here(eggs).eq.1)k=1,,,,,,,,,,,,,,,,,,,,      if(loc.eq.plac(eggs))k=0,,,,,,,,,,,,,,,,,,,,"      call move(eggs,plac(eggs))",,,,,,,,,,,,,,,,,,,,"      call pspeak(eggs,k)",,,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  brief.  intransitive only.  suppress long descriptions after first time.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8260 spk=156,,,,,,,,,,,,,,,,,,,,      abbnum=10000,,,,,,,,,,,,,,,,,,,,      detail=3,,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  read.  magazines in dwarvish, message we've seen, and . . . oyster?",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 8270 if(here(magzin).eq.1)obj=magzin,,,,,,,,,,,,,,,,,,,,      if(here(tablet).eq.1)obj=obj*100+tablet,,,,,,,,,,,,,,,,,,,,      if(here(messag).eq.1)obj=obj*100+messag,,,,,,,,,,,,,,,,,,,,      if(closed.eq.1.and.toting(oyster).eq.1)obj=oyster,,,,,,,,,,,,,,,,,,,,      if(obj.gt.100.or.obj.eq.0.or.dark(0).eq.1)goto 8000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9270 if(dark(0).eq.1)goto 5190,,,,,,,,,,,,,,,,,,,,      if(obj.eq.magzin)spk=190,,,,,,,,,,,,,,,,,,,,      if(obj.eq.tablet)spk=196,,,,,,,,,,,,,,,,,,,,      if(obj.eq.messag)spk=191,,,,,,,,,,,,,,,,,,,,      if(obj.eq.oyster.and.hinted(2).eq.1.and.toting(oyster).eq.1),,,,,,,,,,,,,,,,,,,,     .  spk=194,,,,,,,,,,,,,,,,,,,,      if(obj.ne.oyster.or.hinted(2).eq.1.or.toting(oyster).eq.0,,,,,,,,,,,,,,,,,,,,     .   .or.closed.eq.0)goto 2011,,,,,,,,,,,,,,,,,,,,"      hinted(2)=yes(192,193,54)",,,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  break.  only works for mirror in repository and, of course, the vase.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9280 if(obj.eq.mirror)spk=148,,,,,,,,,,,,,,,,,,,,      if(obj.eq.vase.and.prop(vase).eq.0)goto 9282,,,,,,,,,,,,,,,,,,,,      if(obj.ne.mirror.or.closed.eq.0)goto 2011,,,,,,,,,,,,,,,,,,,,      call rspeak(197),,,,,,,,,,,,,,,,,,,,      goto 19000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9282 spk=198,,,,,,,,,,,,,,,,,,,,"      if(toting(vase).eq.1)call drop(vase,loc)",,,,,,,,,,,,,,,,,,,,      prop(vase)=2,,,,,,,,,,,,,,,,,,,,      fixed(vase)=-1,,,,,,,,,,,,,,,,,,,,      goto 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  wake.  only use is to disturb the dwarves.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,, 9290 if(obj.ne.dwarf.or.closed.eq.0)goto 2011,,,,,,,,,,,,,,,,,,,,      call rspeak(199),,,,,,,,,,,,,,,,,,,,      goto 19000,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  suspend.  offer to exit and give specs on restart.,,,,,,,,,,,,,,,,,,,,"c  upon restarting, ""resume"" on first turn only comes to 8305",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,," 8300 write (*,8302)",,,,,,,,,,,,,,,,,,,," 8302 format(/' I can suspend your Adventure for you so that you can',",,,,,,,,,,,,,,,,,,,,"     . /,' restart later, but you will have to type ""resume"" on your',",,,,,,,,,,,,,,,,,,,,"     . /,' FIRST TURN.  The save process will write a 2772 byte file',",,,,,,,,,,,,,,,,,,,,"     . /,' named ADVENTUR.SV in your current directory.')",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      if(yes(200,54,54).eq.0) go to 2012",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  write data file with all the good stuff to resume from,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      open (2,file='adventur.sv',form='unformatted',status='unknown')",,,,,,,,,,,,,,,,,,,,"      write (2) place,prop,link,abb,cond,atloc,fixd,plac,hinted,",,,,,,,,,,,,,,,,,,,,"     .   hintlc,dseen,dloc,odloc,fixed,hints,tally,tally2,dflag,turns,",,,,,,,,,,,,,,,,,,,,"     .   limit,iwest,knfloc,detail,abbnum,maxdie,numdie,holdng,dkill,",,,,,,,,,,,,,,,,,,,,"     .   foobar,bonus,lmwarn,clock1,clock2,panic,closed,obj,verb,newloc",,,,,,,,,,,,,,,,,,,,"     .  ,loc,dtotal,attack,stick,itk,idondx,kk,oldlc2,oldloc,wzdark,",,,,,,,,,,,,,,,,,,,,     .  closng,,,,,,,,,,,,,,,,,,,,      close (2),,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      write (*,83001)",,,,,,,,,,,,,,,,,,,,"83001 format(//,' Your Adventure has been saved.  Type ""resume""',/,",,,,,,,,,,,,,,,,,,,,"     .   ' on your FIRST TURN to restart where you left off.',//)",,,,,,,,,,,,,,,,,,,,      go to 25000,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  resume saved game from data file adventur.sv.  resume must be on,,,,,,,,,,,,,,,,,,,,c  first turn.  comes here to read all variables as we wrote them,,,,,,,,,,,,,,,,,,,,c  and proceeds.,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"8305  open (2,file='adventur.sv',form='unformatted')",,,,,,,,,,,,,,,,,,,,"      read  (2) place,prop,link,abb,cond,atloc,fixd,plac,hinted,",,,,,,,,,,,,,,,,,,,,"     .   hintlc,dseen,dloc,odloc,fixed,hints,tally,tally2,dflag,turns,",,,,,,,,,,,,,,,,,,,,"     .   limit,iwest,knfloc,detail,abbnum,maxdie,numdie,holdng,dkill,",,,,,,,,,,,,,,,,,,,,"     .   foobar,bonus,lmwarn,clock1,clock2,panic,closed,obj,verb,newloc",,,,,,,,,,,,,,,,,,,,"     .  ,loc,dtotal,attack,stick,itk,idondx,kk,oldlc2,oldloc,wzdark,",,,,,,,,,,,,,,,,,,,,     .  closng,,,,,,,,,,,,,,,,,,,,      close (2),,,,,,,,,,,,,,,,,,,,      yea=1,,,,,,,,,,,,,,,,,,,,      k=null,,,,,,,,,,,,,,,,,,,,      goto 8,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  hours.  report current non-prime-time hours.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,," 8310 write (*,83101)",,,,,,,,,,,,,,,,,,,,"83101 format (/,' Colossal Cave is always open.')",,,,,,,,,,,,,,,,,,,,      goto 2012,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  hints,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  come here if he's been long enough at required loc(s) for some unused hint.,,,,,,,,,,,,,,,,,,,,"c  hint number is in variable ""hint"".  branch to quick test for additional",,,,,,,,,,,,,,,,,,,,"c  conditions, then come back to do neat stuff.  goto 40010 if conditions are",,,,,,,,,,,,,,,,,,,,"c  met and we want to offer the hint.  goto 40020 to clear hintlc back to zero,",,,,,,,,,,,,,,,,,,,,c  40030 to take no action yet.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40000 if(hint.lt.4.or.hint.gt.9) call bug(27),,,,,,,,,,,,,,,,,,,,"      go to (40400,40500,40600,40700,40800,40900),(hint-3)",,,,,,,,,,,,,,,,,,,,c     cave  bird  snake maze  dark  witt,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40010       hintlc(hint)=0,,,,,,,,,,,,,,,,,,,,"      if(yes(hints(hint,3),0,54).eq.0)goto 26021",,,,,,,,,,,,,,,,,,,,"      write (*,40012) hints (hint,2)",,,,,,,,,,,,,,,,,,,,"40012 format(/' I am prepared to give you a hint, but it will cost you',",,,,,,,,,,,,,,,,,,,,"     . i2,' points.')",,,,,,,,,,,,,,,,,,,,"      hinted(hint)=yes(175,hints(hint,4),54)",,,,,,,,,,,,,,,,,,,,"      if(hinted(hint).eq.1.and.limit.gt.30)limit=limit+30*hints(hint,2)",,,,,,,,,,,,,,,,,,,,40020 hintlc(hint)=0,,,,,,,,,,,,,,,,,,,,40030 goto 26021,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  now for the quick tests.  see database description for one-line notes.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40400 if(prop(grate).eq.0.and.here(keys).eq.0)goto 40010,,,,,,,,,,,,,,,,,,,,      goto 40020,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40500 if(here(bird).eq.1.and.toting(rod).eq.1.and.obj.eq.bird)goto40010,,,,,,,,,,,,,,,,,,,,      goto 40030,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40600 if(here(snake).eq.1.and.here(bird).eq.0)goto 40010,,,,,,,,,,,,,,,,,,,,      goto 40020,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40700 if(atloc(loc).eq.0.and.atloc(oldloc).eq.0,,,,,,,,,,,,,,,,,,,,     .   .and.atloc(oldlc2).eq.0.and.holdng.gt.1)goto 40010,,,,,,,,,,,,,,,,,,,,      goto 40020,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40800 if(prop(emrald).ne.-1.and.prop(pyram).eq.-1)goto 40010,,,,,,,,,,,,,,,,,,,,      goto 40020,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40900 goto 40010,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  cave closing and scoring,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  these sections handle the closing of the cave.  the cave closes ""clock1""",,,,,,,,,,,,,,,,,,,,c  turns after the last treasure has been located (including the pirate's,,,,,,,,,,,,,,,,,,,,"c  chest, which may of course never show up).  note that the treasures need not",,,,,,,,,,,,,,,,,,,,"c  have been taken yet, just located.  hence clock1 must be large enough to get",,,,,,,,,,,,,,,,,,,,"c  out of the cave (it only ticks while inside the cave).  when it hits zero,",,,,,,,,,,,,,,,,,,,,"c  we branch to 10000 to start closing the cave, and then sit back and wait for",,,,,,,,,,,,,,,,,,,,"c  him to try to get out.  if he doesn't within clock2 turns, we close the",,,,,,,,,,,,,,,,,,,,"c  cave; if he does try, we assume he panics, and give him a few additional",,,,,,,,,,,,,,,,,,,,"c  turns to get frantic before we close.  when clock2 hits zero, we branch to",,,,,,,,,,,,,,,,,,,,c  11000 to transport him into the final puzzle.  note that the puzzle depends,,,,,,,,,,,,,,,,,,,,"c  upon all sorts of random things.  for instance, there must be no water or",,,,,,,,,,,,,,,,,,,,"c  oil, since there are beanstalks which we don't want to be able to water,",,,,,,,,,,,,,,,,,,,,"c  since the code can't handle it.  also, we can have no keys, since there is a",,,,,,,,,,,,,,,,,,,,c  grate (having moved the fixed object!) there separating him from all the,,,,,,,,,,,,,,,,,,,,c  treasures.  most of these problems arise from the use of negative prop,,,,,,,,,,,,,,,,,,,,c  numbers to suppress the object descriptions until he's actually moved the,,,,,,,,,,,,,,,,,,,,c  objects.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  when the first warning comes, we lock the grate, destroy the bridge, kill",,,,,,,,,,,,,,,,,,,,"c  all the dwarves (and the pirate), remove the troll and bear (unless dead),",,,,,,,,,,,,,,,,,,,,"c  and set ""closng"" to true.  leave the dragon; too much trouble to move it.",,,,,,,,,,,,,,,,,,,,"c  from now until clock2 runs out, he cannot unlock the grate, move to any",,,,,,,,,,,,,,,,,,,,"c  location outside the cave (loc<9), or create the bridge.  nor can he be",,,,,,,,,,,,,,,,,,,,"c  resurrected if he dies.  note that the snake is already gone, since he got",,,,,,,,,,,,,,,,,,,,"c  to the treasure accessible only via the hall of the mt. king.  also, he's",,,,,,,,,,,,,,,,,,,,"c  been in giant room (to get eggs), so we can refer to it.  also also, he's",,,,,,,,,,,,,,,,,,,,"c  gotten the pearl, so we know the bivalve is an oyster.  *and*, the dwarves",,,,,,,,,,,,,,,,,,,,"c  must have been activated, since we've found chest.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,10000 prop(grate)=0,,,,,,,,,,,,,,,,,,,,      prop(fissur)=0,,,,,,,,,,,,,,,,,,,,"      do 10010 i=1,6",,,,,,,,,,,,,,,,,,,,      dseen(i)=0,,,,,,,,,,,,,,,,,,,,10010 dloc(i)=0,,,,,,,,,,,,,,,,,,,,"      call move(troll,0)",,,,,,,,,,,,,,,,,,,,"      call move(troll+100,0)",,,,,,,,,,,,,,,,,,,,"      call move(troll2,plac(troll))",,,,,,,,,,,,,,,,,,,,"      call move(troll2+100,fixd(troll))",,,,,,,,,,,,,,,,,,,,      call juggle(chasm),,,,,,,,,,,,,,,,,,,,      if(prop(bear).ne.3)call dstroy(bear),,,,,,,,,,,,,,,,,,,,      prop(chain)=0,,,,,,,,,,,,,,,,,,,,      fixed(chain)=0,,,,,,,,,,,,,,,,,,,,      prop(axe)=0,,,,,,,,,,,,,,,,,,,,      fixed(axe)=0,,,,,,,,,,,,,,,,,,,,      call rspeak(129),,,,,,,,,,,,,,,,,,,,      clock1=-1,,,,,,,,,,,,,,,,,,,,      closng=1,,,,,,,,,,,,,,,,,,,,      goto 19999,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  once he's panicked, and clock2 has run out, we come here to set up the",,,,,,,,,,,,,,,,,,,,"c  storage room.  the room has two locs, hardwired as 115 (ne) and 116 (sw).",,,,,,,,,,,,,,,,,,,,"c  at the ne end, we place empty bottles, a nursery of plants, a bed of",,,,,,,,,,,,,,,,,,,,"c  oysters, a pile of lamps, rods with stars, sleeping dwarves, and him.  and",,,,,,,,,,,,,,,,,,,,"c  the sw end we place grate over treasures, snake pit, covey of caged birds,",,,,,,,,,,,,,,,,,,,,"c  more rods, and pillows.  a mirror stretches across one wall.  many of the",,,,,,,,,,,,,,,,,,,,c  objects come from known locations and/or states (e.g. the snake is known to,,,,,,,,,,,,,,,,,,,,"c  have been destroyed and needn't be carried away from its old ""place""),",,,,,,,,,,,,,,,,,,,,c  making the various objects be handled differently.  we also drop all other,,,,,,,,,,,,,,,,,,,,"c  objects he might be carrying (lest he have some which could cause trouble,",,,,,,,,,,,,,,,,,,,,c  such as the keys).  we describe the flash of light and trundle back.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"11000 prop(bottle)=put(bottle,115,1)",,,,,,,,,,,,,,,,,,,,"      prop(plant)=put(plant,115,0)",,,,,,,,,,,,,,,,,,,,"      prop(oyster)=put(oyster,115,0)",,,,,,,,,,,,,,,,,,,,"      prop(lamp)=put(lamp,115,0)",,,,,,,,,,,,,,,,,,,,"      prop(rod)=put(rod,115,0)",,,,,,,,,,,,,,,,,,,,"      prop(dwarf)=put(dwarf,115,0)",,,,,,,,,,,,,,,,,,,,      loc=115,,,,,,,,,,,,,,,,,,,,      oldloc=115,,,,,,,,,,,,,,,,,,,,      newloc=115,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  leave the grate with normal (non-negative property).,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      foo=put(grate,116,0)",,,,,,,,,,,,,,,,,,,,"      prop(snake)=put(snake,116,1)",,,,,,,,,,,,,,,,,,,,"      prop(bird)=put(bird,116,1)",,,,,,,,,,,,,,,,,,,,"      prop(cage)=put(cage,116,0)",,,,,,,,,,,,,,,,,,,,"      prop(rod2)=put(rod2,116,0)",,,,,,,,,,,,,,,,,,,,"      prop(pillow)=put(pillow,116,0)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      prop(mirror)=put(mirror,115,0)",,,,,,,,,,,,,,,,,,,,      fixed(mirror)=116,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      do 11010 i=1,100",,,,,,,,,,,,,,,,,,,,      idondx=i,,,,,,,,,,,,,,,,,,,,11010 if(toting(idondx).eq.1)call dstroy(idondx),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      call rspeak(132),,,,,,,,,,,,,,,,,,,,      closed=1,,,,,,,,,,,,,,,,,,,,      goto 2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  another way we can force an end to things is by having the lamp give out.,,,,,,,,,,,,,,,,,,,,"c  when it gets close, we come here to warn him.  we go to 12000 if the lamp",,,,,,,,,,,,,,,,,,,,"c  and fresh batteries are here, in which case we replace the batteries and",,,,,,,,,,,,,,,,,,,,c  continue. 12200 is for other cases of lamp dying.  12400 is when it goes,,,,,,,,,,,,,,,,,,,,"c  out, and 12600 is if he's wandered outside and the lamp is used up, in which",,,,,,,,,,,,,,,,,,,,c  case we force him to give up.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12000 call rspeak(188),,,,,,,,,,,,,,,,,,,,      prop(batter)=1,,,,,,,,,,,,,,,,,,,,"      if(toting(batter).eq.1)call drop(batter,loc)",,,,,,,,,,,,,,,,,,,,      limit=limit+2500,,,,,,,,,,,,,,,,,,,,      lmwarn=0,,,,,,,,,,,,,,,,,,,,      goto 19999,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12200 if(lmwarn.eq.1.or.here(lamp).eq.0)goto 19999,,,,,,,,,,,,,,,,,,,,      lmwarn=1,,,,,,,,,,,,,,,,,,,,      spk=187,,,,,,,,,,,,,,,,,,,,      if(place(batter).eq.0)spk=183,,,,,,,,,,,,,,,,,,,,      if(prop(batter).eq.1)spk=189,,,,,,,,,,,,,,,,,,,,      call rspeak(spk),,,,,,,,,,,,,,,,,,,,      goto 19999,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12400 limit=-1,,,,,,,,,,,,,,,,,,,,      prop(lamp)=0,,,,,,,,,,,,,,,,,,,,      if(here(lamp).eq.1)call rspeak(184),,,,,,,,,,,,,,,,,,,,      goto 19999,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12600 call rspeak(185),,,,,,,,,,,,,,,,,,,,      gaveup=1,,,,,,,,,,,,,,,,,,,,      goto 20000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  oh dear, he's disturbed the dwarves.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,19000 call rspeak(136),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  exit code.  will eventually include scoring.  for now, however, ...",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  the present scoring algorithm is as follows:,,,,,,,,,,,,,,,,,,,,c  objective:          points:        present total possible:,,,,,,,,,,,,,,,,,,,,c  getting well into cave   45                    45,,,,,,,,,,,,,,,,,,,,c  each treasure < chest    12                    60,,,,,,,,,,,,,,,,,,,,c  treasure chest itself    14                    14,,,,,,,,,,,,,,,,,,,,c  each treasure > chest    16                   144,,,,,,,,,,,,,,,,,,,,c  surviving             (max-num)*10             30,,,,,,,,,,,,,,,,,,,,c  not quitting              4                     4,,,,,,,,,,,,,,,,,,,,"c  reaching ""closng""        25                    25",,,,,,,,,,,,,,,,,,,,"c  ""closed"": quit/killed    10",,,,,,,,,,,,,,,,,,,,c            klutzed        25,,,,,,,,,,,,,,,,,,,,c            wrong way      30,,,,,,,,,,,,,,,,,,,,c            success        45                    45,,,,,,,,,,,,,,,,,,,,c  came to witt's end        1                     1,,,,,,,,,,,,,,,,,,,,c  round out the total       2                     2,,,,,,,,,,,,,,,,,,,,c                                       total:   370,,,,,,,,,,,,,,,,,,,,c  (points can also be deducted for using hints.),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,20000 score=0,,,,,,,,,,,,,,,,,,,,      mxscor=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  first tally up the treasures.  must be in building and not broken.,,,,,,,,,,,,,,,,,,,,c  give the poor guy 2 points just for finding each treasure.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      do 20010 i=50,maxtrs",,,,,,,,,,,,,,,,,,,,      if(ptext(i).eq.0)goto 20010,,,,,,,,,,,,,,,,,,,,      k=12,,,,,,,,,,,,,,,,,,,,      if(i.eq.chest)k=14,,,,,,,,,,,,,,,,,,,,      if(i.gt.chest)k=16,,,,,,,,,,,,,,,,,,,,      if(prop(i).ge.0)score=score+2,,,,,,,,,,,,,,,,,,,,      if(place(i).eq.3.and.prop(i).eq.0)score=score+k-2,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+k,,,,,,,,,,,,,,,,,,,,20010 continue,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  now look at how he finished and how far he got.  maxdie and numdie tell us,,,,,,,,,,,,,,,,,,,,c  how well he survived.  gaveup says whether he exited via quit.  dflag will,,,,,,,,,,,,,,,,,,,,c  tell us if he ever got suitably deep into the cave.  closng still indicates,,,,,,,,,,,,,,,,,,,,"c  whether he reached the endgame.  and if he got as far as ""cave closed""",,,,,,,,,,,,,,,,,,,,"c  (indicated by ""closed""), then bonus is zero for mundane exits or 133, 134,",,,,,,,,,,,,,,,,,,,,c  135 if he blew it (so to speak).,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      score=score+(maxdie-numdie)*10,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+maxdie*10,,,,,,,,,,,,,,,,,,,,      if(scorng.eq.0.and.gaveup.eq.0)score=score+4,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+4,,,,,,,,,,,,,,,,,,,,      if(dflag.ne.0)score=score+45,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+45,,,,,,,,,,,,,,,,,,,,      if(closng.eq.1)score=score+25,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+25,,,,,,,,,,,,,,,,,,,,      if(closed.eq.0)go to 20020,,,,,,,,,,,,,,,,,,,,      if(bonus.eq.0)score=score+10,,,,,,,,,,,,,,,,,,,,      if(bonus.eq.135)score=score+25,,,,,,,,,,,,,,,,,,,,      if(bonus.eq.134)score=score+30,,,,,,,,,,,,,,,,,,,,      if(bonus.eq.133)score=score+45,,,,,,,,,,,,,,,,,,,,20020 mxscor=mxscor+45,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  did he come to witt's end as he should?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      if(place(magzin).eq.108)score=score+1,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  round it off.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      score=score+2,,,,,,,,,,,,,,,,,,,,      mxscor=mxscor+2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  deduct points for hints.  hints < 4 are special; see database description.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      do 20030 i=1,hntmax",,,,,,,,,,,,,,,,,,,,"20030 if(hinted(i).eq.1)score=score-hints(i,2)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  return to score command if that's where we came from.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      if(scorng.eq.1)goto 8241,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  that should be good enough.  let's tell him all about it.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      write (*,20100) score, mxscor, turns",,,,,,,,,,,,,,,,,,,,"20100 format(///' You scored',i4,' out of a possible',i4,",,,,,,,,,,,,,,,,,,,,"     . ', using',i5,' turns.')",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      do 20200 i=1,clsses",,,,,,,,,,,,,,,,,,,,      if(cval(i).ge.score)goto 20210,,,,,,,,,,,,,,,,,,,,20200 continue,,,,,,,,,,,,,,,,,,,,"      write (*,20202)",,,,,,,,,,,,,,,,,,,,20202 format(/' You just went off my scale !! (Whoops) !!'/),,,,,,,,,,,,,,,,,,,,      goto 25000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,20210 call speak(ctext(i)),,,,,,,,,,,,,,,,,,,,      if(i.eq.clsses-1)goto 20220,,,,,,,,,,,,,,,,,,,,      k=cval(i)+1-score,,,,,,,,,,,,,,,,,,,,      iz='s.  ',,,,,,,,,,,,,,,,,,,,      if(k.eq.1)iz='.   ',,,,,,,,,,,,,,,,,,,,"      write (*,20212) k, iz",,,,,,,,,,,,,,,,,,,,"20212 format(/' To achieve the next higher rating, you need',i3,",,,,,,,,,,,,,,,,,,,,"     . ' more point',a2/)",,,,,,,,,,,,,,,,,,,,      goto 25000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"20220 write (*,20222)",,,,,,,,,,,,,,,,,,,,"20222 format(/' To achieve the next higher rating ',",,,,,,,,,,,,,,,,,,,,"     . 'would be a neat trick, Oh Great One!!'//' Congratulations!!'/)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"25000 write (*,25001)",,,,,,,,,,,,,,,,,,,,25001 format (/////),,,,,,,,,,,,,,,,,,,,      pause 'Please Press the ENTER Key to Exit From Adventure.',,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  subroutines and functions,,,,,,,,,,,,,,,,,,,,      subroutine speak(n),,,,,,,,,,,,,,,,,,,,c  print the message which starts at lines(n).  precede it with a blank line,,,,,,,,,,,,,,,,,,,,c  unless blklin is false.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /lincom/ lines,,,,,,,,,,,,,,,,,,,,      common /txtcom/ rtext,,,,,,,,,,,,,,,,,,,,      common /blkcom/ blklin,,,,,,,,,,,,,,,,,,,,      dimension rtext (205),,,,,,,,,,,,,,,,,,,,      character*2 lines (21150),,,,,,,,,,,,,,,,,,,,"      character*2 np,clines",,,,,,,,,,,,,,,,,,,,"      integer*4 nnn,k,l,i",,,,,,,,,,,,,,,,,,,,"      equivalence (clines,ilines)",,,,,,,,,,,,,,,,,,,,      data np/'>$'/,,,,,,,,,,,,,,,,,,,,      nnn=n,,,,,,,,,,,,,,,,,,,,      if(nnn.eq.0)return,,,,,,,,,,,,,,,,,,,,      if(lines(nnn+1).eq.np)return,,,,,,,,,,,,,,,,,,,,"      if(blklin.eq.1) write (*,2)",,,,,,,,,,,,,,,,,,,,      k=nnn,,,,,,,,,,,,,,,,,,,, 1    clines=lines(k),,,,,,,,,,,,,,,,,,,,      l=iabs(ilines)-1,,,,,,,,,,,,,,,,,,,,      k=k+1,,,,,,,,,,,,,,,,,,,,"      write (*, 2) (lines(i),i=k,l)",,,,,,,,,,,,,,,,,,,," 2    format(' ',36a2)",,,,,,,,,,,,,,,,,,,,      k=l+1,,,,,,,,,,,,,,,,,,,,      clines=lines(k),,,,,,,,,,,,,,,,,,,,      if(ilines.ge.0) go to 1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine pspeak(msg,skip)",,,,,,,,,,,,,,,,,,,,c  find the skip+1st message from msg and print it.  msg should be the index of,,,,,,,,,,,,,,,,,,,,c  the inventory message for object.  (inven+n+1 message is prop=n message).,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /lincom/ lines,,,,,,,,,,,,,,,,,,,,      common /txtcom/ rtext,,,,,,,,,,,,,,,,,,,,      common /ptxcom/ ptext,,,,,,,,,,,,,,,,,,,,"      character*2 lines (21150),clines",,,,,,,,,,,,,,,,,,,,"      dimension rtext(205),ptext(100)",,,,,,,,,,,,,,,,,,,,      integer*4 mm,,,,,,,,,,,,,,,,,,,,"      equivalence (clines,ilines)",,,,,,,,,,,,,,,,,,,,      m=ptext(msg),,,,,,,,,,,,,,,,,,,,      if(skip.lt.0)goto 9,,,,,,,,,,,,,,,,,,,,"      do 3 i=1,skip+1",,,,,,,,,,,,,,,,,,,, 1    mm=m,,,,,,,,,,,,,,,,,,,,      clines=lines(mm),,,,,,,,,,,,,,,,,,,,      m=iabs(ilines),,,,,,,,,,,,,,,,,,,,      mm=m,,,,,,,,,,,,,,,,,,,,      clines=lines(mm),,,,,,,,,,,,,,,,,,,,      if(ilines.ge.0) go to 1,,,,,,,,,,,,,,,,,,,, 3    continue,,,,,,,,,,,,,,,,,,,, 9    call speak(m),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      subroutine rspeak(i),,,,,,,,,,,,,,,,,,,,"c  print the i-th ""random"" message (section 6 of database).",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /txtcom/ rtext,,,,,,,,,,,,,,,,,,,,      dimension rtext(205),,,,,,,,,,,,,,,,,,,,      if(i.ne.0)call speak(rtext(i)),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      integer*2 function yes(x,y,z)",,,,,,,,,,,,,,,,,,,,c  call yesx (below) with messages from section 6.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      yes=yesx(x,y,z)",,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      integer*2 function yesx(x,y,z)",,,,,,,,,,,,,,,,,,,,"c  print message x, wait for yes/no answer.  if yes, print y and leave yea",,,,,,,,,,,,,,,,,,,,"c  true; if no, print z and leave yea false.",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      character*4 reply,junk1,junk2,junk3",,,,,,,,,,,,,,,,,,,, 1    if(x.ne.0) call rspeak (x),,,,,,,,,,,,,,,,,,,,"      call getin(reply,junk1,junk2,junk3)",,,,,,,,,,,,,,,,,,,,      if(reply.eq.'yes '.or.reply.eq.'y   ')goto 10,,,,,,,,,,,,,,,,,,,,      if(reply.eq.'no  '.or.reply.eq.'n   ')goto 20,,,,,,,,,,,,,,,,,,,,"      write (*,9)",,,,,,,,,,,,,,,,,,,," 9    format(/' Please answer the question ""yes"" or ""no"".')",,,,,,,,,,,,,,,,,,,,      goto 1,,,,,,,,,,,,,,,,,,,, 10   yesx=1,,,,,,,,,,,,,,,,,,,,      if(y.ne.0) call rspeak (y),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,, 20   yesx=0,,,,,,,,,,,,,,,,,,,,      if(z.ne.0) call rspeak (z),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine a5toa1 (a, b, c, d, chars, leng)",,,,,,,,,,,,,,,,,,,,c   a & b contain a 1 to 8-character word in a4 format.  c & d contain,,,,,,,,,,,,,,,,,,,,c  another word and/or punctuation. they are unpacked to one character,,,,,,,,,,,,,,,,,,,,"c  per word in the array ""chars"", with exactly one blank between b & c",,,,,,,,,,,,,,,,,,,,"c  (or none, if c is zero).  the index of the last non-blank character",,,,,,,,,,,,,,,,,,,,c  in chars is returned in leng.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      integer*4 ic,,,,,,,,,,,,,,,,,,,,      character *20 aaa,,,,,,,,,,,,,,,,,,,,"      character *4 a,b,c,d,aa(5),cc",,,,,,,,,,,,,,,,,,,,"      character *1 chars(20),raw(20)",,,,,,,,,,,,,,,,,,,,"      equivalence (aaa,aa),(cc,ic)",,,,,,,,,,,,,,,,,,,,c  do first word until a blank,,,,,,,,,,,,,,,,,,,,      aa(1) = a,,,,,,,,,,,,,,,,,,,,      aa(2) = b,,,,,,,,,,,,,,,,,,,,"      call unpack (aaa, raw)",,,,,,,,,,,,,,,,,,,,"c  clear output array and move, counting to first blank",,,,,,,,,,,,,,,,,,,,      leng=0,,,,,,,,,,,,,,,,,,,,"      do 2 i=1,20",,,,,,,,,,,,,,,,,,,,2     chars(i)=' ',,,,,,,,,,,,,,,,,,,,"      do 1 i=1,8",,,,,,,,,,,,,,,,,,,,      if (raw(i).eq.' ') go to 3,,,,,,,,,,,,,,,,,,,,      chars(i)=raw(i),,,,,,,,,,,,,,,,,,,,1     leng=i,,,,,,,,,,,,,,,,,,,,c  leng doesn't include trailing blank,,,,,,,,,,,,,,,,,,,,3     cc=c,,,,,,,,,,,,,,,,,,,,      if(ic.eq.0) go to 99,,,,,,,,,,,,,,,,,,,,"c  second word--ignore leading blanks, stop at trailing one",,,,,,,,,,,,,,,,,,,,      chars(leng+1)=' ',,,,,,,,,,,,,,,,,,,,      leng=leng+1,,,,,,,,,,,,,,,,,,,,      ll=leng,,,,,,,,,,,,,,,,,,,,      aa(1)=c,,,,,,,,,,,,,,,,,,,,      aa(2)=d,,,,,,,,,,,,,,,,,,,,"      call unpack (aaa,raw)",,,,,,,,,,,,,,,,,,,,c  skip leading blank if any,,,,,,,,,,,,,,,,,,,,"      do 4 j=1,8",,,,,,,,,,,,,,,,,,,,4     if (raw(j).ne.' ') go to 5,,,,,,,,,,,,,,,,,,,,c  second word was all blank--fooey,,,,,,,,,,,,,,,,,,,,      go to 99,,,,,,,,,,,,,,,,,,,,c  do non-blanks,,,,,,,,,,,,,,,,,,,,"5     do 6 k=j,8",,,,,,,,,,,,,,,,,,,,      if (raw(k).eq.' ') go to 99,,,,,,,,,,,,,,,,,,,,      chars (k-j+1+ll) = raw(k),,,,,,,,,,,,,,,,,,,,6     leng=leng+1,,,,,,,,,,,,,,,,,,,,99    return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      integer*2 function vocab(id,init)",,,,,,,,,,,,,,,,,,,,"c  look up id in the vocabulary (atab) and return its ""definition"" (ktab), or",,,,,,,,,,,,,,,,,,,,"c  -1 if not found.  if init is positive, this is an initialization call setting",,,,,,,,,,,,,,,,,,,,"c  up a keyword variable, and not finding it constitutes a bug.  it also means",,,,,,,,,,,,,,,,,,,,c  that only ktab values which taken over 1000 equal init may be considered.,,,,,,,,,,,,,,,,,,,,"c  (thus ""steps"", which is a motion verb also, may be considered",,,,,,,,,,,,,,,,,,,,c  as an object.)  and it also means the ktab value is taken mod 1000.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /voccom/ ktab,atab,tabsiz",,,,,,,,,,,,,,,,,,,,"      character*4 atab(295),id",,,,,,,,,,,,,,,,,,,,      dimension ktab(295),,,,,,,,,,,,,,,,,,,,"      do 1 i=1,tabsiz",,,,,,,,,,,,,,,,,,,,      if(ktab(i).eq.-1)goto 2,,,,,,,,,,,,,,,,,,,,      if(init.ge.0.and.ktab(i)/1000.ne.init)goto 1,,,,,,,,,,,,,,,,,,,,      if(atab(i).eq.id)goto 3,,,,,,,,,,,,,,,,,,,, 1    continue,,,,,,,,,,,,,,,,,,,," 10   format(1x,i4,2x,a4)",,,,,,,,,,,,,,,,,,,,      call bug(21),,,,,,,,,,,,,,,,,,,, 2    vocab=-1,,,,,,,,,,,,,,,,,,,,      if(init.lt.0)return,,,,,,,,,,,,,,,,,,,,"      write (*,10) init, id",,,,,,,,,,,,,,,,,,,,      call bug(5),,,,,,,,,,,,,,,,,,,, 3    vocab=ktab(i),,,,,,,,,,,,,,,,,,,,"      if(init.ge.0)vocab=mod(vocab,1000)",,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      subroutine dstroy(object),,,,,,,,,,,,,,,,,,,,"c  permanently eliminate ""object"" by moving to a non-existent location.",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      call move(object,0)",,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      subroutine juggle(object),,,,,,,,,,,,,,,,,,,,"c  juggle an object by picking it up and putting it down again, the purpose",,,,,,,,,,,,,,,,,,,,c  being to get the object to the front of the chain of things at its loc.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      i=place(object),,,,,,,,,,,,,,,,,,,,"      call move(object,i)",,,,,,,,,,,,,,,,,,,,"      call move(object+100,j)",,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine move(object,where)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  place any object anywhere by picking it up and dropping it.  may already be,,,,,,,,,,,,,,,,,,,,"c  toting, in which case the carry is a no-op.  mustn't pick up objects which",,,,,,,,,,,,,,,,,,,,"c  are not at any loc, since carry wants to remove objects from atloc chains.",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      if(object.gt.100)goto 1,,,,,,,,,,,,,,,,,,,,      from=place(object),,,,,,,,,,,,,,,,,,,,      goto 2,,,,,,,,,,,,,,,,,,,, 1    from=fixed(object-100),,,,,,,,,,,,,,,,,,,," 2    if(from.gt.0.and.from.le.300)call carry(object,from)",,,,,,,,,,,,,,,,,,,,"      call drop(object,where)",,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      integer*2 function put(object,where,pval)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  put is the same as move, except it returns a value used to set up the",,,,,,,,,,,,,,,,,,,,c  negated prop values for the repository objects.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      call move(object,where)",,,,,,,,,,,,,,,,,,,,      put=(-1)-pval,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine carry(object,where)",,,,,,,,,,,,,,,,,,,,"c  start toting an object, removing it from the list of things at its former",,,,,,,,,,,,,,,,,,,,c  location.  incr holdng unless it was already being toted.  if object>100,,,,,,,,,,,,,,,,,,,,"c  (moving ""fixed"" second loc), don't change place or holdng.",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      if(object.gt.100)goto 5,,,,,,,,,,,,,,,,,,,,      if(place(object).eq.-1)return,,,,,,,,,,,,,,,,,,,,      place(object)=-1,,,,,,,,,,,,,,,,,,,,      holdng=holdng+1,,,,,,,,,,,,,,,,,,,, 5    if(atloc(where).ne.object)goto 6,,,,,,,,,,,,,,,,,,,,      atloc(where)=link(object),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,, 6    temp=atloc(where),,,,,,,,,,,,,,,,,,,, 7    if(link(temp).eq.object)goto 8,,,,,,,,,,,,,,,,,,,,      temp=link(temp),,,,,,,,,,,,,,,,,,,,      goto 7,,,,,,,,,,,,,,,,,,,, 8    link(temp)=link(object),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine drop(object,where)",,,,,,,,,,,,,,,,,,,,"c  place an object at a given loc, prefixing it onto the atloc list.  decr",,,,,,,,,,,,,,,,,,,,c  holdng if the object was being toted.,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      if(object.gt.100)goto 1,,,,,,,,,,,,,,,,,,,,      if(place(object).eq.-1)holdng=holdng-1,,,,,,,,,,,,,,,,,,,,      place(object)=where,,,,,,,,,,,,,,,,,,,,      goto 2,,,,,,,,,,,,,,,,,,,, 1    fixed(object-100)=where,,,,,,,,,,,,,,,,,,,, 2    if(where.le.0)return,,,,,,,,,,,,,,,,,,,,      link(object)=atloc(where),,,,,,,,,,,,,,,,,,,,      atloc(where)=object,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  utility routines (shift, ran, datime, bug)",,,,,,,,,,,,,,,,,,,,"      integer*2 function shift (val, dist)",,,,,,,,,,,,,,,,,,,,"c return val shifted (left if dist>0, else right) dist bits",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      shift=val,,,,,,,,,,,,,,,,,,,,      if (dist.eq.0) go to 20,,,,,,,,,,,,,,,,,,,,      idist=iabs(dist),,,,,,,,,,,,,,,,,,,,"      do 1  i = 1,idist",,,,,,,,,,,,,,,,,,,,      if (dist.lt.0) shift=shift/2,,,,,,,,,,,,,,,,,,,,1     if (dist.gt.0) shift=shift*2,,,,,,,,,,,,,,,,,,,,20    return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,      subroutine bug(num),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  the following conditions are currently considered fatal bugs.  numbers < 20,,,,,,,,,,,,,,,,,,,,"c  are detected while reading the database; the others occur at ""run time"".",,,,,,,,,,,,,,,,,,,,c  0      message line > 72 characters                     ,,,,,,,,,,,,,,,,,,,,c  1      null line in message                             * Only ones,,,,,,,,,,,,,,,,,,,,c  2      too many words of messages                         currently,,,,,,,,,,,,,,,,,,,,c  3      too many travel options                            implemented,,,,,,,,,,,,,,,,,,,,c  4      too many vocabulary words,,,,,,,,,,,,,,,,,,,,c  5    * required vocabulary word not found,,,,,,,,,,,,,,,,,,,,c  6      too many rtext messages,,,,,,,,,,,,,,,,,,,,c  7      too many hints,,,,,,,,,,,,,,,,,,,,c  8      location has cond bit being set twice,,,,,,,,,,,,,,,,,,,,c  9      invalid section number in database,,,,,,,,,,,,,,,,,,,,c  20   * special travel (500>l>300) exceeds goto list,,,,,,,,,,,,,,,,,,,,c  21   * ran off end of vocabulary table,,,,,,,,,,,,,,,,,,,,c  22   * vocabulary type (n/1000) not between 0 and 3,,,,,,,,,,,,,,,,,,,,c  23   * intransitive action verb exceeds goto list,,,,,,,,,,,,,,,,,,,,c  24     transitive action verb exceeds goto list,,,,,,,,,,,,,,,,,,,,c  25   * conditional travel entry with no alternative,,,,,,,,,,,,,,,,,,,,c  26   * location has no travel entries,,,,,,,,,,,,,,,,,,,,c  27   * hint number exceeds goto list,,,,,,,,,,,,,,,,,,,,c  28     invalid month returned by date function,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      write (*,1) num",,,,,,,,,,,,,,,,,,,," 1    format (' Fatal error, see source code for interpretation.'/",,,,,,,,,,,,,,,,,,,,     . ' Probable cause:  erroneous info in database.'/,,,,,,,,,,,,,,,,,,,,"     2 ' Error code =',i2/)",,,,,,,,,,,,,,,,,,,,      pause 'To Exit From Adventure',,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine getin (word1,word1x,word2,word2x)",,,,,,,,,,,,,,,,,,,,"c  get a command from the adventurer.  snarf out the first word, pad it",,,,,,,,,,,,,,,,,,,,"c  with blanks, and return in word1--word1x used for overflow charcters",,,,,,,,,,,,,,,,,,,,c  5-8 in case we need to print the whole word back out in an error.,,,,,,,,,,,,,,,,,,,,c  any number of blanks may follow the word.  if a second word appears,,,,,,,,,,,,,,,,,,,,"c  it is returned in word2/word2x, else word2 is set to zero.  all are",,,,,,,,,,,,,,,,,,,,c  converted to lower case for comparison ease (ibm pc version).,,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /blkcom/ blklin,,,,,,,,,,,,,,,,,,,,"      character*1 s(20), t(20)",,,,,,,,,,,,,,,,,,,,"      character*4 word1, word1x, word2, word2x, w1(5), w2(5), a(5)",,,,,,,,,,,,,,,,,,,,"      character*20 w81, w82, aa, bb",,,,,,,,,,,,,,,,,,,,"      integer*4 iw1, iw1x, iw2, iw2x",,,,,,,,,,,,,,,,,,,,"      equivalence (w1(1),iw1),(w1(2),iw1x),(a,aa)",,,,,,,,,,,,,,,,,,,,"      equivalence (w2(1),iw2),(w2(2),iw2x),(w81,w1),(w82,w2)",,,,,,,,,,,,,,,,,,,,"      if (blklin.eq.1) write (*,1)",,,,,,,,,,,,,,,,,,,,1     format (1x),,,,,,,,,,,,,,,,,,,,c  give a prompt to make him think we want input,,,,,,,,,,,,,,,,,,,,"      write (*,9)",,,,,,,,,,,,,,,,,,,,"9     format ('   -> ',\)",,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,c  read twenty characters into a.  unpack them into s.,,,,,,,,,,,,,,,,,,,,"      read (*,3) a",,,,,,,,,,,,,,,,,,,,3     format (5a4),,,,,,,,,,,,,,,,,,,,      bb = aa,,,,,,,,,,,,,,,,,,,,"      call unpack (bb, s)",,,,,,,,,,,,,,,,,,,,c  translate all to lower case,,,,,,,,,,,,,,,,,,,,"      do 1001 i=1,20",,,,,,,,,,,,,,,,,,,,      if (ichar(s(i)).lt.65.or.ichar(s(i)).gt.90) go to 1001,,,,,,,,,,,,,,,,,,,,      s(i)=char(ichar(s(i))+32),,,,,,,,,,,,,,,,,,,,1001  continue,,,,,,,,,,,,,,,,,,,,"c  go through the characters and transfer the first word into t, up",,,,,,,,,,,,,,,,,,,,c  to eight characters,,,,,,,,,,,,,,,,,,,,"      do 10 i=1,20",,,,,,,,,,,,,,,,,,,,10    t(i)=' ',,,,,,,,,,,,,,,,,,,,"      do 11 i=1,8",,,,,,,,,,,,,,,,,,,,      if (s(i).eq.' ') go to 20,,,,,,,,,,,,,,,,,,,,11    t(i)=s(i),,,,,,,,,,,,,,,,,,,,"c  now repack the characters into w81, equivalent to word1,word1x",,,,,,,,,,,,,,,,,,,,"20    call pack (w81,t)",,,,,,,,,,,,,,,,,,,,      word1=w1(1),,,,,,,,,,,,,,,,,,,,      word1x=w1(2),,,,,,,,,,,,,,,,,,,,c  now find a second word if one exists--clear return words first,,,,,,,,,,,,,,,,,,,,      iw2=0,,,,,,,,,,,,,,,,,,,,      iw2x=0,,,,,,,,,,,,,,,,,,,,"      do 30 i=1,20",,,,,,,,,,,,,,,,,,,,30    t(i)=' ',,,,,,,,,,,,,,,,,,,,"      do 31 i=1,20",,,,,,,,,,,,,,,,,,,,      if (s(i).ne.' ') go to 31,,,,,,,,,,,,,,,,,,,,      go to 32,,,,,,,,,,,,,,,,,,,,31    continue,,,,,,,,,,,,,,,,,,,,c  all characters--fooey,,,,,,,,,,,,,,,,,,,,      go to 40,,,,,,,,,,,,,,,,,,,,c  hit first blank after first word--now get first non-blank,,,,,,,,,,,,,,,,,,,,"32    do 33 j=i,20",,,,,,,,,,,,,,,,,,,,      if (s(j).eq.' ') go to 33,,,,,,,,,,,,,,,,,,,,      go to 34,,,,,,,,,,,,,,,,,,,,33    continue,,,,,,,,,,,,,,,,,,,,c  blanked out again,,,,,,,,,,,,,,,,,,,,      go to 40,,,,,,,,,,,,,,,,,,,,c  hit beginning of second word--finish it,,,,,,,,,,,,,,,,,,,,"34    do 35 i=j,20",,,,,,,,,,,,,,,,,,,,      if (s(i).eq.' ') go to 36,,,,,,,,,,,,,,,,,,,,35    t(i-j+1)=s(i),,,,,,,,,,,,,,,,,,,,c  now repack word2/2x,,,,,,,,,,,,,,,,,,,,"36    call pack (w82,t)",,,,,,,,,,,,,,,,,,,,40    word2=w2(1),,,,,,,,,,,,,,,,,,,,      word2x=w2(2),,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      subroutine unpack (b, s)",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,c   unpack general subroutine,,,,,,,,,,,,,,,,,,,,c  b  20 character string,,,,,,,,,,,,,,,,,,,,c  s  20 character*1 singles,,,,,,,,,,,,,,,,,,,,"      character*20 a,b",,,,,,,,,,,,,,,,,,,,      character*4 aa(5),,,,,,,,,,,,,,,,,,,,      integer*4 ia(5),,,,,,,,,,,,,,,,,,,,"      equivalence (ia,a,aa)",,,,,,,,,,,,,,,,,,,,      character*1 s(20),,,,,,,,,,,,,,,,,,,,      a = b,,,,,,,,,,,,,,,,,,,,"      do 1 k = 1,5",,,,,,,,,,,,,,,,,,,,"      do 1 j = 1,4",,,,,,,,,,,,,,,,,,,,      s(4*(k-1)+j)=aa(k),,,,,,,,,,,,,,,,,,,,1     if(j.ne.4)ia(k)=ia(k)/256,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,"      subroutine pack (b, t)",,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,c   general pack subroutine--20 characters,,,,,,,,,,,,,,,,,,,,c   b  return packed word--20,,,,,,,,,,,,,,,,,,,,c   t  array to pack of char*1's,,,,,,,,,,,,,,,,,,,,"      character*20 a,b",,,,,,,,,,,,,,,,,,,,      integer*4 ia(5),,,,,,,,,,,,,,,,,,,,"      equivalence (ia,a)",,,,,,,,,,,,,,,,,,,,"      character*1 s(20),t(20)",,,,,,,,,,,,,,,,,,,,"      do 95 i = 1,20",,,,,,,,,,,,,,,,,,,,95      s(i)=t(i),,,,,,,,,,,,,,,,,,,,"      do 1 k = 1,5",,,,,,,,,,,,,,,,,,,,      ia(6-k)=0,,,,,,,,,,,,,,,,,,,,"      do 1 j = 1, 4",,,,,,,,,,,,,,,,,,,,      l=4*(5-k)+5-j,,,,,,,,,,,,,,,,,,,,      ia(6-k) = ia(6-k) + ichar (s(l)),,,,,,,,,,,,,,,,,,,,1     if (j.ne.4) ia(6-k) = ia(6-k) * 256,,,,,,,,,,,,,,,,,,,,      b=a,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function toting(obj),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      toting=0,,,,,,,,,,,,,,,,,,,,      if (place(obj).eq.-1) toting=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function here(obj),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,      common /loccom/ loc,,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      here=0,,,,,,,,,,,,,,,,,,,,      if (place(obj).eq.loc.or.toting(obj).eq.1) here=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function at(obj),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,"      common /placom/ atloc,link,place,fixed,holdng",,,,,,,,,,,,,,,,,,,,      common /loccom/ loc,,,,,,,,,,,,,,,,,,,,"      dimension atloc(150),link(200),place( 100),fixed(100)",,,,,,,,,,,,,,,,,,,,      at=0,,,,,,,,,,,,,,,,,,,,      if (place(obj).eq.loc.or.fixed(obj).eq.loc) at=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function forced(loc),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /concom/ cond,,,,,,,,,,,,,,,,,,,,      dimension cond (150),,,,,,,,,,,,,,,,,,,,      forced=0,,,,,,,,,,,,,,,,,,,,      if (cond(loc).eq.2) forced=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function dark(dummy),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      common /concom/ cond,,,,,,,,,,,,,,,,,,,,      common /loccom/ loc,,,,,,,,,,,,,,,,,,,,"      common /procom/ prop, lamp",,,,,,,,,,,,,,,,,,,,"      dimension cond(150),prop(100)",,,,,,,,,,,,,,,,,,,,      external here,,,,,,,,,,,,,,,,,,,,      dark=0,,,,,,,,,,,,,,,,,,,,"      if (mod(cond(loc),2).eq.0 .and. (prop(lamp).eq.0 .or.",,,,,,,,,,,,,,,,,,,,     .  here(lamp).eq.0)) dark=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,c,,,,,,,,,,,,,,,,,,,,      integer*2 function pct(n),,,,,,,,,,,,,,,,,,,,      implicit integer*2 (a-z),,,,,,,,,,,,,,,,,,,,      external ran,,,,,,,,,,,,,,,,,,,,      pct=0,,,,,,,,,,,,,,,,,,,,      if (ran(100).lt.n) pct=1,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      subroutine datime (daye,t)",,,,,,,,,,,,,,,,,,,,c   d is date as number of days (more or less) after jan 1 77,,,,,,,,,,,,,,,,,,,,c   t is time as number of minutes past midnight,,,,,,,,,,,,,,,,,,,,      implicit integer*4 (a-z),,,,,,,,,,,,,,,,,,,,"      call getdat(year,month,day)",,,,,,,,,,,,,,,,,,,,"      call gettim(hour,minute,second,hndrth)",,,,,,,,,,,,,,,,,,,,      t=minute+60*hour,,,,,,,,,,,,,,,,,,,,      daye=(year-77)*365+((month-1)*30)+day,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      integer*2 function ran(range),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"c  since the ran function in lib40 seems to be a real lose, we'll use one of",,,,,,,,,,,,,,,,,,,,c  our own.  it's been run through many of the tests in knuth vol. 2 and,,,,,,,,,,,,,,,,,,,,c  seems to be quite reliable.  ran returns a value uniformly selected,,,,,,,,,,,,,,,,,,,,c  between 0 and range-1.  note resemblance to alg used in wizard.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      implicit integer*4 (a-z),,,,,,,,,,,,,,,,,,,,      integer*2 range,,,,,,,,,,,,,,,,,,,,      data r/-1/,,,,,,,,,,,,,,,,,,,,      d=1,,,,,,,,,,,,,,,,,,,,      if(r.ne.-1)goto 1,,,,,,,,,,,,,,,,,,,,"      call datime(d,t)",,,,,,,,,,,,,,,,,,,,      r=18*t+5,,,,,,,,,,,,,,,,,,,,"      d=1000+mod(d,1000)",,,,,,,,,,,,,,,,,,,," 1    do 2 t=1,d",,,,,,,,,,,,,,,,,,,," 2    r=mod(r*1021,1048576)",,,,,,,,,,,,,,,,,,,,      rn=(range*r)/1048576,,,,,,,,,,,,,,,,,,,,      ran=rn,,,,,,,,,,,,,,,,,,,,      return,,,,,,,,,,,,,,,,,,,,      end,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,c  ======= end =======,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      ELSEIF (OBJ.EQ.GRATE) THEN,,,,,,,,,,,,,,,,,,,,         IF (.NOT.ATHAND(KEYS)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         PROP(GRATE)=0,,,,,,,,,,,,,,,,,,,,         SPK=35,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     SAFE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      ELSE,,,,,,,,,,,,,,,,,,,,         PROP(SAFE)=0,,,,,,,,,,,,,,,,,,,,         SPK=367,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      OBJCON(OBJ)=IBSET(OBJCON(OBJ),LOCKBT)",,,,,,,,,,,,,,,,,,,,"      OBJCON(OBJ)=IBCLR(OBJCON(OBJ),OPENBT)",,,,,,,,,,,,,,,,,,,,      GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     UNLOCK CHAIN, GRATE, CHEST, ELFIN DOOR",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25000 SPK=55,,,,,,,,,,,,,,,,,,,,      IF (OBJ.EQ.KEYS.OR.OBJ.EQ.SKEY) GO TO 2011,,,,,,,,,,,,,,,,,,,,      IF (.NOT.HINGED(OBJ)) GO TO 24900,,,,,,,,,,,,,,,,,,,,      SPK=375,,,,,,,,,,,,,,,,,,,,      IF (.NOT.LOCKED(OBJ)) SPK=37,,,,,,,,,,,,,,,,,,,,      IF (.NOT.LOCKS(OBJ)) SPK=32,,,,,,,,,,,,,,,,,,,,      IF (OBJ.EQ.SAFE) SPK=342,,,,,,,,,,,,,,,,,,,,      IF (OBJ.EQ.SAFE.AND.(IOBJ.EQ.KEYS.OR.IOBJ.EQ.SKEY)) SPK=368,,,,,,,,,,,,,,,,,,,,      IF (.NOT.(ATHAND(KEYS).OR.ATHAND(SKEY).OR.OBJ.EQ.SAFE)) SPK=31,,,,,,,,,,,,,,,,,,,,      IF (SPK.NE.375) GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     CHAIN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      IF (OBJ.EQ.CHAIN)THEN,,,,,,,,,,,,,,,,,,,,         IF (.NOT.ATHAND(KEYS)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         SPK=171,,,,,,,,,,,,,,,,,,,,         IF (PROP(BEAR).EQ.0) SPK=41,,,,,,,,,,,,,,,,,,,,         IF (SPK.NE.171) GO TO 2011,,,,,,,,,,,,,,,,,,,,         PROP(CHAIN)=0,,,,,,,,,,,,,,,,,,,,         FIXED(CHAIN)=0,,,,,,,,,,,,,,,,,,,,         IF (PROP(BEAR).NE.3) PROP(BEAR)=2,,,,,,,,,,,,,,,,,,,,         FIXED(BEAR)=2-PROP(BEAR),,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     CHEST,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      ELSEIF (OBJ.EQ.CHEST) THEN,,,,,,,,,,,,,,,,,,,,         IF (.NOT.ATHAND(KEYS)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         SPK=333,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     ELFIN DOOR.  LOCK/UNLOCK TINY DOOR W/SPECIAL KEY. THE DAMN THING IS REALLY AT FOUR PLACES, AND WE WANT THE RIGHT",,,,,,,,,,,,,,,,,,,,!     MESSAGES IF ADVENTURER ONLY HAS 'BIG' KEYS OR NO KEYS.  CAN UNLOCK WHILE BIG OR SMALL.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      ELSEIF (OBJ.EQ.TDOOR.OR.OBJ.EQ.TDOOR2) THEN,,,,,,,,,,,,,,,,,,,,         SPK=224,,,,,,,,,,,,,,,,,,,,         IF (.NOT.ATHAND(SKEY)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         IF (CLOSNG) GO TO 25060,,,,,,,,,,,,,,,,,,,,         PROP(TDOOR)=1,,,,,,,,,,,,,,,,,,,,         PROP(TDOOR2)=1,,,,,,,,,,,,,,,,,,,,         SPK=234+2*PROP(TDOOR)+(TDOOR2-OBJ),,,,,,,,,,,,,,,,,,,,         K=TDOOR+(TDOOR2-OBJ),,,,,,,,,,,,,,,,,,,,"         OBJCON(K)=IBCLR(OBJCON(K),LOCKBT)",,,,,,,,,,,,,,,,,,,,"         OBJCON(K)=IBSET(OBJCON(K),OPENBT)",,,,,,,,,,,,,,,,,,,,      ELSE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!        GRATE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,         IF (.NOT.ATHAND(KEYS)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         IF (CLOSNG) GO TO 25060,,,,,,,,,,,,,,,,,,,,         PROP(GRATE)=1,,,,,,,,,,,,,,,,,,,,         SPK=36,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      OBJCON(OBJ)=IBCLR(OBJCON(OBJ),LOCKBT)",,,,,,,,,,,,,,,,,,,,"      OBJCON(OBJ)=IBSET(OBJCON(OBJ),OPENBT)",,,,,,,,,,,,,,,,,,,,      GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     CLOSING.  NO EXIT THIS WAY.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25060 SPK=130,,,,,,,,,,,,,,,,,,,,      IF (.NOT.PANIC) CLOCK2=15,,,,,,,,,,,,,,,,,,,,      PANIC=.TRUE.,,,,,,,,,,,,,,,,,,,,      GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     HEALTH.  GIVE A DIAGNOSIS.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"25100 IF (HEALTH.LT.100) WRITE(*,""(/' You''re health rating is ',I0,' out of a possible 100.')"") HEALTH",,,,,,,,,,,,,,,,,,,,      IF (PCT(50)) SPK=349,,,,,,,,,,,,,,,,,,,,      IF (HEALTH.LT.95) SPK=381 + (100-HEALTH)/20,,,,,,,,,,,,,,,,,,,,      GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     LOOK. PRETEND NOT DARK SO WON'T FALL INTO A PIT WHILE STARING INTO THE GLOOM.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25200 IF (OBJ.NE.0) GO TO 2060,,,,,,,,,,,,,,,,,,,,      IF (IOBJ.NE.0) GO TO 25210,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25201 IF (DETAIL.LT.3) CALL SPEAK(RTEXT(15)),,,,,,,,,,,,,,,,,,,,      DETAIL=DETAIL+1,,,,,,,,,,,,,,,,,,,,      WASDARK=.FALSE.,,,,,,,,,,,,,,,,,,,,      ABB(LOC)=0,,,,,,,,,,,,,,,,,,,,      NEWLOC=LOC,,,,,,,,,,,,,,,,,,,,      GO TO 2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     LOOK INTO SOMETHING (A CONTAINER).,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25210 IF (VESSEL(IOBJ)) THEN,,,,,,,,,,,,,,,,,,,,         IF (.NOT.AJAR(IOBJ).AND.OPAQUE(IOBJ)) GO TO 2011,,,,,,,,,,,,,,,,,,,,         SPK=359,,,,,,,,,,,,,,,,,,,,         IF (HOLDER(IOBJ).EQ.0) GO TO 2011,,,,,,,,,,,,,,,,,,,,"         WRITE(*,""(1X)"")",,,,,,,,,,,,,,,,,,,,         CALL LOOKIN(IOBJ),,,,,,,,,,,,,,,,,,,,         GO TO 2100,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     LOOK AT SOMETHING.  IF WRITTEN, READ IT.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      IF (PRINTD(IOBJ)) THEN,,,,,,,,,,,,,,,,,,,,         OBJ=IOBJ,,,,,,,,,,,,,,,,,,,,         IOBJ=0,,,,,,,,,,,,,,,,,,,,         GO TO 22700,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      IF (IOBJ.NE.SPHERE) GO TO 25201,,,,,,,,,,,,,,,,,,,,      IF (INSIDE(LOC).AND.(.NOT.ATHAND(SAPPHI))) THEN,,,,,,,,,,,,,,,,,,,,         CALL SPEAK(RTEXT(400)),,,,,,,,,,,,,,,,,,,,"         WRITE(*,""(1X)"")",,,,,,,,,,,,,,,,,,,,         SLOC=PLACE(SAPPHI),,,,,,,,,,,,,,,,,,,,"         IF ((MOD(LOCCON(SLOC),2).EQ.0.OR.ENCLSD(SAPPHI)).AND.SLOC.NE.200.AND..NOT.(PLACE(LAMP).EQ.SLOC.AND.PROP(LAMP).NE.0)) THEN",,,,,,,,,,,,,,,,,,,,             CALL SPEAK(RTEXT(401)),,,,,,,,,,,,,,,,,,,,         ELSE,,,,,,,,,,,,,,,,,,,,            CALL SPEAK(LTEXT(SLOC)),,,,,,,,,,,,,,,,,,,,            IF (SLOC.EQ.239.AND.FLG239.EQ.0) THEN,,,,,,,,,,,,,,,,,,,,               CALL SPEAK(RTEXT(403)),,,,,,,,,,,,,,,,,,,,               FLG239=1,,,,,,,,,,,,,,,,,,,,            ENDIF,,,,,,,,,,,,,,,,,,,,         ENDIF,,,,,,,,,,,,,,,,,,,,"         WRITE(*,""(1X)"")",,,,,,,,,,,,,,,,,,,,         CALL SPEAK(RTEXT(402)),,,,,,,,,,,,,,,,,,,,      ELSE,,,,,,,,,,,,,,,,,,,,         CALL SPEAK(RTEXT(42)),,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      GO TO 2100,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     COMBO: TRYING TO OPEN SAFE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25300 IF (.NOT.AT(SAFE)) GO TO 2060,,,,,,,,,,,,,,,,,,,,"      K=VOCABX(VTXT(VRBX),4)-10",,,,,,,,,,,,,,,,,,,,      SPK=42,,,,,,,,,,,,,,,,,,,,      IF (COMBO.NE.1-K) THEN,,,,,,,,,,,,,,,,,,,,         IF (COMBO.NE.0) SPK=366,,,,,,,,,,,,,,,,,,,,         GO TO 2011,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      COMBO=K,,,,,,,,,,,,,,,,,,,,      SPK=371,,,,,,,,,,,,,,,,,,,,      IF (K.NE.3) GO TO 2011,,,,,,,,,,,,,,,,,,,,      COMBO=0,,,,,,,,,,,,,,,,,,,,"      OBJCON(SAFE)=IBCLR(OBJCON(SAFE),LOCKBT)",,,,,,,,,,,,,,,,,,,,"      OBJCON(SAFE)=IBSET(OBJCON(SAFE),OPENBT)",,,,,,,,,,,,,,,,,,,,      PROP(SAFE)=1,,,,,,,,,,,,,,,,,,,,      SPK=365,,,,,,,,,,,,,,,,,,,,      IF (PROP(BOOK).GE.0) GO TO 2011,,,,,,,,,,,,,,,,,,,,      TALLY=TALLY-1,,,,,,,,,,,,,,,,,,,,      PROP(BOOK)=0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     IF REMAINING TREASURES TOO ELUSIVE, ZAP LAMP. THIS COPIES SOME CODE LOCATED AROUND LABEL 2000.  MUST BE DONE",,,,,,,,,,,,,,,,,,,,!     HERE SINCE BOOK IS CONTAINED IN SAFE & TALLY STUFF ONLY WORKS FOR THINGS DEPOSITED AT A LOC.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      IF (TALLY.EQ.TALLY2.AND.TALLY.NE.0) LIMIT=MIN0(35,LIMIT)",,,,,,,,,,,,,,,,,,,,      GO TO 2011,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     DUST/SWEEP,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25400 IF (.NOT.ATHAND(BRUSH)) SPK=342,,,,,,,,,,,,,,,,,,,,      IF (AT(CARVNG).AND.ATHAND(BRUSH).AND.PROP(CARVNG).NE.1) THEN,,,,,,,,,,,,,,,,,,,,         PROP(CARVNG)=1,,,,,,,,,,,,,,,,,,,,         CALL SPEAK(RTEXT(363)),,,,,,,,,,,,,,,,,,,,         SPK=372,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      GO TO 2011 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     TERSE/UNTERSE.  SUPRESS ALL LONG-FORM DESCRIPTIONS.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25500 TERSE=.NOT.TERSE,,,,,,,,,,,,,,,,,,,,      DETAIL=3,,,,,,,,,,,,,,,,,,,,      GO TO 2009,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     COMMENT THE FOLLOWING LINE TO DEACTIVATE WIZARD MODE,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25600 ISWIZ = .TRUE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25800 IF (ISWIZ) THEN,,,,,,,,,,,,,,,,,,,,"         WRITE(*,""('CURRENT LOCATION IS ',I0)"") LOC",,,,,,,,,,,,,,,,,,,,"         WRITE(*,""('LOCATION ? ',$)"")",,,,,,,,,,,,,,,,,,,,"         READ (*,""(I4)"",ERR=25800) GATLOC",,,,,,,,,,,,,,,,,,,,         IF ((GATLOC.GT.0).AND.(GATLOC.LE.MAXLOC)) THEN,,,,,,,,,,,,,,,,,,,,            LOC=GATLOC,,,,,,,,,,,,,,,,,,,,            CALL COLOR(LOC),,,,,,,,,,,,,,,,,,,,         ENDIF,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      DETAIL=3,,,,,,,,,,,,,,,,,,,,      GO TO 25200    !GO LOOK,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25900 IF (ISWIZ) THEN,,,,,,,,,,,,,,,,,,,,"         WRITE(*,""(' DWARVES ARE AT LOCATIONS',5I4,' PIRATE IS AT LOCATION ',I0,/' CLOCKS ARE',3I3, ' TALLY ',I0)"") &",,,,,,,,,,,,,,,,,,,,"                     DLOC,CLOCK1,CLOCK2,CLOCK3,TALLY",,,,,,,,,,,,,,,,,,,,      ELSE,,,,,,,,,,,,,,,,,,,,         SPK=345,,,,,,,,,,,,,,,,,,,,         GO TO 2011,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      GO TO 2009,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     HINTS,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     COME HERE IF ADVENTURE'S BEEN LONG ENOUGH AT REQUIRED LOC(S) FOR SOME UNUSED HINT.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,40000 HINTLC(HINT)=0    !RESET LOCATION TIME,,,,,,,,,,,,,,,,,,,,      SELECT CASE ((HINT+1-HNTMIN)),,,,,,,,,,,,,,,,,,,,         CASE (1)               !MAZE,,,,,,,,,,,,,,,,,,,,            IF (ATLOC(LOC).EQ.0.AND.ATLOC(OLDLOC).EQ.0.AND.ATLOC(OLDLC2).EQ.0.AND.BURDEN(0).GT.1) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (2)               !DARK,,,,,,,,,,,,,,,,,,,,            IF (PROP(EMRALD).NE.-1.AND.PROP(PYRAM).EQ.-1) GO TO 40010,,,,,,,,,,,,,,,,,,,,"         CASE (3,5,12); GO TO 40010  !WITT'S END, SLIDE, GRATE",,,,,,,,,,,,,,,,,,,,         CASE (4)               !SWORD,,,,,,,,,,,,,,,,,,,,            IF ( (PROP(SWORD).EQ.1.OR.PROP(SWORD).EQ.5).AND..NOT.TOTING(CROWN)) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (6)               !CAVE1,,,,,,,,,,,,,,,,,,,,            IF (PROP(GRATE).EQ.0.AND..NOT.ATHAND(KEYS)) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (7)               !BIRD,,,,,,,,,,,,,,,,,,,,            IF (HERE(BIRD).AND.ATHAND(ROD).AND.OBJ.EQ.BIRD) GO TO 40010,,,,,,,,,,,,,,,,,,,,            GO TO 2602,,,,,,,,,,,,,,,,,,,,         CASE (8)               !CAVE2,,,,,,,,,,,,,,,,,,,,            IF (ABB(159).EQ.0) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (9)               !RAINBOW,,,,,,,,,,,,,,,,,,,,            IF (.NOT.TOTING(SHOES).OR.ABB(205).EQ.0) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (10)              !SNAKE,,,,,,,,,,,,,,,,,,,,            IF (.NOT.ATHAND(LYRE).AND.PROP(DOG).NE.1) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE (11)              !STYX,,,,,,,,,,,,,,,,,,,,            IF (HERE(SNAKE).AND..NOT.HERE(BIRD)) GO TO 40010,,,,,,,,,,,,,,,,,,,,         CASE DEFAULT,,,,,,,,,,,,,,,,,,,,"         WRITE(LASTSAVE,""(' TRYING TO PRINT HINT # ',I0,/)"") HINT",,,,,,,,,,,,,,,,,,,,         CALL BUG(LASTSAVE),,,,,,,,,,,,,,,,,,,,      END SELECT,,,,,,,,,,,,,,,,,,,,      GO TO 2602,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"40010 IF (YES(HINTS(HINT,3),0,54)) THEN",,,,,,,,,,,,,,,,,,,,"         WRITE(*,""(/' I am prepared to give you a hint, but it will cost you ',I0,' points.')"") HINTS(HINT,2)",,,,,,,,,,,,,,,,,,,,"         HINTED(HINT)=YES(175,HINTS(HINT,4),54)",,,,,,,,,,,,,,,,,,,,"         IF (HINTED(HINT).AND.LIMIT.GT.30) LIMIT=LIMIT+30*HINTS(HINT,2)",,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      GO TO 2602,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     CAVE CLOSING AND SCORING,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     CAVE CLOSES ""CLOCK1"" TURNS AFTER LAST TREASURE IS LOCATED, INCLUDING THE PIRATE'S CHEST, WHICH MAY NEVER SHOW UP. TREASURES",,,,,,,,,,,,,,,,,,,,"!     NEED NOT BE TAKEN YET, JUST LOCATED.  HENCE CLOCK1 MUST BE LARGE ENOUGH TO GET OUT OF THE CAVE (IT ONLY TICKS WHILE INSIDE THE",,,,,,,,,,,,,,,,,,,,"!     CAVE). WHEN IT HITS ZERO, BRANCH TO 90000 TO START CLOSING THE CAVE. AFTER CLOCK2 TURNS, CLOSE THE CAVE. IF ADVENTURER TRIES",,,,,,,,,,,,,,,,,,,,"!     TO GET OUT, ASSUME PANICS AND GIVE A FEW ADDITIONAL TURNS TO GET FRANTIC BEFORE CLOSING. WHEN CLOCK2 HITS ZERO BRANCH TO",,,,,,,,,,,,,,,,,,,,"!     90000 TO TRANSPORT ADVENTURER INTO THE FINAL PUZZLE, SEPARATING ADVENTURER FROM ALL TREASURES. THE PUZZLE DEPENDS UPON ALL",,,,,,,,,,,,,,,,,,,,"!     SORTS OF RANDOM THINGS.  FOR INSTANCE, THERE MUST BE NO WATER OR OIL, SINCE THERE ARE BEANSTALKS WE DON'T WANT TO BE ABLE TO",,,,,,,,,,,,,,,,,,,,!     WATER AND THE CODE CAN'T HANDLE IT. WE CAN HAVE NO KEYS SINCE THERE IS A GRATE. MOST OF THESE PROBLEMS ARISE FROM THE USE OF,,,,,,,,,,,,,,,,,,,,!     NEGATIVE PROP NUMBERS TO SUPPRESS THE OBJECT DESCRIPTIONS UNTIL ADVENTURER ACTUALLY MOVED THEM.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     WHEN THE FIRST WARNING COMES, LOCK THE GRATE, DESTROY THE BRIDGE, KILL THE DWARVES AND PIRATE, REMOVE TROLL AND BEAR UNLESS",,,,,,,,,,,,,,,,,,,,"!     DEAD, AND SET ""CLOSNG"" TO TRUE.  LEAVE THE DRAGON; TOO MUCH TROUBLE TO MOVE IT. FROM NOW UNTIL CLOCK2 RUNS OUT CAN'T UNLOCK",,,,,,,,,,,,,,,,,,,,"!     GRATE, MOVE TO ANY LOCATION OUTSIDE THE CAVE, OR CREATE THE BRIDGE.  NOT RESURRECTED IF DIES.  SNAKE IS ALREADY GONE, SINCE",,,,,,,,,,,,,,,,,,,,"!     GOT TO THE TREASURE ACCESSIBLE ONLY VIA THE HALL OF THE MT. KING. ALSO, ADVENTURE'S BEEN IN GIANT ROOM TO GET EGGS, SO WE CAN",,,,,,,,,,,,,,,,,,,,!     REFER TO IT.  GOT THE PEARL SO KNOWS BIVALVE IS AN OYSTER AND THE DWARVES ARE ACTIVATED SINCE WE FOUND CHEST.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,90000 PROP(GRATE)=0,,,,,,,,,,,,,,,,,,,,      PROP(FISSUR)=0,,,,,,,,,,,,,,,,,,,,      PROP(TDOOR)=0,,,,,,,,,,,,,,,,,,,,      PROP(TDOOR2)=0,,,,,,,,,,,,,,,,,,,,      DSEEN=.FALSE.     !SET ALL DWARVES AND PIRATE TO NOT SEEN,,,,,,,,,,,,,,,,,,,,      DLOC=0            !SET LOCATIONS OF ALL DWARVES AND PIRATE TO 0,,,,,,,,,,,,,,,,,,,,"      CALL MOVE(TROLL,0)",,,,,,,,,,,,,,,,,,,,"      CALL MOVE(TROLL+MAXOBJ,0)",,,,,,,,,,,,,,,,,,,,"      CALL MOVE(TROLL2,PLAC(TROLL))",,,,,,,,,,,,,,,,,,,,"      CALL MOVE(TROLL2+MAXOBJ,FIXD(TROLL))",,,,,,,,,,,,,,,,,,,,      CALL JUGGLE(CHASM),,,,,,,,,,,,,,,,,,,,      IF (PROP(BEAR).NE.3) CALL DESTROY(BEAR),,,,,,,,,,,,,,,,,,,,      PROP(CHAIN)=0,,,,,,,,,,,,,,,,,,,,      FIXED(CHAIN)=0,,,,,,,,,,,,,,,,,,,,      PROP(AXE)=0,,,,,,,,,,,,,,,,,,,,      FIXED(AXE)=0,,,,,,,,,,,,,,,,,,,,      CALL SPEAK(RTEXT(129)),,,,,,,,,,,,,,,,,,,,      CLOCK1=-1,,,,,,,,,,,,,,,,,,,,      CLOSNG=.TRUE.,,,,,,,,,,,,,,,,,,,,      GO TO 19999,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     ONCE ADVENTURER'S PANICKED AND CLOCK2 RUNS OUT, COME HERE TO SET UP STORAGE ROOM. THE ROOM HAS TWO LOCS, HARDWIRED AS 115 (NE)",,,,,,,,,,,,,,,,,,,,"!     AND 116 (SW).  AT NE END, PLACE EMPTY BOTTLES, A NURSERY OF PLANTS, BED OF OYSTERS, PILE OF LAMPS, RODS, AND STARS, SLEEPING",,,,,,,,,,,,,,,,,,,,"!     DWARVES, PHONE BOOTH AND AT THE SW END WE PLACE GRATE OVER TREASURES, SNAKE PIT, COVEY OF CAGED BIRDS, PILLOWS.  A MIRROR ",,,,,,,,,,,,,,,,,,,,!     STRETCHES ACROSS ONE WALL. MANY OF THE OBJECTS COME FROM KNOWN LOCATIONS AND/OR STATES (E.G. SNAKE IS KNOWN TO BE DESTROYED,,,,,,,,,,,,,,,,,,,,"!     AND NEEDN'T BE CARRIED AWAY FROM ITS OLD ""PLACE""), MAKING THE VARIOUS OBJECTS BE HANDLED DIFFERENTLY. DROP ALL OTHER OBJECTS",,,,,,,,,,,,,,,,,,,,"!     THAT MIGHT BE CARRIED LEST THERE SOME WHICH COULD CAUSE TROUBLE, SUCH AS THE AS THE KEYS. DESCRIBE THE FLASH OF LIGHT AND",,,,,,,,,,,,,,,,,,,,"!     TRUNDLE BACK. THE PHONE MAKES IT IMPOSSIBLE FOR ADVENTURER TO DINK AROUND THE REPOSITORY TOO LONG. WHEN CLOCK3 TICKS TO ZERO, ",,,,,,,,,,,,,,,,,,,,"!     PHONE STARTS RINGING;  WHEN IT HITS -7, DWARVES WAKE UP. IF ADVENTURER FIDDLES WITH THE PHONE, GETS ZONKED IN OTHER WAYS.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"91000 PROP(BOTTLE)=PUT(BOTTLE,115,1)",,,,,,,,,,,,,,,,,,,,"      PROP(PLANT)=PUT(PLANT,115,0)",,,,,,,,,,,,,,,,,,,,"      PROP(OYSTER)=PUT(OYSTER,115,0)",,,,,,,,,,,,,,,,,,,,"      PROP(LAMP)=PUT(LAMP,115,0)",,,,,,,,,,,,,,,,,,,,"      PROP(ROD)=PUT(ROD,115,0)",,,,,,,,,,,,,,,,,,,,"      PROP(DWARF)=PUT(DWARF,115,0)",,,,,,,,,,,,,,,,,,,,      LOC=115,,,,,,,,,,,,,,,,,,,,      OLDLOC=115,,,,,,,,,,,,,,,,,,,,      NEWLOC=115,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     LEAVE THE GRATE WITH NORMAL (NON-NEGATIVE PROPERTY).,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      FOO=PUT(GRATE,116,0)",,,,,,,,,,,,,,,,,,,,"      PROP(SNAKE)=PUT(SNAKE,116,1)",,,,,,,,,,,,,,,,,,,,"      PROP(BIRD)=PUT(BIRD,116,1)",,,,,,,,,,,,,,,,,,,,"      PROP(CAGE)=PUT(CAGE,116,0)",,,,,,,,,,,,,,,,,,,,"      PROP(ROD2)=PUT(ROD2,116,0)",,,,,,,,,,,,,,,,,,,,"      PROP(PILLOW)=PUT(PILLOW,116,0)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      PROP(BOOTH)=PUT(BOOTH,116,-4)",,,,,,,,,,,,,,,,,,,,      FIXED(BOOTH)=115,,,,,,,,,,,,,,,,,,,,"      PROP(PHONE)=PUT(PHONE,212,-4)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      PROP(MIRROR)=PUT(MIRROR,115,0)",,,,,,,,,,,,,,,,,,,,"      PROP(BOOK2)=PUT(BOOK2,115,0)",,,,,,,,,,,,,,,,,,,,      FIXED(MIRROR)=116,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      DO I=1,MAXOBJ",,,,,,,,,,,,,,,,,,,,         IF (TOTING(I).AND.ENCLSD(I)) CALL REMOVE(I),,,,,,,,,,,,,,,,,,,,         IF (TOTING(I)) CALL DESTROY(I),,,,,,,,,,,,,,,,,,,,      END DO,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      CALL SPEAK(RTEXT(132)),,,,,,,,,,,,,,,,,,,,      CALL WAIT(10.),,,,,,,,,,,,,,,,,,,,      CALL POOF(0),,,,,,,,,,,,,,,,,,,,      CLOSED=.TRUE.,,,,,,,,,,,,,,,,,,,,      GO TO 2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     DISTURBED THE DWARVES.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,93000 CALL SPEAK(RTEXT(136)),,,,,,,,,,,,,,,,,,,,      GO TO 95000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     HIT THE PHONE.  JINGLE, JANGLE, CRASH!",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,93100 CALL SPEAK(RTEXT(282)),,,,,,,,,,,,,,,,,,,,      GO TO 93000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     WHOOPS.  DOWN THE CHUTE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,93200 CALL SPEAK(RTEXT(283)),,,,,,,,,,,,,,,,,,,,      GO TO 95000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     DWARVES CAN'T SLEEP THRU ALL THIS RINGING!,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,93300 CALL SPEAK(RTEXT(254)),,,,,,,,,,,,,,,,,,,,      GO TO 95000,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"!     IF THE CURRENT LOC IS ZERO, ADVENTURER WAS KILLED, WHICH IS ALLOWED MAXDIE TIMES.  MAXDIE IS AUTOMATICALLY SET BASED ON NUMBER",,,,,,,,,,,,,,,,,,,,"!     OF SNIDE MESSAGES AVAILABLE.  EACH DEATH RESULTS IN A MESSAGE (81, 83, ETC.) OFFERING REINCARNATION; IF ACCEPTED, THIS RESULTS",,,,,,,,,,,,,,,,,,,,"!     IN MESSAGE 82, 84, ETC. WHEN REINCARNATED, ALL OBJECTS BEING CARRIED GET DROPPED AT OLDLC2 (PRESUMABLY THE LAST PLACE PRIOR TO",,,,,,,,,,,,,,,,,,,,!     BEING KILLED) WITHOUT CHANGE OF PROPS. THE LAMP IS TURNED OFF AND LEFT OUTSIDE THE BUILDING IF IT WAS CARRIED. ADVENTURER LEFT,,,,,,,,,,,,,,,,,,,,"!     INSIDE THE BUILDING; OLDLOC ZAPPED SO ADVENTURER CAN'T JUST ""RETREAT"".",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,94000 CALL SPEAK(RTEXT(23)),,,,,,,,,,,,,,,,,,,,      OLDLC2=LOC,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     DIED,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,94100 IF (.NOT.CLOSNG) THEN,,,,,,,,,,,,,,,,,,,,"         YEA=YES(81+NUMDIE*2,82+NUMDIE*2,54)",,,,,,,,,,,,,,,,,,,,         NUMDIE=NUMDIE+1,,,,,,,,,,,,,,,,,,,,         IF (NUMDIE.EQ.MAXDIE.OR..NOT.YEA) GO TO 95000,,,,,,,,,,,,,,,,,,,,         IF (CHASE.NE.0) THEN,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"   !        CHASED BY WUMPUS, & DIED ANOTHER WAY. PUT WUMPUS BACK TO SLEEP IN CASE ADVENTURER STILL HASN'T GOT THE CLOAK.",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,            CHASE=0,,,,,,,,,,,,,,,,,,,,            PROP(WUMPUS)=0,,,,,,,,,,,,,,,,,,,,"            CALL MOVE(WUMPUS,174)",,,,,,,,,,,,,,,,,,,,         ENDIF,,,,,,,,,,,,,,,,,,,,         IF (TOTING(LAMP)) PROP(LAMP)=0,,,,,,,,,,,,,,,,,,,,"         DO J=1,MAXOBJ",,,,,,,,,,,,,,,,,,,,            IF (HOLDNG(J)) THEN,,,,,,,,,,,,,,,,,,,,               LOC=OLDLC2,,,,,,,,,,,,,,,,,,,,               IF (J.EQ.LAMP) LOC=1,,,,,,,,,,,,,,,,,,,,"               CALL DROP(J,LOC)",,,,,,,,,,,,,,,,,,,,               IF (WEARNG(J)) THEN,,,,,,,,,,,,,,,,,,,,                  PROP(J)=0,,,,,,,,,,,,,,,,,,,,"                  OBJCON(J)=IBCLR(OBJCON(J),WEARBT)",,,,,,,,,,,,,,,,,,,,               ENDIF,,,,,,,,,,,,,,,,,,,,            ENDIF,,,,,,,,,,,,,,,,,,,,         END DO,,,,,,,,,,,,,,,,,,,,         LOC=3,,,,,,,,,,,,,,,,,,,,         OLDLOC=LOC,,,,,,,,,,,,,,,,,,,,         WDX=0,,,,,,,,,,,,,,,,,,,,         WORDS(1)=0,,,,,,,,,,,,,,,,,,,,         CALL CLRLIN,,,,,,,,,,,,,,,,,,,,         HEALTH=100,,,,,,,,,,,,,,,,,,,,         GO TO 2000,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     DIED DURING CLOSING TIME.  NO RESURRECTION.  TALLY UP A DEATH AND EXIT.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      CALL SPEAK(RTEXT(131)),,,,,,,,,,,,,,,,,,,,      NUMDIE=NUMDIE+1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,!     IT'S OVER.  TALLY SCORE.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"95000 CALL RATING(SCORE,BONUS,GAVEUP,SCORNG,CLOSNG,CLOSED,HNTMAX)",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,"      WRITE(*,""(///' You scored ',I0,' out of a possible ',I0,', using ',I0,' turns.')"") SCORE,MXSCOR,TURNS",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,      IF (SCORE.LT.MXSCOR) THEN,,,,,,,,,,,,,,,,,,,,"         DO I=1,CLSSES",,,,,,,,,,,,,,,,,,,,            IF (CVAL(I).GE.SCORE) THEN,,,,,,,,,,,,,,,,,,,,               CALL SPEAK(CTEXT(I)),,,,,,,,,,,,,,,,,,,,               IF (I.EQ.CLSSES-1) THEN,,,,,,,,,,,,,,,,,,,,"                  WRITE(*,""(/' To achieve the next higher rating would be a neat trick!'//' CONGRATULATIONS!!'/)"")",,,,,,,,,,,,,,,,,,,,               ELSE,,,,,,,,,,,,,,,,,,,,                  K=CVAL(I)+1-SCORE,,,,,,,,,,,,,,,,,,,,                  KK2C='s.',,,,,,,,,,,,,,,,,,,,                  IF (K.EQ.1)KK2C='. ',,,,,,,,,,,,,,,,,,,,"                  WRITE(*,""(/' To achieve the next higher rating, you need ',I0,' more point',A2,'..'/)"") K,KK2C",,,,,,,,,,,,,,,,,,,,               ENDIF,,,,,,,,,,,,,,,,,,,,               EXIT,,,,,,,,,,,,,,,,,,,,            ENDIF,,,,,,,,,,,,,,,,,,,,         END DO,,,,,,,,,,,,,,,,,,,,      ENDIF,,,,,,,,,,,,,,,,,,,,      CALL WAIT(25.),,,,,,,,,,,,,,,,,,,,      CALL POOF(0),,,,,,,,,,,,,,,,,,,,      END,,,,,,,,,